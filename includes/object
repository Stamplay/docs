<h1 id="objects">Objects</h1>

<p>The Object API resource is based of the user defined Schemas in the Stamplay Editor.</p>

<p>For each Schema, and API endpoint is generated, and new database collection is added.</p>

<p>Out of the box, the Object API resource supports user relationships, object relationships, geolocation data, file uploads, and role based interaction for each schema type.</p>

<h2 id="schemas">Schemas</h2>

<p>Schemas are defined data structures that enfore type validation.</p>

<p>They can be created throught Stamplay Editor, inside the <strong>Object</strong> section.</p>

<p>Below is an example schema of a <strong>Restaurant</strong> with every possible data type available as a field type.</p>

<p>There are 3 properties that are included by default:</p>

<table>
  <thead>
    <tr>
      <th>Attribute</th>
      <th> </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>dt_create</code></td>
      <td>The date the record was created</td>
    </tr>
    <tr>
      <td><code>dt_update</code></td>
      <td>The date the record was last updated</td>
    </tr>
    <tr>
      <td><code>owner</code></td>
      <td>The <code>_id</code> of the user who created this object.</td>
    </tr>
  </tbody>
</table>

<aside class="notice">
  <p>The <strong>owner</strong> field is set when an active user session is in place, and the session <strong>JSON Web Token</strong>, is in the request as the <strong>x-stamplay-jwt</strong> header.</p>

  <p>The JavaScript SDK manages this header for you, so only via an API request via REST will need you to set this header for the owner property to be set to the current user session.</p>
</aside>

<h2 id="data-types">Data Types</h2>

<p>The types and formats of each field type is listed below:</p>

<blockquote>
  <p>In the example schema object below, each key-value pair is a possible schema property type, and a valid value for that property type.</p>
</blockquote>

<pre class="highlight json"><code><span class="w">
</span><span class="p">{</span><span class="w">
  </span><span class="nt">"boolean"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
  </span><span class="nt">"string"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"Hello World"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"number"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">45</span><span class="p">,</span><span class="w">
  </span><span class="nt">"float"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mf">3.14</span><span class="p">,</span><span class="w">
  </span><span class="nt">"plain_object"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"prop_one"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"GoodBye World"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"prop_two"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">1200</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="nt">"array_number"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="mi">23</span><span class="p">,</span><span class="w"> </span><span class="mi">76</span><span class="p">,</span><span class="w"> </span><span class="mi">345</span><span class="p">],</span><span class="w">
  </span><span class="nt">"array_string"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"Hello"</span><span class="p">,</span><span class="w"> </span><span class="s2">"World"</span><span class="p">],</span><span class="w">
  </span><span class="nt">"date"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"2016-03-10T14:51:28.625Z"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"file"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"https://file-upload.stamplayapp.com/upload/cobject/image/1458238116389_file-upload.png"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"_geolocation"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"type"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"Point"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"coordinates "</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
      </span><span class="mf">12.4608</span><span class="p">,</span><span class="w">
      </span><span class="mf">41.9015</span><span class="w">
    </span><span class="p">]</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="nt">"object_relation_array"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="s2">"562c45af4c0f20367d7ca4be"</span><span class="p">,</span><span class="w"> </span><span class="s2">"562ec06e77589e2e0f86c207"</span><span class="p">],</span><span class="w">
  </span><span class="nt">"user_relation_string"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"562bb24e007983c67c8ee9df"</span><span class="w">
</span><span class="p">}</span><span class="w">  
</span></code></pre>

<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Summary</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><a href="#boolean">Boolean</a></td>
      <td>A boolean value type</td>
    </tr>
    <tr>
      <td><a href="#string">String</a></td>
      <td>String value type. Strings are stored as UTF-8.</td>
    </tr>
    <tr>
      <td><a href="#number">Number</a></td>
      <td>An integer value type.</td>
    </tr>
    <tr>
      <td><a href="#float">Float</a></td>
      <td>A float value type.</td>
    </tr>
    <tr>
      <td><a href="#plain-object">Plain Object</a></td>
      <td>A Javascript object.</td>
    </tr>
    <tr>
      <td><a href="#array-number">Array - Number</a></td>
      <td>An array of integer value types.</td>
    </tr>
    <tr>
      <td><a href="#array-string">Array - String</a></td>
      <td>An array of string value types.</td>
    </tr>
    <tr>
      <td><a href="#date">Date</a></td>
      <td>Date value type. Dates are stored in ISODateTimeFormat.</td>
    </tr>
    <tr>
      <td><a href="#file">File</a></td>
      <td>Any kind of file. Location of the resource uploaded.</td>
    </tr>
    <tr>
      <td><a href="#geolocation">Geolocation</a></td>
      <td>GeoJSON object.</td>
    </tr>
    <tr>
      <td><a href="#object-relation">Object Relation - Array</a></td>
      <td>An arrays of pointers to an specific object type.</td>
    </tr>
    <tr>
      <td><a href="#user-relation">User Relation - String</a></td>
      <td>A pointer to a user object.</td>
    </tr>
  </tbody>
</table>

<h3 id="boolean">Boolean</h3>

<pre class="highlight shell-always"><code>  <span class="p">{</span>
    <span class="nl">_id</span><span class="p">:</span> <span class="s2">"56cf08e362641ca813b1ae6c"</span><span class="p">,</span>
    <span class="nx">verified</span> <span class="err">:</span> <span class="kc">true</span>
  <span class="p">}</span>
</code></pre>

<p>A <strong>Boolean</strong> type is a <code>true</code> or <code>false</code> value.</p>

<h3 id="string">String</h3>

<pre class="highlight shell-always"><code>  <span class="p">{</span>
    <span class="nl">_id</span><span class="p">:</span> <span class="s2">"56cf08e362641ca813b1ae6c"</span><span class="p">,</span>
    <span class="nx">name</span> <span class="err">:</span> <span class="s2">"John"</span>
  <span class="p">}</span>
</code></pre>

<p>A <strong>String</strong> type is a series of characters enclosed by single, or double quotes.</p>

<h3 id="number">Number</h3>

<pre class="highlight shell-always"><code>  <span class="p">{</span>
    <span class="nl">_id</span><span class="p">:</span> <span class="s2">"56cf08e362641ca813b1ae6c"</span><span class="p">,</span>
    <span class="nx">age</span> <span class="err">:</span> <span class="mi">29</span>
  <span class="p">}</span>
</code></pre>

<p>A <strong>Number</strong> type is an integer value type without a period or exponent notation.</p>

<h3 id="float">Float</h3>

<pre class="highlight shell-always"><code>  <span class="p">{</span>
    <span class="nl">_id</span><span class="p">:</span> <span class="s2">"56cf08e362641ca813b1ae6c"</span><span class="p">,</span>
    <span class="nx">pie</span> <span class="err">:</span> <span class="mf">3.14</span>
  <span class="p">}</span>
</code></pre>

<p>A <strong>Float</strong> type is an integer value type with a period or exponent notation.</p>

<h3 id="plain-object">Plain Object</h3>

<pre class="highlight shell-always"><code>  <span class="p">{</span>
    <span class="nl">_id</span><span class="p">:</span> <span class="s2">"56cf08e362641ca813b1ae6c"</span><span class="p">,</span>
    <span class="nx">car</span> <span class="err">:</span> <span class="p">{</span>
      <span class="nl">color</span> <span class="p">:</span> <span class="s2">"blue"</span><span class="p">,</span>
      <span class="nx">year</span> <span class="err">:</span> <span class="mi">2014</span><span class="p">,</span>
      <span class="nx">automatic</span> <span class="err">:</span> <span class="kc">false</span>
    <span class="p">}</span>
  <span class="p">}</span>
</code></pre>

<p>A <strong>Plain Object</strong> type is a plain javascript object. The property <code>car</code> is a plain object type in the example.</p>

<h3 id="array---number">Array - Number</h3>

<pre class="highlight shell-always"><code>  <span class="p">{</span>
    <span class="nl">_id</span><span class="p">:</span> <span class="s2">"56cf08e362641ca813b1ae6c"</span><span class="p">,</span>
    <span class="nx">colors</span> <span class="err">:</span> <span class="p">[</span><span class="mi">12</span><span class="p">,</span> <span class="mi">43</span><span class="p">,</span> <span class="mi">235</span><span class="p">,</span> <span class="mi">66</span><span class="p">]</span>
  <span class="p">}</span>
</code></pre>

<p>An <strong>Array</strong> of <strong>Number</strong> value types:</p>

<h3 id="array---string">Array - String</h3>

<pre class="highlight shell-always"><code>  <span class="p">{</span>
    <span class="nl">_id</span><span class="p">:</span> <span class="s2">"56cf08e362641ca813b1ae6c"</span><span class="p">,</span>
    <span class="nx">colors</span> <span class="err">:</span> <span class="p">[</span><span class="s2">"yellow"</span><span class="p">,</span> <span class="s2">"green"</span><span class="p">,</span> <span class="s2">"blue"</span><span class="p">,</span> <span class="s2">"red"</span><span class="p">]</span>
  <span class="p">}</span>
</code></pre>

<p>An <strong>Array</strong> of <strong>String</strong> value types:</p>

<h3 id="date">Date</h3>

<pre class="highlight shell-always"><code>    <span class="p">{</span>
      <span class="nl">_id</span> <span class="p">:</span> <span class="s2">"56cf08e362641ca813b1ae6c"</span><span class="p">,</span>
      <span class="nx">start_date</span> <span class="err">:</span> <span class="s2">"2016-03-10T14:51:28.625Z"</span>
    <span class="p">}</span>
</code></pre>

<pre class="highlight shell-always"><code>  <span class="p">{</span>
      <span class="nl">_id</span> <span class="p">:</span> <span class="s2">"56cf08e362641ca813b1ae6c"</span><span class="p">,</span>
      <span class="nx">end_date</span> <span class="err">:</span> <span class="s2">"Thu, 10 Mar 2016 14:51:43 GMT"</span>
    <span class="p">}</span>
</code></pre>

<p>A <strong>Date</strong> type is a date string in either the <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Date/toISOString">ISO 8601</a> format, or <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Date/toUTCString">RFC-1123</a> format.</p>

<p>The property <code>start_date</code> is a Date type in <strong>ISO 8601</strong> format in the first example.</p>

<p>The property <code>end_date</code> is a Date type in <strong>RFC-1123</strong> format in the last example.</p>

<h3 id="file">File</h3>

<pre class="highlight shell-always"><code>  <span class="p">{</span>
    <span class="nl">_id</span> <span class="p">:</span> <span class="s2">"56cf08e362641ca813b1ae6c"</span><span class="p">,</span>
    <span class="nx">profile_image</span> <span class="err">:</span> <span class="s2">"https://APP-ID.stamplayapp.com/upload/cobject/[cobject-name]/1457032441927_stamplay.png"</span>
  <span class="p">}</span>
</code></pre>

<p>A <strong>File</strong> type is a file upload. Any kind of file is accepted. When a file is uploaded, and saved, the property will be a link to the file upload location.</p>

<p>To save a file type, the request must be sent as <code>multipart/form-data</code>.</p>

<p>The <code>profile_image</code> is an example of a <strong>File</strong> type in the example.</p>

<h3 id="geolocation">Geolocation</h3>

<pre class="highlight shell-always"><code>  <span class="p">{</span>
    <span class="nl">_id</span><span class="p">:</span> <span class="s2">"56cf08e362641ca813b1ae6c"</span><span class="p">,</span>
    <span class="nx">_geolocation</span> <span class="err">:</span> <span class="p">{</span>
      <span class="nl">type</span><span class="p">:</span> <span class="s2">"Point"</span><span class="p">,</span>
      <span class="nx">coordinates</span><span class="err">:</span> <span class="p">[</span>
        <span class="mf">12.4608</span><span class="p">,</span>
        <span class="mf">41.9015</span>
      <span class="p">]</span>
    <span class="p">}</span>
  <span class="p">}</span>
</code></pre>

<p>A <strong>Geolocation</strong> type is stored as <strong>GeoJSON</strong> object with this coordinate-axis order: <code>longitude</code>, <code>latitude</code>.</p>

<p>A Point stored on Stamplay will look like the example:</p>

<p>Currently supported data types are:</p>

<ul>
  <li>
    <ul>
      <li><a href="https://docs.mongodb.org/manual/reference/geojson/#point">Point</a></li>
    </ul>
  </li>
  <li>
    <ul>
      <li><a href="https://docs.mongodb.org/manual/reference/geojson/#linestring">LineString</a></li>
    </ul>
  </li>
  <li>
    <ul>
      <li><a href="https://docs.mongodb.org/manual/reference/geojson/#polygon">Polygon</a></li>
    </ul>
  </li>
  <li>
    <ul>
      <li><a href="https://docs.mongodb.org/manual/reference/geojson/#multipoint">MultiPoint</a></li>
    </ul>
  </li>
  <li>
    <ul>
      <li><a href="https://docs.mongodb.org/manual/reference/geojson/#multilinestring">MultiLineString</a></li>
    </ul>
  </li>
  <li>
    <ul>
      <li><a href="https://docs.mongodb.org/manual/reference/geojson/#multipolygon">MultiPolygon</a></li>
    </ul>
  </li>
</ul>

<p>In order to save any instance of geolocation data you need to send the complete <strong>GeoJSON</strong> representation.</p>

<p>To make this easier if you want to create a Point you're allowed to send an array of coordinates in <code>longitude, latitude</code> format and Stamplay will create the <strong>GeoJSON</strong> for you.</p>

<h3 id="object-relation">Object Relation</h3>

<pre class="highlight shell-always"><code>  <span class="p">{</span>
    <span class="nl">_id</span> <span class="p">:</span> <span class="s2">"56cf08e362641ca813b1ae6c"</span><span class="p">,</span>
    <span class="nx">solutions</span> <span class="err">:</span> <span class="p">[</span><span class="s2">"6c641c8a81e3625f03b1ae6c"</span><span class="p">,</span> <span class="s2">"3b1ae6c8a81e3625f06c641c"</span><span class="p">,</span> <span class="s2">"825f06c641c3ba81e361ae6c"</span><span class="p">,</span> <span class="s2">"f06c641c3b8a81e3625ae6c"</span><span class="p">]</span>
  <span class="p">}</span>
</code></pre>

<p>A <strong>Object Relation</strong> is set of pointers to another object.</p>

<p>Select the <strong>Object Relation - [Object Name]</strong> from the dropdown to the object type to point to. The pointers are each a <code>_id</code> of another object. This field can be populated.</p>

<p>The <code>solutions</code> property is an example of a <strong>Object Relation</strong> type in the example.</p>

<h3 id="user-relation">User Relation</h3>

<pre class="highlight shell-always"><code>  <span class="p">{</span>
    <span class="nl">_id</span> <span class="p">:</span> <span class="s2">"56cf08e362641ca813b1ae6c"</span><span class="p">,</span>
    <span class="nx">author</span> <span class="err">:</span> <span class="s2">"8a81e3625f06c641c3b1ae6c"</span>
  <span class="p">}</span>
</code></pre>

<p>A <strong>User Relation</strong> is a pointer to a user object represented by an <code>_id</code> of a user. This field can be populated. The <code>author</code> property is an example of a <code>User Relation</code> in the example.</p>

<h2 id="permissions">Permissions</h2>

<p>With permissions at an Object level, you define who can perform operations on your data. You can do that by choosing a preset or creating your own permission model.</p>

<p><img alt="Permissions Overview" src="/images/object-permissions-overview.png" /></p>

<p>We’ve identified some commonly used permission patterns (we refer to them as "policies"). Stamplay provides an easy way to use these patterns on the data your app manages. These policies offer a convenient mechanism for supporting very common security scenarios without having to manage complex settings:</p>

<ul>
  <li>
    <p><strong>Private</strong>: Use this preset if you want to make users’ data inaccessible to other users. Any user will be able to read and write only his or her own information.</p>
  </li>
  <li>
    <p><strong>Public</strong>: When this policy is applied to user profiles, any user can read and write any other user's information. Proceed with caution.</p>
  </li>
  <li>
    <p><strong>Read-only</strong>: Use this preset if you want users to read all profiles, but you don’t want to give them permission to write any profile information.</p>
  </li>
  <li>
    <p><strong>Shared</strong>: This preset is suitable for social apps; any user can modify his or her own profile and can read all other user profiles.</p>
  </li>
</ul>

<p>If the predefined security policies are not flexible enough for your app and you have created your own user roles, you can choose to use role-based security. The settings specify whether a role is allowed to create, read, update or delete items.</p>

<h2 id="create">Create</h2>
<pre class="highlight shell"><code>  curl -X <span class="s2">"POST"</span> <span class="s2">"https://APP-ID.stamplayapp.com/api/cobject/v1/object"</span> <span class="se">\</span>
    -H <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
    -d <span class="s2">"{</span><span class="se">\"</span><span class="s2">title</span><span class="se">\"</span><span class="s2">:</span><span class="se">\"\\\"</span><span class="s2">Hello World</span><span class="se">\\\"\"</span><span class="s2">,</span><span class="se">\"</span><span class="s2">year</span><span class="se">\"</span><span class="s2">:</span><span class="se">\"</span><span class="s2">2016</span><span class="se">\"</span><span class="s2">}"</span>
</code></pre>

<pre class="highlight javascript"><code>  <span class="kd">var</span> <span class="nx">data</span> <span class="o">=</span> <span class="p">{</span>
    <span class="na">title</span> <span class="p">:</span> <span class="s2">"Hello World"</span><span class="p">,</span>
    <span class="na">year</span> <span class="p">:</span> <span class="mi">2016</span>
  <span class="p">}</span>

  <span class="nx">Stamplay</span><span class="p">.</span><span class="nb">Object</span><span class="p">(</span><span class="s2">"movie"</span><span class="p">).</span><span class="nx">save</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">res</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// success</span>
    <span class="p">},</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// error</span>
    <span class="p">})</span>

</code></pre>

<pre class="highlight nodejs"><code>  <span class="kd">var</span> <span class="nx">data</span> <span class="o">=</span> <span class="p">{</span>
    <span class="na">title</span> <span class="p">:</span> <span class="s2">"Hello World"</span><span class="p">,</span>
    <span class="na">year</span> <span class="p">:</span> <span class="mi">2016</span>
  <span class="p">}</span>

  <span class="nx">Stamplay</span><span class="p">.</span><span class="nb">Object</span><span class="p">(</span><span class="s2">"movie"</span><span class="p">).</span><span class="nx">save</span><span class="p">(</span><span class="nx">data</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">res</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// response</span>
  <span class="p">})</span>
</code></pre>

<blockquote>
  <p>The JSON response looks like this.</p>
</blockquote>

<pre class="highlight json"><code><span class="w">
</span><span class="p">{</span><span class="w">
   </span><span class="nt">"__v"</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="w">
   </span><span class="nt">"title"</span><span class="p">:</span><span class="s2">"Hello World"</span><span class="p">,</span><span class="w">
   </span><span class="nt">"year"</span><span class="p">:</span><span class="mi">2016</span><span class="p">,</span><span class="w">
   </span><span class="nt">"appId"</span><span class="p">:</span><span class="s2">"stamplay-docs"</span><span class="p">,</span><span class="w">
   </span><span class="nt">"cobjectId"</span><span class="p">:</span><span class="s2">"movie"</span><span class="p">,</span><span class="w">
   </span><span class="nt">"_id"</span><span class="p">:</span><span class="s2">"570edb76fc24091627e82086"</span><span class="p">,</span><span class="w">
   </span><span class="nt">"actions"</span><span class="p">:{</span><span class="w">
      </span><span class="nt">"comments"</span><span class="p">:[],</span><span class="w">
      </span><span class="nt">"ratings"</span><span class="p">:{</span><span class="w">
         </span><span class="nt">"users"</span><span class="p">:[],</span><span class="w">
         </span><span class="nt">"avg"</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="w">
         </span><span class="nt">"total"</span><span class="p">:</span><span class="mi">0</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="nt">"votes"</span><span class="p">:{</span><span class="w">
         </span><span class="nt">"users_downvote"</span><span class="p">:[],</span><span class="w">
         </span><span class="nt">"users_upvote"</span><span class="p">:[],</span><span class="w">
         </span><span class="nt">"users"</span><span class="p">:[],</span><span class="w">
         </span><span class="nt">"total"</span><span class="p">:</span><span class="mi">0</span><span class="w">
      </span><span class="p">}</span><span class="w">
   </span><span class="p">},</span><span class="w">
   </span><span class="nt">"dt_update"</span><span class="p">:</span><span class="s2">"2016-04-13T23:51:18.170Z"</span><span class="p">,</span><span class="w">
   </span><span class="nt">"dt_create"</span><span class="p">:</span><span class="s2">"2016-04-13T23:51:18.170Z"</span><span class="p">,</span><span class="w">
   </span><span class="nt">"id"</span><span class="p">:</span><span class="s2">"570edb76fc24091627e82086"</span><span class="w">
</span><span class="p">}</span><span class="w">

</span></code></pre>

<p>To create new object data for a particular model, send the data in the body of a<code>POST</code> request to the Object resource, specifying the object type in the URI.</p>

<aside class="notice">
  <p>The data sent in the request body must validate against the schema defined for the particular object resource being saved.</p>
</aside>

<h2 id="fetch-objects">Fetch Objects</h2>

<p>Retrieve an individual object, all objects, or any matching specific criteria of a particular model type.</p>

<h3 id="fetch-object-by-id">Fetch Object By Id</h3>

<pre class="highlight shell"><code>  curl -X <span class="s2">"GET"</span> <span class="s2">"https://APP-ID.stamplayapp.com/api/cobject/v1/movie/:object_id"</span>
</code></pre>

<pre class="highlight javascript"><code>  <span class="nx">Stamplay</span><span class="p">.</span><span class="nb">Object</span><span class="p">(</span><span class="s2">"movie"</span><span class="p">).</span><span class="nx">get</span><span class="p">({</span> <span class="na">_id</span> <span class="p">:</span> <span class="s2">"object_id"</span><span class="p">})</span>
    <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">res</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// success</span>
    <span class="p">},</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// error</span>
    <span class="p">})</span>
</code></pre>

<pre class="highlight nodejs"><code>  <span class="nx">Stamplay</span><span class="p">.</span><span class="nb">Object</span><span class="p">(</span><span class="s2">"movie"</span><span class="p">).</span><span class="nx">get</span><span class="p">({</span> <span class="na">_id</span> <span class="p">:</span> <span class="s2">"object_id"</span><span class="p">},</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">res</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// response</span>
  <span class="p">})</span>
</code></pre>

<blockquote>
  <p>The JSON response looks like this.</p>
</blockquote>

<pre class="highlight json"><code><span class="w">
</span><span class="p">{</span><span class="w">
   </span><span class="nt">"data"</span><span class="p">:[</span><span class="w">
      </span><span class="p">{</span><span class="w">
         </span><span class="nt">"_id"</span><span class="p">:</span><span class="s2">"570edb76fc24091627e82086"</span><span class="p">,</span><span class="w">
         </span><span class="nt">"title"</span><span class="p">:</span><span class="s2">"Hello World"</span><span class="p">,</span><span class="w">
         </span><span class="nt">"year"</span><span class="p">:</span><span class="mi">2016</span><span class="p">,</span><span class="w">
         </span><span class="nt">"appId"</span><span class="p">:</span><span class="s2">"stamplay-docs"</span><span class="p">,</span><span class="w">
         </span><span class="nt">"cobjectId"</span><span class="p">:</span><span class="s2">"movie"</span><span class="p">,</span><span class="w">
         </span><span class="nt">"actions"</span><span class="p">:{</span><span class="w">
            </span><span class="nt">"comments"</span><span class="p">:[],</span><span class="w">
            </span><span class="nt">"ratings"</span><span class="p">:{</span><span class="w">
               </span><span class="nt">"users"</span><span class="p">:[],</span><span class="w">
               </span><span class="nt">"avg"</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="w">
               </span><span class="nt">"total"</span><span class="p">:</span><span class="mi">0</span><span class="w">
            </span><span class="p">},</span><span class="w">
            </span><span class="nt">"votes"</span><span class="p">:{</span><span class="w">
               </span><span class="nt">"users_downvote"</span><span class="p">:[],</span><span class="w">
               </span><span class="nt">"users_upvote"</span><span class="p">:[],</span><span class="w">
               </span><span class="nt">"users"</span><span class="p">:[],</span><span class="w">
               </span><span class="nt">"total"</span><span class="p">:</span><span class="mi">0</span><span class="w">
            </span><span class="p">}</span><span class="w">
         </span><span class="p">},</span><span class="w">
         </span><span class="nt">"dt_update"</span><span class="p">:</span><span class="s2">"2016-04-13T23:51:18.170Z"</span><span class="p">,</span><span class="w">
         </span><span class="nt">"dt_create"</span><span class="p">:</span><span class="s2">"2016-04-13T23:51:18.170Z"</span><span class="p">,</span><span class="w">
         </span><span class="nt">"__v"</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="w">
         </span><span class="nt">"id"</span><span class="p">:</span><span class="s2">"570edb76fc24091627e82086"</span><span class="w">
      </span><span class="p">}</span><span class="w">
   </span><span class="p">],</span><span class="w">
   </span><span class="nt">"pagination"</span><span class="p">:{</span><span class="w">
      </span><span class="nt">"page"</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="w">
      </span><span class="nt">"per_page"</span><span class="p">:</span><span class="mi">20</span><span class="p">,</span><span class="w">
      </span><span class="nt">"total_pages"</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="w">
      </span><span class="nt">"total_elements"</span><span class="p">:</span><span class="mi">1</span><span class="w">
   </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">

</span></code></pre>

<p>To fetch a single object, send a <code>GET</code> request to the Object resource with the object's <code>_id</code> in the URI.</p>

<p>The object type for the example is <code>movie</code>.</p>

<table>
  <thead>
    <tr>
      <th>Attribute</th>
      <th> </th>
      <th style="text-align: center">Optional</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>object_id</code></td>
      <td>the Stamplay <code>_id</code> of the object to retrieve</td>
      <td style="text-align: center"><i class="unchecked"></i></td>
    </tr>
  </tbody>
</table>

<h3 id="all-objects">All Objects</h3>

<pre class="highlight shell"><code>  curl -X <span class="s2">"GET"</span> <span class="s2">"https://APP-ID.stamplayapp.com/api/cobject/v1/movie"</span>
</code></pre>

<pre class="highlight javascript"><code>  <span class="nx">Stamplay</span><span class="p">.</span><span class="nb">Object</span><span class="p">(</span><span class="s2">"movie"</span><span class="p">).</span><span class="nx">get</span><span class="p">({})</span>
    <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">res</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// success</span>
    <span class="p">},</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// error</span>
    <span class="p">})</span>
</code></pre>

<pre class="highlight nodejs"><code>  <span class="nx">Stamplay</span><span class="p">.</span><span class="nb">Object</span><span class="p">(</span><span class="s2">"movie"</span><span class="p">).</span><span class="nx">get</span><span class="p">({},</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">res</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// response</span>
  <span class="p">})</span>
</code></pre>

<blockquote>
  <p>The JSON response looks like this.</p>
</blockquote>

<pre class="highlight json"><code><span class="w">
</span><span class="p">{</span><span class="w">  
   </span><span class="nt">"data"</span><span class="p">:[</span><span class="w">  
      </span><span class="p">{</span><span class="w">  
         </span><span class="nt">"_id"</span><span class="p">:</span><span class="s2">"570edb76fc24091627e82086"</span><span class="p">,</span><span class="w">
         </span><span class="nt">"title"</span><span class="p">:</span><span class="s2">"Hello World"</span><span class="p">,</span><span class="w">
         </span><span class="nt">"year"</span><span class="p">:</span><span class="mi">2016</span><span class="p">,</span><span class="w">
         </span><span class="nt">"appId"</span><span class="p">:</span><span class="s2">"stamplay-docs"</span><span class="p">,</span><span class="w">
         </span><span class="nt">"cobjectId"</span><span class="p">:</span><span class="s2">"movie"</span><span class="p">,</span><span class="w">
         </span><span class="nt">"actions"</span><span class="p">:{</span><span class="w"> </span><span class="err">...</span><span class="w"> </span><span class="p">},</span><span class="w">
         </span><span class="nt">"dt_update"</span><span class="p">:</span><span class="s2">"2016-04-13T23:51:18.170Z"</span><span class="p">,</span><span class="w">
         </span><span class="nt">"dt_create"</span><span class="p">:</span><span class="s2">"2016-04-13T23:51:18.170Z"</span><span class="p">,</span><span class="w">
         </span><span class="nt">"__v"</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="w">
         </span><span class="nt">"id"</span><span class="p">:</span><span class="s2">"570edb76fc24091627e82086"</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="p">{</span><span class="w">  
         </span><span class="nt">"_id"</span><span class="p">:</span><span class="s2">"570edcc7fc24091627e82087"</span><span class="p">,</span><span class="w">
         </span><span class="nt">"title"</span><span class="p">:</span><span class="s2">"Goodbye World"</span><span class="p">,</span><span class="w">
         </span><span class="nt">"year"</span><span class="p">:</span><span class="mi">2014</span><span class="p">,</span><span class="w">
         </span><span class="nt">"appId"</span><span class="p">:</span><span class="s2">"stamplay-docs"</span><span class="p">,</span><span class="w">
         </span><span class="nt">"cobjectId"</span><span class="p">:</span><span class="s2">"movie"</span><span class="p">,</span><span class="w">
         </span><span class="nt">"actions"</span><span class="p">:{</span><span class="w"> </span><span class="err">...</span><span class="w"> </span><span class="p">},</span><span class="w">
         </span><span class="nt">"dt_update"</span><span class="p">:</span><span class="s2">"2016-04-13T23:56:55.060Z"</span><span class="p">,</span><span class="w">
         </span><span class="nt">"dt_create"</span><span class="p">:</span><span class="s2">"2016-04-13T23:56:55.060Z"</span><span class="p">,</span><span class="w">
         </span><span class="nt">"__v"</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="w">
         </span><span class="nt">"id"</span><span class="p">:</span><span class="s2">"570edcc7fc24091627e82087"</span><span class="w">
      </span><span class="p">}</span><span class="w">
      </span><span class="err">...</span><span class="w">
      </span><span class="err">...</span><span class="mi">12</span><span class="w"> </span><span class="err">more</span><span class="w">
      </span><span class="err">...</span><span class="w">
   </span><span class="p">],</span><span class="w">
   </span><span class="nt">"pagination"</span><span class="p">:{</span><span class="w">  
      </span><span class="nt">"page"</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="w">
      </span><span class="nt">"per_page"</span><span class="p">:</span><span class="mi">20</span><span class="p">,</span><span class="w">
      </span><span class="nt">"total_pages"</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="w">
      </span><span class="nt">"total_elements"</span><span class="p">:</span><span class="mi">14</span><span class="w">
   </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">

</span></code></pre>

<p>To fetch all objects, send a <code>GET</code> request to the Object resource.</p>

<p>The object type for the example is <code>movie</code>.</p>

<h3 id="query-objects">Query Objects</h3>

<pre class="highlight shell"><code>  curl -X <span class="s2">"GET"</span> <span class="s2">"https://APP-ID.stamplayapp.com/api/cobject/v1/movie?year=1998"</span>
</code></pre>

<pre class="highlight javascript"><code>  <span class="kd">var</span> <span class="nx">query</span> <span class="o">=</span> <span class="p">{</span>
    <span class="na">year</span> <span class="p">:</span> <span class="mi">1998</span>
  <span class="p">}</span>

  <span class="nx">Stamplay</span><span class="p">.</span><span class="nb">Object</span><span class="p">(</span><span class="s2">"movie"</span><span class="p">).</span><span class="nx">get</span><span class="p">(</span><span class="nx">query</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">res</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// success</span>
    <span class="p">},</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// error</span>
    <span class="p">})</span>
</code></pre>

<pre class="highlight nodejs"><code>  <span class="kd">var</span> <span class="nx">query</span> <span class="o">=</span> <span class="p">{</span>
    <span class="na">year</span> <span class="p">:</span> <span class="mi">1998</span>
  <span class="p">}</span>

  <span class="nx">Stamplay</span><span class="p">.</span><span class="nb">Object</span><span class="p">(</span><span class="s2">"movie"</span><span class="p">).</span><span class="nx">get</span><span class="p">(</span><span class="nx">query</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">res</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// response</span>
  <span class="p">})</span>
</code></pre>

<blockquote>
  <p>The JSON response looks like this.</p>
</blockquote>

<pre class="highlight json"><code><span class="w">
</span><span class="p">{</span><span class="w">  
   </span><span class="nt">"data"</span><span class="p">:[</span><span class="w">  
      </span><span class="p">{</span><span class="w">  
         </span><span class="nt">"_id"</span><span class="p">:</span><span class="s2">"570edb76fc24091627e82086"</span><span class="p">,</span><span class="w">
         </span><span class="nt">"title"</span><span class="p">:</span><span class="s2">"Goodbye 90's"</span><span class="p">,</span><span class="w">
         </span><span class="nt">"year"</span><span class="p">:</span><span class="mi">1998</span><span class="p">,</span><span class="w">
         </span><span class="nt">"appId"</span><span class="p">:</span><span class="s2">"stamplay-docs"</span><span class="p">,</span><span class="w">
         </span><span class="nt">"cobjectId"</span><span class="p">:</span><span class="s2">"movie"</span><span class="p">,</span><span class="w">
         </span><span class="nt">"actions"</span><span class="p">:{</span><span class="w"> </span><span class="err">...</span><span class="w"> </span><span class="p">},</span><span class="w">
         </span><span class="nt">"dt_update"</span><span class="p">:</span><span class="s2">"2016-04-13T23:51:18.170Z"</span><span class="p">,</span><span class="w">
         </span><span class="nt">"dt_create"</span><span class="p">:</span><span class="s2">"2016-04-13T23:51:18.170Z"</span><span class="p">,</span><span class="w">
         </span><span class="nt">"__v"</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="w">
         </span><span class="nt">"id"</span><span class="p">:</span><span class="s2">"570edb76fc24091627e82086"</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="p">{</span><span class="w">  
         </span><span class="nt">"_id"</span><span class="p">:</span><span class="s2">"570edcc7fc24091627e82087"</span><span class="p">,</span><span class="w">
         </span><span class="nt">"title"</span><span class="p">:</span><span class="s2">"Again not again."</span><span class="p">,</span><span class="w">
         </span><span class="nt">"year"</span><span class="p">:</span><span class="mi">1998</span><span class="p">,</span><span class="w">
         </span><span class="nt">"appId"</span><span class="p">:</span><span class="s2">"stamplay-docs"</span><span class="p">,</span><span class="w">
         </span><span class="nt">"cobjectId"</span><span class="p">:</span><span class="s2">"movie"</span><span class="p">,</span><span class="w">
         </span><span class="nt">"actions"</span><span class="p">:{</span><span class="w"> </span><span class="err">...</span><span class="w"> </span><span class="p">},</span><span class="w">
         </span><span class="nt">"dt_update"</span><span class="p">:</span><span class="s2">"2016-04-13T23:56:55.060Z"</span><span class="p">,</span><span class="w">
         </span><span class="nt">"dt_create"</span><span class="p">:</span><span class="s2">"2016-04-13T23:56:55.060Z"</span><span class="p">,</span><span class="w">
         </span><span class="nt">"__v"</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="w">
         </span><span class="nt">"id"</span><span class="p">:</span><span class="s2">"570edcc7fc24091627e82087"</span><span class="w">
      </span><span class="p">}</span><span class="w">
   </span><span class="p">],</span><span class="w">
   </span><span class="nt">"pagination"</span><span class="p">:{</span><span class="w">  
      </span><span class="nt">"page"</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="w">
      </span><span class="nt">"per_page"</span><span class="p">:</span><span class="mi">20</span><span class="p">,</span><span class="w">
      </span><span class="nt">"total_pages"</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="w">
      </span><span class="nt">"total_elements"</span><span class="p">:</span><span class="mi">2</span><span class="w">
   </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">

</span></code></pre>

<p>To fetch all objects that match a certain parameters, send a <code>GET</code> request to the Object resource with any parameters to match in the request body.</p>

<p>For more advanced queries, visit the <a href="#advanced-queries">Advanced Queries</a> section for more information.</p>

<p>The object type for the example is <code>movie</code>.</p>

<h3 id="find-by-current-user">Find By Current User</h3>

<pre class="highlight shell"><code>  curl -X <span class="s2">"GET"</span> <span class="s2">"https://APP-ID.stamplayapp.com/api/cobject/v1/movie/find/director"</span>
</code></pre>

<pre class="highlight javascript"><code>
  <span class="c1">// default attribute is owner is no arguments are passed to method</span>

  <span class="nx">Stamplay</span><span class="p">.</span><span class="nb">Object</span><span class="p">(</span><span class="s2">"movie"</span><span class="p">).</span><span class="nx">findByCurrentUser</span><span class="p">(</span><span class="s1">'director'</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">res</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// Success</span>
    <span class="p">},</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// Error</span>
    <span class="p">}))</span>
</code></pre>

<pre class="highlight nodejs"><code>  <span class="c1">// no method</span>
</code></pre>

<blockquote>
  <p>The JSON response looks like this.</p>
</blockquote>

<pre class="highlight json"><code><span class="w">
</span><span class="p">{</span><span class="w">  
   </span><span class="nt">"data"</span><span class="p">:[</span><span class="w">  
      </span><span class="p">{</span><span class="w">  
         </span><span class="nt">"_id"</span><span class="p">:</span><span class="s2">"570edb76fc24091627e82086"</span><span class="p">,</span><span class="w">
         </span><span class="nt">"title"</span><span class="p">:</span><span class="s2">"Hello World"</span><span class="p">,</span><span class="w">
         </span><span class="nt">"year"</span><span class="p">:</span><span class="mi">2016</span><span class="p">,</span><span class="w">
         </span><span class="nt">"director"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"5503de76fc24091627e82568"</span><span class="p">,</span><span class="w">
         </span><span class="nt">"appId"</span><span class="p">:</span><span class="s2">"stamplay-docs"</span><span class="p">,</span><span class="w">
         </span><span class="nt">"cobjectId"</span><span class="p">:</span><span class="s2">"movie"</span><span class="p">,</span><span class="w">
         </span><span class="nt">"actions"</span><span class="p">:{</span><span class="w"> </span><span class="err">...</span><span class="w"> </span><span class="p">},</span><span class="w">
         </span><span class="nt">"dt_update"</span><span class="p">:</span><span class="s2">"2016-04-13T23:51:18.170Z"</span><span class="p">,</span><span class="w">
         </span><span class="nt">"dt_create"</span><span class="p">:</span><span class="s2">"2016-04-13T23:51:18.170Z"</span><span class="p">,</span><span class="w">
         </span><span class="nt">"__v"</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="w">
         </span><span class="nt">"id"</span><span class="p">:</span><span class="s2">"570edb76fc24091627e82086"</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="p">{</span><span class="w">  
         </span><span class="nt">"_id"</span><span class="p">:</span><span class="s2">"570edcc7fc24091627e82087"</span><span class="p">,</span><span class="w">
         </span><span class="nt">"title"</span><span class="p">:</span><span class="s2">"Goodbye World"</span><span class="p">,</span><span class="w">
         </span><span class="nt">"year"</span><span class="p">:</span><span class="mi">2014</span><span class="p">,</span><span class="w">
         </span><span class="nt">"director"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"5503de76fc24091627e82568"</span><span class="p">,</span><span class="w">
         </span><span class="nt">"appId"</span><span class="p">:</span><span class="s2">"stamplay-docs"</span><span class="p">,</span><span class="w">
         </span><span class="nt">"cobjectId"</span><span class="p">:</span><span class="s2">"movie"</span><span class="p">,</span><span class="w">
         </span><span class="nt">"actions"</span><span class="p">:{</span><span class="w"> </span><span class="err">...</span><span class="w"> </span><span class="p">},</span><span class="w">
         </span><span class="nt">"dt_update"</span><span class="p">:</span><span class="s2">"2016-04-13T23:56:55.060Z"</span><span class="p">,</span><span class="w">
         </span><span class="nt">"dt_create"</span><span class="p">:</span><span class="s2">"2016-04-13T23:56:55.060Z"</span><span class="p">,</span><span class="w">
         </span><span class="nt">"__v"</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="w">
         </span><span class="nt">"id"</span><span class="p">:</span><span class="s2">"570edcc7fc24091627e82087"</span><span class="w">
      </span><span class="p">}</span><span class="w">
   </span><span class="p">],</span><span class="w">
   </span><span class="nt">"pagination"</span><span class="p">:{</span><span class="w">  
      </span><span class="nt">"page"</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="w">
      </span><span class="nt">"per_page"</span><span class="p">:</span><span class="mi">20</span><span class="p">,</span><span class="w">
      </span><span class="nt">"total_pages"</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="w">
      </span><span class="nt">"total_elements"</span><span class="p">:</span><span class="mi">2</span><span class="w">
   </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">

</span></code></pre>

<p>To find any records whose field value is equal to the current user's <code>_id</code>, you can use the find by owner resource to simplify querying through different fields.</p>

<p>Make a <code>GET</code> request to the Object resource for the object model. Specifying the attribute in the resource URI.</p>

<p>The object type for the example is <code>movie</code>.</p>

<h2 id="update-objects">Update Objects</h2>

<p>To update an object record partially, or completely overwrite the existing record.</p>

<h3 id="partial-update">Partial Update</h3>

<pre class="highlight shell"><code>  curl -X <span class="s2">"PATCH"</span> <span class="s2">"https://APP-ID.stamplayapp.com/api/cobject/v1/movie/:object_id"</span> <span class="se">\</span>
    -H <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
    -d <span class="s2">"{</span><span class="se">\"</span><span class="s2">title</span><span class="se">\"</span><span class="s2">:</span><span class="se">\"</span><span class="s2">Goodbye World</span><span class="se">\"</span><span class="s2">}"</span>
</code></pre>

<pre class="highlight javascript"><code>  <span class="kd">var</span> <span class="nx">data</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">"title"</span> <span class="p">:</span> <span class="s2">"Goodbye World"</span>
  <span class="p">}</span>

  <span class="nx">Stamplay</span><span class="p">.</span><span class="nb">Object</span><span class="p">(</span><span class="s2">"movie"</span><span class="p">).</span><span class="nx">patch</span><span class="p">(</span><span class="s2">"object_id"</span><span class="p">,</span> <span class="nx">data</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">res</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// success</span>
    <span class="p">},</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// error</span>
    <span class="p">})</span>
</code></pre>

<pre class="highlight nodejs"><code>  <span class="kd">var</span> <span class="nx">data</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">"title"</span> <span class="p">:</span> <span class="s2">"Goodbye World"</span>
  <span class="p">}</span>

  <span class="nx">Stamplay</span><span class="p">.</span><span class="nb">Object</span><span class="p">(</span><span class="s2">"movie"</span><span class="p">).</span><span class="nx">patch</span><span class="p">(</span><span class="s2">"object_id"</span><span class="p">,</span> <span class="nx">data</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">res</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// response</span>
  <span class="p">})</span>
</code></pre>

<blockquote>
  <p>The JSON response looks like this.</p>
</blockquote>

<pre class="highlight json"><code><span class="w">
</span><span class="p">{</span><span class="w">  
   </span><span class="nt">"_id"</span><span class="p">:</span><span class="s2">"570edb76fc24091627e82086"</span><span class="p">,</span><span class="w">
   </span><span class="nt">"title"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Goodbye World"</span><span class="p">,</span><span class="w">
   </span><span class="nt">"year"</span><span class="p">:</span><span class="mi">2016</span><span class="p">,</span><span class="w">
   </span><span class="nt">"director"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"5503de76fc24091627e82568"</span><span class="p">,</span><span class="w">
   </span><span class="nt">"appId"</span><span class="p">:</span><span class="s2">"stamplay-docs"</span><span class="p">,</span><span class="w">
   </span><span class="nt">"cobjectId"</span><span class="p">:</span><span class="s2">"movie"</span><span class="p">,</span><span class="w">
   </span><span class="nt">"actions"</span><span class="p">:{</span><span class="w"> </span><span class="err">...</span><span class="w"> </span><span class="p">},</span><span class="w">
   </span><span class="nt">"dt_update"</span><span class="p">:</span><span class="s2">"2016-04-13T23:51:18.170Z"</span><span class="p">,</span><span class="w">
   </span><span class="nt">"dt_create"</span><span class="p">:</span><span class="s2">"2016-04-13T23:51:18.170Z"</span><span class="p">,</span><span class="w">
   </span><span class="nt">"__v"</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="w">
   </span><span class="nt">"id"</span><span class="p">:</span><span class="s2">"570edb76fc24091627e82086"</span><span class="w">
</span><span class="p">}</span><span class="w">

</span></code></pre>

<p>To make a partial update to an object record, perform a <code>PATCH</code> request to the Object API resource with any fields to update on the stored record in the request body.</p>

<table>
  <thead>
    <tr>
      <th>Attribute</th>
      <th> </th>
      <th style="text-align: center">Optional</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>object_id</code></td>
      <td>the Stamplay <code>_id</code> of the object to update</td>
      <td style="text-align: center"><i class="unchecked"></i></td>
    </tr>
  </tbody>
</table>

<p>The object type for the example is <code>movie</code>.</p>

<h3 id="complete-update">Complete Update</h3>

<pre class="highlight shell"><code>  curl -X <span class="s2">"PUT"</span> <span class="s2">"https://APP-ID.stamplayapp.com/api/cobject/v1/movie/:object_id"</span> <span class="se">\</span>
    -H <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
    -d <span class="s2">"{</span><span class="se">\"</span><span class="s2">title</span><span class="se">\"</span><span class="s2">:</span><span class="se">\"</span><span class="s2">Goodbye World</span><span class="se">\"</span><span class="s2">,</span><span class="se">\"</span><span class="s2">year</span><span class="se">\"</span><span class="s2">:</span><span class="se">\"</span><span class="s2">2001</span><span class="se">\"</span><span class="s2">}"</span>
</code></pre>

<pre class="highlight javascript"><code>  <span class="kd">var</span> <span class="nx">data</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">"title"</span> <span class="p">:</span> <span class="s2">"Goodbye World"</span>
  <span class="p">}</span>

  <span class="nx">Stamplay</span><span class="p">.</span><span class="nb">Object</span><span class="p">(</span><span class="s2">"movie"</span><span class="p">).</span><span class="nx">update</span><span class="p">(</span><span class="s2">"object_id"</span><span class="p">,</span> <span class="nx">data</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">res</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// success</span>
    <span class="p">},</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// error</span>
    <span class="p">})</span>
</code></pre>

<pre class="highlight nodejs"><code>  <span class="kd">var</span> <span class="nx">data</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">"title"</span> <span class="p">:</span> <span class="s2">"Goodbye World"</span>
  <span class="p">}</span>

  <span class="nx">Stamplay</span><span class="p">.</span><span class="nb">Object</span><span class="p">(</span><span class="s2">"movie"</span><span class="p">).</span><span class="nx">update</span><span class="p">(</span><span class="s2">"object_id"</span><span class="p">,</span> <span class="nx">data</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">res</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// response</span>
  <span class="p">})</span>
</code></pre>

<blockquote>
  <p>The JSON response looks like this.</p>
</blockquote>

<pre class="highlight json"><code><span class="w">
</span><span class="p">{</span><span class="w">  
   </span><span class="nt">"_id"</span><span class="p">:</span><span class="s2">"570edb76fc24091627e82086"</span><span class="p">,</span><span class="w">
   </span><span class="nt">"title"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Goodbye World"</span><span class="p">,</span><span class="w">
   </span><span class="nt">"year"</span><span class="p">:</span><span class="mi">2016</span><span class="p">,</span><span class="w">
   </span><span class="nt">"director"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"5503de76fc24091627e82568"</span><span class="p">,</span><span class="w">
   </span><span class="nt">"appId"</span><span class="p">:</span><span class="s2">"stamplay-docs"</span><span class="p">,</span><span class="w">
   </span><span class="nt">"cobjectId"</span><span class="p">:</span><span class="s2">"movie"</span><span class="p">,</span><span class="w">
   </span><span class="nt">"actions"</span><span class="p">:{</span><span class="w"> </span><span class="err">...</span><span class="w"> </span><span class="p">},</span><span class="w">
   </span><span class="nt">"dt_update"</span><span class="p">:</span><span class="s2">"2016-04-13T23:51:18.170Z"</span><span class="p">,</span><span class="w">
   </span><span class="nt">"dt_create"</span><span class="p">:</span><span class="s2">"2016-04-13T23:51:18.170Z"</span><span class="p">,</span><span class="w">
   </span><span class="nt">"__v"</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="w">
   </span><span class="nt">"id"</span><span class="p">:</span><span class="s2">"570edb76fc24091627e82086"</span><span class="w">
</span><span class="p">}</span><span class="w">

</span></code></pre>

<p>To overwrite an object record, perform a <code>PUT</code> request to the Object API resource with a complete represenation to write over the stored record in the request body.</p>

<table>
  <thead>
    <tr>
      <th>Attribute</th>
      <th> </th>
      <th style="text-align: center">Optional</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>object_id</code></td>
      <td>the Stamplay <code>_id</code> of the object to update</td>
      <td style="text-align: center"><i class="unchecked"></i></td>
    </tr>
  </tbody>
</table>

<h2 id="remove-objects">Remove Objects</h2>

<p>To remove an object record, send a <code>DELETE</code> request with the <code>_id</code> of the record to remove in the Object API resource URI.</p>

<pre class="highlight shell"><code>  curl -X <span class="s2">"DELETE"</span> <span class="s2">"https://APP-ID.stamplayapp.com/api/cobject/v1/movie/:object_id"</span>
</code></pre>

<pre class="highlight javascript"><code>  <span class="nx">Stamplay</span><span class="p">.</span><span class="nb">Object</span><span class="p">(</span><span class="s2">"movie"</span><span class="p">).</span><span class="nx">remove</span><span class="p">(</span><span class="s2">"object_id"</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">res</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// success</span>
    <span class="p">},</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// error</span>
    <span class="p">})</span>
</code></pre>

<pre class="highlight nodejs"><code>  <span class="nx">Stamplay</span><span class="p">.</span><span class="nb">Object</span><span class="p">(</span><span class="s2">"movie"</span><span class="p">).</span><span class="nx">remove</span><span class="p">(</span><span class="s2">"object_id"</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">res</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// response</span>
  <span class="p">})</span>
</code></pre>

<blockquote>
  <p>The JSON response will look like this.</p>
</blockquote>

<pre class="highlight json"><code><span class="w">
</span><span class="p">{</span><span class="w">
   </span><span class="nt">"_id"</span><span class="p">:</span><span class="s2">"570edb76fc24091627e82086"</span><span class="p">,</span><span class="w">
   </span><span class="nt">"title"</span><span class="p">:</span><span class="s2">"Hello World"</span><span class="p">,</span><span class="w">
   </span><span class="nt">"year"</span><span class="p">:</span><span class="mi">2016</span><span class="p">,</span><span class="w">
   </span><span class="nt">"appId"</span><span class="p">:</span><span class="s2">"stamplay-docs"</span><span class="p">,</span><span class="w">
   </span><span class="nt">"cobjectId"</span><span class="p">:</span><span class="s2">"movie"</span><span class="p">,</span><span class="w">
   </span><span class="nt">"__v"</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="w">
   </span><span class="nt">"actions"</span><span class="p">:{</span><span class="w">
      </span><span class="err">...</span><span class="w">
   </span><span class="p">},</span><span class="w">
   </span><span class="nt">"dt_update"</span><span class="p">:</span><span class="s2">"2016-04-13T23:51:18.170Z"</span><span class="p">,</span><span class="w">
   </span><span class="nt">"dt_create"</span><span class="p">:</span><span class="s2">"2016-04-13T23:51:18.170Z"</span><span class="p">,</span><span class="w">
   </span><span class="nt">"id"</span><span class="p">:</span><span class="s2">"570edb76fc24091627e82086"</span><span class="w">
</span><span class="p">}</span><span class="w">

</span></code></pre>

<table>
  <thead>
    <tr>
      <th>Attribute</th>
      <th> </th>
      <th style="text-align: center">Optional</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>object_id</code></td>
      <td>the Stamplay <code>_id</code> of the object to remove</td>
      <td style="text-align: center"><i class="unchecked"></i></td>
    </tr>
  </tbody>
</table>

<h2 id="relationships">Relationships</h2>

<p>Data relationships are pointers from one record to another.</p>

<h3 id="user-relationship">User Relationship</h3>

<pre class="highlight shell"><code>  curl -X <span class="s2">"PATCH"</span> <span class="s2">"https://APP-ID.stamplayapp.com/api/cobject/v1/movie/:object_id"</span> <span class="se">\</span>
    -H <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
    -d <span class="s2">"{</span><span class="se">\"</span><span class="s2">director</span><span class="se">\"</span><span class="s2">:</span><span class="se">\"</span><span class="s2">56cf08e362641ca813b1ae6c</span><span class="se">\"</span><span class="s2">}"</span>
</code></pre>

<pre class="highlight javascript"><code>  <span class="nx">Stamplay</span><span class="p">.</span><span class="nb">Object</span><span class="p">(</span><span class="s2">"movie"</span><span class="p">).</span><span class="nx">patch</span><span class="p">(</span><span class="s2">"object_id"</span><span class="p">,</span> <span class="p">{</span> <span class="na">director</span><span class="p">:</span> <span class="s2">"56cf08e362641ca813b1ae6c"</span> <span class="p">})</span>
    <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">res</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// success</span>
    <span class="p">},</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// error</span>
    <span class="p">})</span>
</code></pre>

<pre class="highlight nodejs"><code>  <span class="nx">Stamplay</span><span class="p">.</span><span class="nb">Object</span><span class="p">(</span><span class="s2">"movie"</span><span class="p">).</span><span class="nx">patch</span><span class="p">(</span><span class="s2">"object_id"</span><span class="p">,</span> <span class="p">{</span> <span class="na">director</span><span class="p">:</span> <span class="s2">"56cf08e362641ca813b1ae6c"</span> <span class="p">},</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">res</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// response</span>
  <span class="p">})</span>
</code></pre>

<p>A <strong>User</strong> relationship is a pointer to a user record. This field type is to be set only as an <code>_id</code> of a user record.</p>

<p>This is so it may be populated with the parent object, eliminating the need for a subsequent request to fetch the relationship data. To populate the <code>owner</code> field, include the query parameter <code>populate_owner</code> as <code>true</code> in your request.</p>

<p>The <code>owner</code> property is a default User relationship field on an Object record.</p>

<p>When using the SDK, this field is set if a current user session is in progress, otherwise it is left blank. To add owner's to your Object records when using the REST API or Node.js SDK, set this field as the owner of the record.</p>

<p>To manage these relationships, just update this field to the "_id" of the User to reference in the relationship.</p>

<table>
  <thead>
    <tr>
      <th>Attribute</th>
      <th> </th>
      <th style="text-align: center">Optional</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>object_id</code></td>
      <td>the Stamplay <code>_id</code> of the object to update</td>
      <td style="text-align: center"><i class="unchecked"></i></td>
    </tr>
  </tbody>
</table>

<p>In this example, <code>movie</code> is the object type, and the <code>director</code> field is a User Relationship field.</p>

<h3 id="object-relationships">Object Relationships</h3>

<pre class="highlight shell"><code>  curl -X <span class="s2">"PATCH"</span> <span class="s2">"https://APP-ID.stamplayapp.com/api/cobject/v1/movie/:object_id"</span> <span class="se">\</span>
    -H <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
    -d <span class="s2">"{</span><span class="se">\"</span><span class="s2">characters</span><span class="se">\"</span><span class="s2">:[</span><span class="se">\"</span><span class="s2">57cf08e362641ca813b1ae6c</span><span class="se">\"</span><span class="s2">,</span><span class="se">\"</span><span class="s2">56cf09e362641sa813b1ae6d</span><span class="se">\"</span><span class="s2">,</span><span class="se">\"</span><span class="s2">54cfdae662641ca813b1ae6c</span><span class="se">\"</span><span class="s2">]}"</span>
</code></pre>

<pre class="highlight javascript"><code>  <span class="nx">Stamplay</span><span class="p">.</span><span class="nb">Object</span><span class="p">(</span><span class="s2">"movie"</span><span class="p">).</span><span class="nx">push</span><span class="p">(</span><span class="s2">"object_id"</span><span class="p">,</span> <span class="s2">"characters"</span><span class="p">,</span> <span class="s2">"57cf08e362641ca813b1ae6c"</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">res</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// success</span>
    <span class="p">},</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// error</span>
    <span class="p">})</span>
</code></pre>

<pre class="highlight nodejs"><code>  <span class="kd">var</span> <span class="nx">movieChars</span> <span class="o">=</span> <span class="p">[</span><span class="s2">"57cf08e362641ca813b1ae6c"</span><span class="p">,</span> <span class="s2">"56cf09e362641sa813b1ae6d"</span><span class="p">,</span> <span class="s2">"54cfdae662641ca813b1ae6c"</span><span class="p">]</span>
  <span class="nx">Stamplay</span><span class="p">.</span><span class="nb">Object</span><span class="p">(</span><span class="s2">"movie"</span><span class="p">).</span><span class="nx">patch</span><span class="p">(</span><span class="s2">"object_id"</span><span class="p">,</span> <span class="nx">movieChars</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">res</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// response</span>
  <span class="p">})</span>
</code></pre>
<p>An <strong>Object</strong> relationship is a pointer to another record; specifically a certain type of record as specified when defining the schema.</p>

<p>This field type is to contain only an array of the property <code>_id</code> of a each related record of the relationship type.</p>

<p>This is so it may be populated with the parent object, eliminating the need for a subsequent request to fetch the relationship data. To populate these fields, add the query parameter <code>populate</code> as <code>true</code> to your request.</p>

<p>To manage this relationship field, update the field to represent the collection of object references to store.</p>

<p>The <strong>JavaScript SDK</strong> has a <code>push</code> method to allow an easier method for pushing new relationships onto the array field. See the example in the <code>JavaScript</code> tab, otherwise you will need to manage this manually by sending a complete copy of the field in the request.</p>

<table>
  <thead>
    <tr>
      <th>Attribute</th>
      <th> </th>
      <th style="text-align: center">Optional</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>object_id</code></td>
      <td>the Stamplay <code>_id</code> of the object to add a relationship to</td>
      <td style="text-align: center"><i class="unchecked"></i></td>
    </tr>
  </tbody>
</table>

<p>In this example, <code>movie</code> is the object type, and the <code>characters</code> field is a <strong>Object Relationship</strong> field.</p>

<h3 id="retrieving-related-records">Retrieving Related Records</h3>

<p>To retrieve related records, use the <code>populate</code> parameter in any <code>GET</code> request, and any populable fields will be filled with their respective objects in place of their <code>_id</code>.</p>

<pre class="highlight shell"><code>  curl -X <span class="s2">"GET"</span> <span class="s2">"https://APP-ID.stamplayapp.com/api/cobject/v1/movie?populate=true"</span>
</code></pre>

<pre class="highlight javascript"><code>  <span class="nx">Stamplay</span><span class="p">.</span><span class="nb">Object</span><span class="p">(</span><span class="s2">"movie"</span><span class="p">).</span><span class="nx">get</span><span class="p">({</span> <span class="na">populate</span> <span class="p">:</span> <span class="kc">true</span> <span class="p">})</span>
    <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">res</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// success</span>
    <span class="p">},</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// error</span>
    <span class="p">})</span>
</code></pre>

<pre class="highlight nodejs"><code>  <span class="nx">Stamplay</span><span class="p">.</span><span class="nb">Object</span><span class="p">(</span><span class="s2">"movie"</span><span class="p">).</span><span class="nx">get</span><span class="p">({</span> <span class="na">populate</span> <span class="p">:</span> <span class="kc">true</span> <span class="p">},</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">res</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// response</span>
  <span class="p">})</span>
</code></pre>

<h2 id="files">Files</h2>

<pre class="highlight shell"><code>  curl -X <span class="s2">"POST"</span> <span class="se">\</span>
  -F <span class="s1">'image=@/path/to/pictures/picture.jpg'</span> <span class="se">\</span>
  -F <span class="s1">'title=Lord of the Rings'</span> <span class="se">\</span>
  <span class="s2">"https://APP-ID.stamplayapp.com/api/cobject/v1/movie"</span>
</code></pre>

<pre class="highlight javascript"><code>  <span class="kd">var</span> <span class="nx">url</span> <span class="o">=</span> <span class="s1">'https://APP-ID.stamplayapp.com/api/cobject/v1/movie'</span><span class="p">;</span>
  <span class="kd">var</span> <span class="nx">input</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">'file-upload'</span><span class="p">);</span>

  <span class="kd">var</span> <span class="nx">fd</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">FormData</span><span class="p">();</span>
  <span class="nx">fd</span><span class="p">.</span><span class="nx">append</span><span class="p">(</span> <span class="s1">'file'</span><span class="p">,</span> <span class="nx">input</span><span class="p">.</span><span class="nx">files</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="p">);</span>
  <span class="nx">$</span><span class="p">.</span><span class="nx">ajax</span><span class="p">({</span>
      <span class="na">method</span> <span class="p">:</span> <span class="s1">'POST'</span>
      <span class="na">url</span><span class="p">:</span> <span class="nx">url</span><span class="p">,</span>
      <span class="na">data</span><span class="p">:</span> <span class="nx">fd</span><span class="p">,</span>
      <span class="na">contentType</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
      <span class="na">processData</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
      <span class="na">success</span> <span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">response</span><span class="p">){</span>
          <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">response</span><span class="p">);</span>
      <span class="p">},</span>
      <span class="na">error</span> <span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">){</span>
          <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">err</span><span class="p">.</span><span class="nx">responseText</span><span class="p">);</span>
      <span class="p">}</span>
  <span class="p">});</span>
</code></pre>

<pre class="highlight nodejs"><code>  <span class="kr">const</span> <span class="nx">request</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'request'</span><span class="p">);</span>
  <span class="kr">const</span> <span class="nx">fs</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'fs'</span><span class="p">);</span>
  <span class="kr">const</span> <span class="nx">path</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'path'</span><span class="p">);</span>

  <span class="kd">var</span> <span class="nx">formData</span> <span class="o">=</span> <span class="p">{</span>
    <span class="na">image</span><span class="p">:</span> <span class="nx">fs</span><span class="p">.</span><span class="nx">createReadStream</span><span class="p">(</span><span class="nx">path</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="nx">__dirname</span><span class="p">,</span> <span class="s1">'/picture.jpg'</span><span class="p">)),</span>
  <span class="p">};</span>

  <span class="nx">request</span><span class="p">.</span><span class="nx">post</span><span class="p">({</span>
    <span class="na">url</span><span class="p">:</span> <span class="s1">'https://APP-ID.stamplayapp.com/api/cobject/v1/movie'</span><span class="p">,</span>
    <span class="na">formData</span><span class="p">:</span> <span class="nx">formData</span>
  <span class="p">},</span> <span class="kd">function</span> <span class="nx">optionalCallback</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">httpResponse</span><span class="p">,</span> <span class="nx">body</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="s1">'upload failed:'</span><span class="p">,</span> <span class="nx">err</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">httpResponse</span><span class="p">.</span><span class="nx">statusCode</span> <span class="o">!=</span> <span class="mi">200</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="s1">'upload failed'</span><span class="p">,</span> <span class="nx">body</span><span class="p">)</span>
    <span class="p">}</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">'Upload successful!  Server responded with:'</span><span class="p">,</span> <span class="nx">body</span><span class="p">);</span>
  <span class="p">});</span>
</code></pre>

<p>Stamplay objects support file upload as a property type. This let you attach any file to an object record via API. There are no file type restrictions but maximum upload size is 10 MB.</p>

<p>To save an object containing a file type, the request must have content-type <code>multipart/form-data</code>, note that you can send in the same API call other properties that are not a file.</p>

<h2 id="advanced-queries">Advanced Queries</h2>

<p>In some cases, retrieving objects by an <code>_id</code> or by simple filter methods aren't powerful enough to specify which objects you want to retrieve from the back-end.</p>

<p>Queries offer a different way to retrieve a list of objects, or users.</p>

<h3 id="introduction">Introduction</h3>

<div class="lang-content shell">
  <p>Advanced query methods use a <code>where</code> parameter set to a JSON query string.</p>
</div>

<div class="lang-content javascript nodejs">
  <p>The <code>Stamplay.Query</code> class uses use a <code>where</code> url parameter set to a JSON query string under the hood.</p>

</div>

<pre class="highlight shell"><code>  ?where<span class="o">={</span> field : <span class="o">{</span> <span class="nv">$query_operator</span> : field_value <span class="o">}</span>
</code></pre>

<pre class="highlight javascript"><code><span class="c1">// Querying Users</span>
  <span class="err">`</span><span class="nx">Stamplay</span><span class="p">.</span><span class="nx">Query</span><span class="p">(</span><span class="s2">"user"</span><span class="p">,</span> <span class="s2">"users"</span><span class="p">).</span><span class="nx">someQueryMethod</span><span class="p">()</span><span class="err">`</span>

<span class="c1">// Querying Objects</span>
  <span class="err">`</span><span class="nx">Stamplay</span><span class="p">.</span><span class="nx">Query</span><span class="p">(</span><span class="s2">"object"</span><span class="p">,</span> <span class="s2">"cobject_id"</span><span class="p">).</span><span class="nx">someQueryMethod</span><span class="p">()</span><span class="err">`</span>

</code></pre>

<pre class="highlight nodejs"><code><span class="c1">// Querying Users</span>
  <span class="err">`</span><span class="nx">Stamplay</span><span class="p">.</span><span class="nx">Query</span><span class="p">(</span><span class="s2">"user"</span><span class="p">,</span> <span class="s2">"users"</span><span class="p">).</span><span class="nx">someQueryMethod</span><span class="p">()</span><span class="err">`</span>

<span class="c1">// Querying Objects</span>
  <span class="err">`</span><span class="nx">Stamplay</span><span class="p">.</span><span class="nx">Query</span><span class="p">(</span><span class="s2">"object"</span><span class="p">,</span> <span class="s2">"cobject_id"</span><span class="p">).</span><span class="nx">someQueryMethod</span><span class="p">()</span><span class="err">`</span>

</code></pre>

<p>The advanced filter methods used are just MongoDB query operators, that Stamplay allow's to be set inside query string on the client side.</p>

<p>The exhaustive list of MongoDB operators available can be found in the API Overview Section under <a href="#advanced-queries">Advanced Queries</a>.</p>

<h3 id="comparing-values">Comparing Values</h3>

<p>When filtering through certain field types, we often need the ability to check if a value falls within a certain range, versus strictly matching.</p>

<p>This often applies to integer value type fields where one might want to return all records where a value is greater than one value but less than or equal to another.</p>

<p>Another scenario, within date fields. We can use the same comparator expressions to see if a date value if before or after, or on another.</p>

<p>When querying a date field, pass in an data <code>ISO</code> string as the value to compare against, or unix timestamp.</p>

<div class="lang-content javascript nodejs">

  <p>The following methods are useful for doing such comparisons within a query:</p>

  <table>
    <thead>
      <tr>
        <th>Method</th>
        <th> </th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><code>greaterThan</code></td>
        <td>check if a value is greater than a given value</td>
      </tr>
      <tr>
        <td><code>greaterThanOrEqual</code></td>
        <td>check if a value is less than a given value</td>
      </tr>
      <tr>
        <td><code>lessThan</code></td>
        <td>check if a value is greater than a given value or equal to</td>
      </tr>
      <tr>
        <td><code>lessThanOrEqual</code></td>
        <td>check if a value is less than a given value or equal to</td>
      </tr>
    </tbody>
  </table>

</div>

<div class="lang-content shell">

  <p>The following operators are useful for doing such comparisons within a query:</p>

  <table>
    <thead>
      <tr>
        <th>Operator</th>
        <th> </th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><code>$gt</code></td>
        <td>check if a value is greater than a given value</td>
      </tr>
      <tr>
        <td><code>$gte</code></td>
        <td>check if a value is less than a given value</td>
      </tr>
      <tr>
        <td><code>$lt</code></td>
        <td>check if a value is greater than a given value or equal to</td>
      </tr>
      <tr>
        <td><code>$lte</code></td>
        <td>check if a value is less than a given value or equal to</td>
      </tr>
    </tbody>
  </table>

</div>

<h4 id="greater-than">Greater Than</h4>

<div class="lang-content shell">
  <p>To retrieve all records where an integer specified is <strong>greater than</strong> another, or where a date is <strong>after</strong> another date, use the <code>$gt</code> mongo operator.</p>
</div>

<div class="lang-content javascript nodejs">
  <p>To retrieve all records where an integer specified is <strong>greater than</strong> another, or where a date is <strong>after</strong> another date, use the <code>greaterThan</code> SDK method.</p>
</div>

<pre class="highlight shell"><code>// returns records where the rating is greater than 4
curl -X <span class="s2">"GET"</span> <span class="s1">'https://APP-ID.stamplayapp.com/api/cobject/v1/movie?where=\{"actions.ratings.total":\{"$gt":4\}\}'</span>

// returns records that were created after January 15, 2015
curl -X <span class="s2">"GET"</span> <span class="s1">'https://APP-ID.stamplayapp.com/api/cobject/v1/movie?where=\{"dt_create":\{"$gt":"2015-01-15T08:00:00.000Z"\}\}'</span>
</code></pre>

<pre class="highlight javascript"><code>
  <span class="c1">// returns records where the rating is greater than 4</span>
  <span class="nx">Stamplay</span><span class="p">.</span><span class="nx">Query</span><span class="p">(</span><span class="s1">'object'</span><span class="p">,</span><span class="s1">'movie'</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">greaterThan</span><span class="p">(</span><span class="s1">'actions.ratings.total'</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">exec</span><span class="p">()</span>
    <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
      <span class="c1">// success</span>
    <span class="p">},</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// error</span>
    <span class="p">})</span>

  <span class="c1">// returns records that were created after January 15, 2015</span>
  <span class="nx">Stamplay</span><span class="p">.</span><span class="nx">Query</span><span class="p">(</span><span class="s1">'object'</span><span class="p">,</span><span class="s1">'movie'</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">greaterThan</span><span class="p">(</span><span class="s1">'dt_create'</span><span class="p">,</span> <span class="s2">"2015-01-15T08:00:00.000Z"</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">exec</span><span class="p">()</span>
    <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
      <span class="c1">// success</span>
    <span class="p">},</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// error</span>
    <span class="p">})</span>
</code></pre>

<pre class="highlight nodejs"><code>
  <span class="c1">// returns records where the rating is greater than 4</span>
  <span class="nx">Stamplay</span><span class="p">.</span><span class="nx">Query</span><span class="p">(</span><span class="s1">'object'</span><span class="p">,</span><span class="s1">'movie'</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">greaterThan</span><span class="p">(</span><span class="s1">'actions.ratings.total'</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">exec</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">res</span><span class="p">){</span>
      <span class="c1">// response</span>
    <span class="p">})</span>

  <span class="c1">// returns records that were created after January 15, 2015</span>
  <span class="nx">Stamplay</span><span class="p">.</span><span class="nx">Query</span><span class="p">(</span><span class="s1">'object'</span><span class="p">,</span><span class="s1">'movie'</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">greaterThan</span><span class="p">(</span><span class="s1">'dt_create'</span><span class="p">,</span> <span class="s2">"2015-01-15T08:00:00.000Z"</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">exec</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">res</span><span class="p">){</span>
      <span class="c1">// response</span>
    <span class="p">})</span>

</code></pre>

<h4 id="greater-than-or-equal-to">Greater Than Or Equal To</h4>

<div class="lang-content shell">
  <p>To retrieve all records where an integer specified is <strong>greater than or equal</strong> to another, or where a date is <strong>on or after</strong> another date, use the <code>$gte</code> mongo operator.</p>
</div>

<div class="lang-content javascript nodejs">
  <p>To retrieve all records where an integer specified is <strong>greater than or equal to</strong> another, or where a date is <strong>on or after</strong> another date, use the <code>greaterThanOrEqual</code> SDK method.</p>
</div>

<pre class="highlight shell"><code>  // returns records with a rating of 4 or greater
curl -X <span class="s2">"GET"</span> <span class="s1">'https://APP-ID.stamplayapp.com/api/cobject/v1/movie?where=\{"actions.ratings.total":\{"$gte":4\}\}'</span>

// returns records that were last updated on or after April 11, 2012
curl -X <span class="s2">"GET"</span> <span class="s1">'https://APP-ID.stamplayapp.com/api/cobject/v1/movie?where=\{"dt_update":\{"$gte":"2012-04-11T07:00:00.000Z"\}\}'</span>

</code></pre>

<pre class="highlight javascript"><code>  <span class="c1">// returns records with a rating of 4 or greater</span>
  <span class="nx">Stamplay</span><span class="p">.</span><span class="nx">Query</span><span class="p">(</span><span class="s1">'object'</span><span class="p">,</span><span class="s1">'movie'</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">greaterThanOrEqual</span><span class="p">(</span><span class="s1">'actions.ratings.total'</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">exec</span><span class="p">()</span>
    <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
      <span class="c1">// success</span>
    <span class="p">},</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// error</span>
    <span class="p">})</span>

  <span class="c1">// returns records that were last updated on or after April 11, 2012</span>
  <span class="nx">Stamplay</span><span class="p">.</span><span class="nx">Query</span><span class="p">(</span><span class="s1">'object'</span><span class="p">,</span><span class="s1">'movie'</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">greaterThanOrEqual</span><span class="p">(</span><span class="s1">'dt_update'</span><span class="p">,</span> <span class="s2">"2012-04-11T07:00:00.000Z"</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">exec</span><span class="p">()</span>
    <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
      <span class="c1">// success</span>
    <span class="p">},</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// error</span>
    <span class="p">})</span>

</code></pre>

<pre class="highlight nodejs"><code>
  <span class="c1">// returns records with a rating of 4 or greater</span>
  <span class="nx">Stamplay</span><span class="p">.</span><span class="nx">Query</span><span class="p">(</span><span class="s1">'object'</span><span class="p">,</span><span class="s1">'movie'</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">greaterThanOrEqual</span><span class="p">(</span><span class="s1">'actions.ratings.total'</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">exec</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">res</span><span class="p">){</span>
      <span class="c1">// response</span>
    <span class="p">})</span>

  <span class="c1">// returns records that were last updated on or after April 11, 2012</span>
  <span class="nx">Stamplay</span><span class="p">.</span><span class="nx">Query</span><span class="p">(</span><span class="s1">'object'</span><span class="p">,</span><span class="s1">'movie'</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">greaterThanOrEqual</span><span class="p">(</span><span class="s1">'dt_update'</span><span class="p">,</span> <span class="s2">"2012-04-11T07:00:00.000Z"</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">exec</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">res</span><span class="p">){</span>
      <span class="c1">// response</span>
    <span class="p">})</span>

</code></pre>

<h4 id="less-than">Less Than</h4>

<div class="lang-content shell">
  <p>To retrieve all records where an integer specified is <strong>less</strong> than another, or where a date is <strong>before</strong> another date, use the <code>$lt</code> mongo operator.</p>
</div>

<div class="lang-content javascript nodejs">
  <p>To retrieve all records where an integer specified is <strong>less than</strong> another, or where a date is <strong>before</strong> another date, use the <code>lessThan</code> SDK method.</p>
</div>

<pre class="highlight shell"><code>
  // returns records with a rating of less than 4
  curl -X <span class="s2">"GET"</span> <span class="s1">'https://APP-ID.stamplayapp.com/api/cobject/v1/movie?where=\{"actions.ratings.total":\{"$lt":4\}\}'</span>

  // returns records that were created before January 15, 2015
  curl -X <span class="s2">"GET"</span> <span class="s1">'https://APP-ID.stamplayapp.com/api/cobject/v1/movie?where=\{"dt_create":\{"$lt":"2015-01-15T08:00:00.000Z\}\}'</span>

</code></pre>

<pre class="highlight javascript"><code>
  <span class="c1">// returns records with a rating of less than 4</span>
  <span class="nx">Stamplay</span><span class="p">.</span><span class="nx">Query</span><span class="p">(</span><span class="s1">'object'</span><span class="p">,</span><span class="s1">'movie'</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">lessThan</span><span class="p">(</span><span class="s1">'actions.ratings.total'</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">exec</span><span class="p">()</span>
    <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
      <span class="c1">// success</span>
    <span class="p">},</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// error</span>
    <span class="p">})</span>

  <span class="c1">// returns records that were created before January 15, 2015</span>
  <span class="nx">Stamplay</span><span class="p">.</span><span class="nx">Query</span><span class="p">(</span><span class="s1">'object'</span><span class="p">,</span><span class="s1">'movie'</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">lessThan</span><span class="p">(</span><span class="s1">'actions.ratings.total'</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">exec</span><span class="p">()</span>
    <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
      <span class="c1">// success</span>
    <span class="p">},</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// error</span>
    <span class="p">})</span>

</code></pre>

<pre class="highlight nodejs"><code>
  <span class="c1">// returns records with a rating of less than 4</span>
  <span class="nx">Stamplay</span><span class="p">.</span><span class="nx">Query</span><span class="p">(</span><span class="s1">'object'</span><span class="p">,</span><span class="s1">'movie'</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">lessThan</span><span class="p">(</span><span class="s1">'actions.ratings.total'</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">exec</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">res</span><span class="p">){</span>
      <span class="c1">// response</span>
    <span class="p">})</span>

  <span class="c1">// returns records that were created before January 15, 2015</span>
  <span class="nx">Stamplay</span><span class="p">.</span><span class="nx">Query</span><span class="p">(</span><span class="s1">'object'</span><span class="p">,</span><span class="s1">'movie'</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">lessThan</span><span class="p">(</span><span class="s1">'actions.ratings.total'</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">exec</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">res</span><span class="p">){</span>
      <span class="c1">// response</span>
    <span class="p">})</span>

</code></pre>

<h4 id="less-than-or-equal-to">Less Than Or Equal To</h4>

<div class="lang-content shell">
  <p>To retrieve all records where an integer specified is <strong>less than or equal to</strong> another, or where a date is <strong>on or before</strong> another date, use the <code>$lte</code> mongo operator.</p>
</div>

<div class="lang-content javascript nodejs">
  <p>To retrieve all records where an integer specified is <strong>less than or equal to</strong> another, or where a date is <strong>on or before</strong> another date, use the <code>lessThanOrEqual</code> SDK method.</p>
</div>

<pre class="highlight shell"><code>
  // returns records with a rating of 4 or less
  curl -X <span class="s2">"GET"</span> <span class="s1">'https://APP-ID.stamplayapp.com/api/cobject/v1/movie?where=\{"actions.ratings.total":\{"$lte":4\}\}'</span>

  // returns records that were last updated on or before April 11, 2012
  curl -X <span class="s2">"GET"</span> <span class="s1">'https://APP-ID.stamplayapp.com/api/cobject/v1/movie?where=\{"dt_update":\{"$lte":"2012-04-11T07:00:00.000Z"\}\}'</span>

</code></pre>

<pre class="highlight javascript"><code>
  <span class="c1">// returns records with a rating of 4 or less</span>
  <span class="nx">Stamplay</span><span class="p">.</span><span class="nx">Query</span><span class="p">(</span><span class="s1">'object'</span><span class="p">,</span><span class="s1">'movie'</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">lessThanOrEqual</span><span class="p">(</span><span class="s1">'actions.ratings.total'</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">exec</span><span class="p">()</span>
    <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
      <span class="c1">// success</span>
    <span class="p">},</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// error</span>
    <span class="p">})</span>

  <span class="c1">// returns records that were last updated on or before April 11, 2012</span>
  <span class="nx">Stamplay</span><span class="p">.</span><span class="nx">Query</span><span class="p">(</span><span class="s1">'object'</span><span class="p">,</span><span class="s1">'movie'</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">lessThanOrEqual</span><span class="p">(</span><span class="s1">'dt_update'</span><span class="p">,</span> <span class="s2">"2012-04-11T07:00:00.000Z"</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">exec</span><span class="p">()</span>
    <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
      <span class="c1">// success</span>
    <span class="p">},</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// error</span>
    <span class="p">})</span>
</code></pre>

<pre class="highlight nodejs"><code>
  <span class="c1">// returns records with a rating of 4 or les</span>
  <span class="nx">Stamplay</span><span class="p">.</span><span class="nx">Query</span><span class="p">(</span><span class="s1">'object'</span><span class="p">,</span><span class="s1">'movie'</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">lessThanOrEqual</span><span class="p">(</span><span class="s1">'actions.ratings.total'</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">exec</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">res</span><span class="p">){</span>
      <span class="c1">// response</span>
    <span class="p">})</span>

  <span class="c1">// returns records that were last updated on or before April 11, 2012</span>
  <span class="nx">Stamplay</span><span class="p">.</span><span class="nx">Query</span><span class="p">(</span><span class="s1">'object'</span><span class="p">,</span><span class="s1">'movie'</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">lessThanOrEqual</span><span class="p">(</span><span class="s1">'dt_update'</span><span class="p">,</span> <span class="s2">"2012-04-11T07:00:00.000Z"</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">exec</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">res</span><span class="p">){</span>
      <span class="c1">// response</span>
    <span class="p">})</span>

</code></pre>

<h3 id="selection-and-sorting">Selection and Sorting</h3>

<p>Stamplay provides an easy to use interface for selecing what data from an object is returned, and in what order the records are returned.</p>

<h4 id="selecting-return-fields">Selecting Return Fields</h4>

<pre class="highlight shell"><code>  curl -X <span class="s2">"GET"</span> <span class="s1">'https://APP-ID.stamplayapp.com/api/cobject/v1/movie?select=title,actions.ratings.total'</span>
</code></pre>

<pre class="highlight javascript"><code>
  <span class="nx">Stamplay</span><span class="p">.</span><span class="nx">Query</span><span class="p">(</span><span class="s2">"object"</span><span class="p">,</span> <span class="s2">"cobject_id"</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">select</span><span class="p">(</span><span class="s2">"title"</span><span class="p">,</span> <span class="s2">"actions.ratings.total"</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">exec</span><span class="p">()</span>
    <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
      <span class="c1">// success</span>
    <span class="p">},</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// error</span>
    <span class="p">})</span>

</code></pre>

<pre class="highlight nodejs"><code>
  <span class="nx">Stamplay</span><span class="p">.</span><span class="nx">Query</span><span class="p">(</span><span class="s2">"object"</span><span class="p">,</span> <span class="s2">"cobject_id"</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">select</span><span class="p">(</span><span class="s2">"title"</span><span class="p">,</span> <span class="s2">"actions.ratings.total"</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">exec</span><span class="p">()</span>
    <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
      <span class="c1">// success</span>
    <span class="p">},</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// error</span>
    <span class="p">})</span>

</code></pre>

<div class="lang-content shell">
  <p>To select fields of return for query, add the <code>select</code> query parameter the request URI, and add the attributes to return as a comma delimited list assigned to <code>select</code>.</p>

  <p>To return only certain properties of a field, set them as a dot notated attribute in the comma delimited list. In the example <code>actions.ratings.total</code>, is set a return field.</p>

  <p>The object structure is maintained, however any other properties not specified will not be returned.</p>

</div>

<div class="lang-content javascript nodejs">
  <p>To select fields of return for query, use the <code>select</code> query method on the <code>Stamplay.Query</code>, and add the attributes to return as method arguments.</p>

  <p>To return only certain properties of a field, pass them in as a dot notated attribute as seen in the example with <code>actions.ratings.total</code>.</p>
</div>

<h4 id="sorting-query-results">Sorting Query Results</h4>

<pre class="highlight shell"><code>  // sort by title - ascending order
  curl -X <span class="s2">"GET"</span> <span class="s1">'https://APP-ID.stamplayapp.com/api/cobject/v1/movie?sort=title'</span>

  // sort by title by descending order <span class="o">(</span>note the hyphen preceding the sort param value<span class="o">)</span>
  curl -X <span class="s2">"GET"</span> <span class="s1">'https://APP-ID.stamplayapp.com/api/cobject/v1/movie?sort=-title'</span>
</code></pre>

<pre class="highlight javascript"><code>
  <span class="c1">// sort by title in ascending order</span>
  <span class="nx">Stamplay</span><span class="p">.</span><span class="nx">Query</span><span class="p">(</span><span class="s2">"object"</span><span class="p">,</span> <span class="s2">"cobject_id"</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">sortAscending</span><span class="p">(</span><span class="s2">"title"</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">exec</span><span class="p">()</span>
    <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
      <span class="c1">// success</span>
    <span class="p">},</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// error</span>
    <span class="p">})</span>

  <span class="c1">// sort by title in descending order</span>
  <span class="nx">Stamplay</span><span class="p">.</span><span class="nx">Query</span><span class="p">(</span><span class="s2">"object"</span><span class="p">,</span> <span class="s2">"cobject_id"</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">sortDescending</span><span class="p">(</span><span class="s2">"title"</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">exec</span><span class="p">()</span>
    <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
      <span class="c1">// success</span>
    <span class="p">},</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// error</span>
    <span class="p">})</span>

</code></pre>

<pre class="highlight nodejs"><code>
  <span class="c1">// sort by title in ascending order</span>
  <span class="nx">Stamplay</span><span class="p">.</span><span class="nx">Query</span><span class="p">(</span><span class="s2">"object"</span><span class="p">,</span> <span class="s2">"cobject_id"</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">sortAscending</span><span class="p">(</span><span class="s2">"title"</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">exec</span><span class="p">()</span>
    <span class="p">.</span><span class="nx">exec</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">res</span><span class="p">){</span>
      <span class="k">if</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="k">return</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">err</span><span class="p">);</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">res</span><span class="p">);</span>
    <span class="p">})</span>

  <span class="c1">// sort by title in descending order</span>
  <span class="nx">Stamplay</span><span class="p">.</span><span class="nx">Query</span><span class="p">(</span><span class="s2">"object"</span><span class="p">,</span> <span class="s2">"cobject_id"</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">sortDescending</span><span class="p">(</span><span class="s2">"title"</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">exec</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">res</span><span class="p">){</span>
      <span class="k">if</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="k">return</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">err</span><span class="p">);</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">res</span><span class="p">);</span>
    <span class="p">})</span>

</code></pre>

<p>By default, Stamplay returns results in ascending order of the <code>dt_create</code> property, or the date created.</p>

<div class="lang-content shell">
  <p>To change the order in which the records are sorted in the response, pass in a <code>sort</code> parameter and set the value as the attribute to sort by. An attribute preceded by an <code>-</code>(hyphen) is sorted in descending order.</p>
</div>

<div class="lang-content javascript nodejs">
  <p>To change the order in which the records are sorted in the response, call the <code>sortAscending</code> or <code>sortDescending</code> method on your query, and pass in the attribute to sort by.</p>
</div>

<h3 id="regular-expressions">Regular Expressions</h3>

<pre class="highlight shell"><code>  curl -X <span class="s2">"GET"</span> <span class="s1">'https://APP-ID.stamplayapp.com/api/cobject/v1/movie?where=\{"title":\{"$regex":"^Star","$options":"i"\}\}'</span>
</code></pre>

<pre class="highlight javascript"><code>  <span class="nx">Stamplay</span><span class="p">.</span><span class="nx">Query</span><span class="p">(</span><span class="s1">'object'</span><span class="p">,</span><span class="s1">'question'</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">regex</span><span class="p">(</span><span class="s1">'title'</span><span class="p">,</span><span class="s1">'^Star'</span><span class="p">,</span> <span class="s1">'i'</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">exec</span><span class="p">()</span>
    <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">res</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// success</span>
    <span class="p">},</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// error</span>
    <span class="p">})</span>
</code></pre>

<pre class="highlight nodejs"><code>  <span class="nx">Stamplay</span><span class="p">.</span><span class="nx">Query</span><span class="p">(</span><span class="s1">'object'</span><span class="p">,</span><span class="s1">'question'</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">regex</span><span class="p">(</span><span class="s1">'title'</span><span class="p">,</span><span class="s1">'^Star'</span><span class="p">,</span> <span class="s1">'i'</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">exec</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">res</span><span class="p">){</span>
      <span class="c1">// response</span>
    <span class="p">})</span>
</code></pre>

<p>Regular Expressions allow pattern matching for strings in queries. For a full list of options available, and more on pattern matching see the <a href="https://docs.mongodb.org/manual/reference/operator/query/regex/">MongoDB Documentation on $regex</a>.</p>

<p>The example returns records where the <code>title</code> starts with <code>Star</code>, with option <code>i</code> (disables case sensitivity).</p>

<h3 id="compound-queries">Compound Queries</h3>

<pre class="highlight shell"><code>  curl -X <span class="s2">"GET"</span> <span class="s1">'https://stamplaykb.stamplayapp.com/api/cobject/v1/question?where=\{"$or":\[\{"actions.rating.total":\{"$gt":4\}\},\{"title":"Star Wars"\}\]\}'</span>
</code></pre>

<pre class="highlight javascript"><code>  <span class="kd">var</span> <span class="nx">ratedFourOrMore</span> <span class="o">=</span> <span class="nx">Stamplay</span><span class="p">.</span><span class="nx">Query</span><span class="p">(</span><span class="s2">"object"</span><span class="p">,</span> <span class="s2">"movie"</span><span class="p">);</span>
  <span class="kd">var</span> <span class="nx">titleIsStarWars</span> <span class="o">=</span> <span class="nx">Stamplay</span><span class="p">.</span><span class="nx">Query</span><span class="p">(</span><span class="s2">"object"</span><span class="p">,</span> <span class="s2">"movie"</span><span class="p">);</span>

  <span class="nx">ratedFourOrMore</span><span class="p">.</span><span class="nx">greaterThanOrEqual</span><span class="p">(</span><span class="s2">"actions.ratings.total"</span><span class="p">,</span> <span class="mi">4</span><span class="p">);</span>
  <span class="nx">titleIsStarWars</span><span class="p">.</span><span class="nx">equalTo</span><span class="p">(</span><span class="s2">"title"</span><span class="p">,</span> <span class="s2">"Star Wars"</span><span class="p">);</span>

  <span class="kd">var</span> <span class="nx">combinedQuery</span> <span class="o">=</span> <span class="nx">Stamplay</span><span class="p">.</span><span class="nx">Query</span><span class="p">(</span><span class="s2">"object"</span><span class="p">,</span> <span class="s2">"movie"</span><span class="p">);</span>
  <span class="nx">combinedQuery</span><span class="p">.</span><span class="nx">or</span><span class="p">(</span><span class="nx">ratedFourOrMore</span><span class="p">,</span> <span class="nx">titleIsStarWars</span><span class="p">);</span>

  <span class="nx">combinedQuery</span><span class="p">.</span><span class="nx">exec</span><span class="p">()</span>
    <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">res</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// success</span>
    <span class="p">},</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// error</span>
    <span class="p">})</span>
</code></pre>

<pre class="highlight nodejs"><code>  <span class="kd">var</span> <span class="nx">ratedFourOrMore</span> <span class="o">=</span> <span class="nx">Stamplay</span><span class="p">.</span><span class="nx">Query</span><span class="p">(</span><span class="s2">"object"</span><span class="p">,</span> <span class="s2">"movie"</span><span class="p">);</span>
  <span class="kd">var</span> <span class="nx">titleIsStarWars</span> <span class="o">=</span> <span class="nx">Stamplay</span><span class="p">.</span><span class="nx">Query</span><span class="p">(</span><span class="s2">"object"</span><span class="p">,</span> <span class="s2">"movie"</span><span class="p">);</span>

  <span class="nx">ratedFourOrMore</span><span class="p">.</span><span class="nx">greaterThanOrEqual</span><span class="p">(</span><span class="s2">"actions.ratings.total"</span><span class="p">,</span> <span class="mi">4</span><span class="p">);</span>
  <span class="nx">titleIsStarWars</span><span class="p">.</span><span class="nx">equalTo</span><span class="p">(</span><span class="s2">"title"</span><span class="p">,</span> <span class="s2">"Star Wars"</span><span class="p">);</span>

  <span class="kd">var</span> <span class="nx">combinedQuery</span> <span class="o">=</span> <span class="nx">Stamplay</span><span class="p">.</span><span class="nx">Query</span><span class="p">(</span><span class="s2">"object"</span><span class="p">,</span> <span class="s2">"movie"</span><span class="p">);</span>
  <span class="nx">combinedQuery</span><span class="p">.</span><span class="nx">or</span><span class="p">(</span><span class="nx">ratedFourOrMore</span><span class="p">,</span> <span class="nx">titleIsStarWars</span><span class="p">);</span>

  <span class="nx">combinedQuery</span><span class="p">.</span><span class="nx">exec</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">res</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// response</span>
  <span class="p">})</span>
</code></pre>

<p>When performing a query, you might want to find records that match one of two or more sets of criteria, instead of a strict match for each attribute.</p>

<p>Being able to make compound queries eliminates making several requests, simplifying application development.</p>

<div class="lang-content shell">

  <p>To build a compound query, use the <code>$or</code> operator, and set an array of regular query objects. Any records matching at least one of the criteria objects will be returned.</p>

</div>

<div class="lang-content javascript nodejs">

  <p>To build a compound query, use the <code>or()</code> method, and pass in the query objects are arguments. Any records matching at least one of the criteria objects will be returned.</p>

</div>

<h3 id="geolocation-queries">Geolocation Queries</h3>

<p>Geolocation queries allow you to find records whose geo data match a set of geo parameters specified in the query.</p>

<div class="lang-content shell">

  <p>Stamplay supports the follow MongoDB operators for querying geolocation data:</p>

  <table>
    <thead>
      <tr>
        <th>Operator</th>
        <th> </th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><code>$geoWithin</code></td>
        <td>Returns records within the bounds GeoJSON geometry.</td>
      </tr>
      <tr>
        <td><code>$geoIntersects</code></td>
        <td>Returns records that intersect with a GeoJSON geometry</td>
      </tr>
      <tr>
        <td><code>$near</code></td>
        <td>Return records within a specified proximity to a point</td>
      </tr>
      <tr>
        <td><code>$nearSphere</code></td>
        <td>Return records within a specified proximity to a point on a sphere</td>
      </tr>
    </tbody>
  </table>

</div>

<div class="lang-content javascript nodejs">

  <p>The following SDK methods are available for querying geolocation data:</p>

  <table>
    <thead>
      <tr>
        <th>Method</th>
        <th> </th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><code>geoWithinGeometry</code></td>
        <td>Returns records within a geometric boundary.</td>
      </tr>
      <tr>
        <td><code>geoIntersects</code></td>
        <td>Returns records that intersect with a GeoJSON geometry</td>
      </tr>
      <tr>
        <td><code>near</code></td>
        <td>Return records within a specified proximity to a point</td>
      </tr>
      <tr>
        <td><code>nearSphere</code></td>
        <td>Return records within a specified proximity to a point on a sphere</td>
      </tr>
    </tbody>
  </table>

</div>

<h4 id="within-a-geometric-boundary">Within a Geometric Boundary</h4>

<pre class="highlight shell"><code>  curl -X <span class="s2">"GET"</span> <span class="s1">'https://APP-ID.stamplayapp.com/api/cobject/v1/movie?where=\{"_geolocation":\{"$geoWithin":\{"$geometry":\{"type":"Polygon","coordinates":\[\[\[-70,40\],\[-72,40\],\[-72,50\],\[-70,50\],\[-70,40\]\]\]\}\}\}\}'</span>
</code></pre>

<pre class="highlight javascript"><code> <span class="nx">Stamplay</span><span class="p">.</span><span class="nx">Query</span><span class="p">(</span><span class="s2">"object"</span><span class="p">,</span> <span class="s2">"movie"</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">geoWithinGeometry</span><span class="p">(</span><span class="s1">'Polygon'</span><span class="p">,</span>  
  <span class="p">[</span>
    <span class="p">[</span> <span class="p">[</span><span class="o">-</span><span class="mi">70</span><span class="p">,</span><span class="mi">40</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">72</span><span class="p">,</span><span class="mi">40</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">72</span><span class="p">,</span><span class="mi">50</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">70</span><span class="p">,</span> <span class="mi">50</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">70</span><span class="p">,</span> <span class="mi">40</span><span class="p">]</span> <span class="p">]</span>
  <span class="p">]).</span><span class="nx">exec</span><span class="p">()</span>
  <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">res</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// success</span>
  <span class="p">},</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// error</span>
  <span class="p">})</span>
</code></pre>

<pre class="highlight nodejs"><code>
 <span class="nx">Stamplay</span><span class="p">.</span><span class="nx">Query</span><span class="p">(</span><span class="s2">"object"</span><span class="p">,</span> <span class="s2">"movie"</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">geoWithinGeometry</span><span class="p">(</span><span class="s1">'Polygon'</span><span class="p">,</span>  
  <span class="p">[</span>
    <span class="p">[</span> <span class="p">[</span><span class="o">-</span><span class="mi">70</span><span class="p">,</span><span class="mi">40</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">72</span><span class="p">,</span><span class="mi">40</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">72</span><span class="p">,</span><span class="mi">50</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">70</span><span class="p">,</span> <span class="mi">50</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">70</span><span class="p">,</span> <span class="mi">40</span><span class="p">]</span> <span class="p">]</span>
  <span class="p">]).</span><span class="nx">exec</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span><span class="nx">res</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// response</span>
  <span class="p">})</span>
</code></pre>

<p>Find and return records that are within a specified polygon.</p>

<div class="lang-content shell">
  <p>The <code>$geoWithin</code> MongoDB operator accepts a GeoJSON <a href="https://docs.mongodb.org/manual/reference/geojson/#geojson-polygon">Polygon</a> or a <a href="https://docs.mongodb.org/manual/reference/geojson/#geojson-multipolygon">MultiPolygon</a>.</p>
</div>

<div class="lang-content javascript nodejs">
  <p>The <code>geoWithinGeometry</code> SDK method accepts a GeoJSON <a href="https://docs.mongodb.org/manual/reference/geojson/#geojson-polygon">Polygon</a> or a <a href="https://docs.mongodb.org/manual/reference/geojson/#geojson-multipolygon">MultiPolygon</a>.</p>
</div>

<p>For more information about finding records within a geometric boundray, see the MongoDB documention for <a href="https://docs.mongodb.org/manual/reference/operator/query/geoWithin/#op._S_geoWithin">$geoWithin</a>.</p>

<h4 id="intersects-a-geometric-boundary">Intersects a Geometric Boundary</h4>

<pre class="highlight shell"><code>  curl -X <span class="s2">"GET"</span> <span class="s1">'https://stamplaykb.stamplayapp.com/api/cobject/v1/question?where=\{"_geolocation":\{"$geoIntersects":\{"$geometry":\{"type":"Point","coordinates":\[74.0059,40.7127\]\}\}\}\}'</span>
</code></pre>

<pre class="highlight javascript"><code>  <span class="nx">Stamplay</span><span class="p">.</span><span class="nx">Query</span><span class="p">(</span><span class="s2">"object"</span><span class="p">,</span> <span class="s2">"movie"</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">geoIntersects</span><span class="p">(</span><span class="s1">'Point'</span><span class="p">,</span>  <span class="p">[</span> <span class="mf">74.0059</span><span class="p">,</span> <span class="mf">40.7127</span> <span class="p">])</span>
    <span class="p">.</span><span class="nx">exec</span><span class="p">()</span>
    <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">res</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// success</span>
    <span class="p">},</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// error</span>
    <span class="p">})</span>
</code></pre>

<pre class="highlight nodejs"><code>  <span class="nx">Stamplay</span><span class="p">.</span><span class="nx">Query</span><span class="p">(</span><span class="s2">"object"</span><span class="p">,</span> <span class="s2">"movie"</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">geoIntersects</span><span class="p">(</span><span class="s1">'Point'</span><span class="p">,</span>  <span class="p">[</span> <span class="mf">74.0059</span><span class="p">,</span> <span class="mf">40.7127</span> <span class="p">])</span>
    <span class="p">.</span><span class="nx">exec</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span><span class="nx">res</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// response</span>
    <span class="p">})</span>
</code></pre>

<p>Find and return records that intersect on the specified coordinates.</p>

<div class="lang-content shell">
  <p>The <code>$geoIntersects</code> MongoDB operator accepts a <a href="https://docs.mongodb.org/manual/reference/geojson/#geospatial-indexes-store-geojson">GeoJSON object</a>.</p>
</div>

<div class="lang-content javascript nodejs">
  <p>The <code>geoIntersects</code> SDK method accepts a <a href="https://docs.mongodb.org/manual/reference/geojson/#geospatial-indexes-store-geojson">GeoJSON object</a>.</p>
</div>

<p>For more information about finding records within a geometric boundray, see the MongoDB documention for <a href="https://docs.mongodb.org/manual/reference/operator/query/geoIntersects/#op._S_geoIntersects">$geoIntersects</a>.</p>

<h4 id="within-proximity-to-a-point">Within Proximity To A Point</h4>

<pre class="highlight shell"><code> curl -X <span class="s2">"GET"</span> <span class="s1">'https://stamplaykb.stamplayapp.com/api/cobject/v1/question?where=\{"_geolocation":\{"$near":\{"$geometry":\{"type":"Point","coordinates":\[74.0059,40.7127\]\}\}\}\}'</span>
</code></pre>

<pre class="highlight javascript"><code>  <span class="nx">Stamplay</span><span class="p">.</span><span class="nx">Query</span><span class="p">(</span><span class="s2">"object"</span><span class="p">,</span> <span class="s2">"dinners"</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">near</span><span class="p">(</span><span class="s1">'Point'</span><span class="p">,</span>  <span class="p">[</span> <span class="mf">74.0059</span><span class="p">,</span> <span class="mf">40.7127</span> <span class="p">],</span> <span class="mi">500</span> <span class="p">)</span>
  <span class="p">.</span><span class="nx">exec</span><span class="p">()</span>
  <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">res</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// success</span>
  <span class="p">},</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// error</span>
  <span class="p">})</span>
</code></pre>

<pre class="highlight nodejs"><code>  <span class="nx">Stamplay</span><span class="p">.</span><span class="nx">Query</span><span class="p">(</span><span class="s2">"object"</span><span class="p">,</span> <span class="s2">"dinners"</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">near</span><span class="p">(</span><span class="s1">'Point'</span><span class="p">,</span>  <span class="p">[</span> <span class="mf">81.0039</span><span class="p">,</span> <span class="mf">70.4127</span> <span class="p">],</span> <span class="mi">500</span><span class="p">,</span> <span class="mi">100</span> <span class="p">)</span>
  <span class="p">.</span><span class="nx">exec</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span><span class="nx">res</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// response</span>
  <span class="p">})</span>
</code></pre>

<p>Find records within proximity to a geographic point.</p>

<div class="lang-content shell">
  <p>The <code>$near</code> MongoDB operator accepts a <a href="https://docs.mongodb.org/manual/reference/geojson/#point">GeoJSON Point</a>.</p>
</div>

<div class="lang-content javascript nodejs">
  <p>The <code>near</code> SDK method accepts a <a href="https://docs.mongodb.org/manual/reference/geojson/#point">GeoJSON Point</a>.</p>
</div>

<p>More details about <a href="https://docs.mongodb.org/manual/reference/operator/query/near/">$near on MongoDB docs</a>.</p>

<h4 id="within-proximity-to-a-point-near-sphere">Within Proximity To A Point (Near Sphere)</h4>

<pre class="highlight shell"><code> curl -X <span class="s2">"GET"</span> <span class="s1">'https://stamplaykb.stamplayapp.com/api/cobject/v1/question?where=\{"_geolocation":\{"$near":\{"$geometry":\{"type":"Point","coordinates":\[74.0059,40.7127\]\}\}\}\}'</span>
</code></pre>

<pre class="highlight javascript"><code>  <span class="nx">Stamplay</span><span class="p">.</span><span class="nx">Query</span><span class="p">(</span><span class="s2">"object"</span><span class="p">,</span> <span class="s2">"dinners"</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">nearSphere</span><span class="p">(</span><span class="s1">'Point'</span><span class="p">,</span>  <span class="p">[</span> <span class="mf">74.0059</span><span class="p">,</span> <span class="mf">40.7127</span> <span class="p">],</span> <span class="mi">1000</span> <span class="p">)</span>
  <span class="p">.</span><span class="nx">exec</span><span class="p">()</span>
  <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">res</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// success</span>
  <span class="p">},</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// error</span>
  <span class="p">})</span>
</code></pre>

<pre class="highlight nodejs"><code>  <span class="nx">Stamplay</span><span class="p">.</span><span class="nx">Query</span><span class="p">(</span><span class="s2">"object"</span><span class="p">,</span> <span class="s2">"dinners"</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">nearSphere</span><span class="p">(</span><span class="s1">'Point'</span><span class="p">,</span>  <span class="p">[</span> <span class="mf">74.0059</span><span class="p">,</span> <span class="mf">40.7127</span> <span class="p">],</span> <span class="mi">500</span> <span class="p">)</span>
  <span class="p">.</span><span class="nx">exec</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span><span class="nx">res</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// response</span>
  <span class="p">})</span>
</code></pre>

<p>Find records within proximity to a geographic point, calculating distances using spherical geometry.</p>

<div class="lang-content shell">
  <p>The <code>$nearSphere</code> MongoDB operator accepts a <a href="https://docs.mongodb.org/manual/reference/geojson/#point">GeoJSON Point</a>.</p>
</div>

<div class="lang-content javascript nodejs">
  <p>The <code>nearSphere</code> SDK method accepts a <a href="https://docs.mongodb.org/manual/reference/geojson/#point">GeoJSON Point</a>.</p>
</div>

<p>More details about <a href="https://docs.mongodb.org/manual/reference/operator/query/nearSphere/">$nearSphere on MongoDB docs</a>.</p>

<h2 id="voting">Voting</h2>

<p>The Stamplay API provides a voting mechansim for managing a vote system, tracking users who have voted, how they have voted, and the total vote count.</p>

<p>Each Stamplay Object is able to be voted upon, out of the box without any additional setup.</p>

<p>The data for voting is stored on a <code>actions</code> object on each Object.</p>

<blockquote>
  <p>The following data is stored for votes.</p>
</blockquote>

<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"actions"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"votes"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nt">"users_downvote"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"user_id"</span><span class="p">],</span><span class="w">
      </span><span class="nt">"users_upvote"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"another_user_id"</span><span class="p">],</span><span class="w">
      </span><span class="nt">"users"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"user_id"</span><span class="p">,</span><span class="w"> </span><span class="s2">"another_user_id"</span><span class="p">],</span><span class="w">
      </span><span class="nt">"total"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<h3 id="downvoting">Downvoting</h3>

<pre class="highlight shell"><code>  curl -X <span class="s2">"PUT"</span> <span class="s2">"https://APP-ID.stamplayapp.com/api/cobject/v1/movie/:object_id/vote"</span> <span class="se">\</span>
    -H <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
    -d <span class="s2">"{</span><span class="se">\"</span><span class="s2">type</span><span class="se">\"</span><span class="s2">:</span><span class="se">\"</span><span class="s2">downvote</span><span class="se">\"</span><span class="s2">}"</span>
</code></pre>

<pre class="highlight javascript"><code>  <span class="nx">Stamplay</span><span class="p">.</span><span class="nb">Object</span><span class="p">(</span><span class="s2">"movie"</span><span class="p">).</span><span class="nx">downVote</span><span class="p">(</span><span class="s2">"object_id"</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">res</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// success</span>
    <span class="p">},</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// error</span>
    <span class="p">})</span>
</code></pre>

<pre class="highlight nodejs"><code>  <span class="c1">// no method</span>
</code></pre>

<p>To downvote an object send a <code>PUT</code> request to the Object resource with the object <code>_id</code> in the URI, and a <code>type</code> property in the body specifying <code>downvote</code>.</p>

<table>
  <thead>
    <tr>
      <th>Attribute</th>
      <th> </th>
      <th style="text-align: center">Optional</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>object_id</code></td>
      <td>the Stamplay <code>_id</code> of the object to downvote</td>
      <td style="text-align: center"><i class="unchecked"></i></td>
    </tr>
    <tr>
      <td><code>type</code></td>
      <td><code>"upvote"</code> or <code>"downvote"</code></td>
      <td style="text-align: center"><i class="unchecked"></i></td>
    </tr>
  </tbody>
</table>

<h3 id="upvoting">Upvoting</h3>

<pre class="highlight shell"><code>  curl -X <span class="s2">"PUT"</span> <span class="s2">"https://APP-ID.stamplayapp.com/api/cobject/v1/movie/:object_id/vote"</span> <span class="se">\</span>
    -H <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
    -d <span class="s2">"{</span><span class="se">\"</span><span class="s2">type</span><span class="se">\"</span><span class="s2">:</span><span class="se">\"</span><span class="s2">upvote</span><span class="se">\"</span><span class="s2">}"</span>
</code></pre>

<pre class="highlight javascript"><code>  <span class="nx">Stamplay</span><span class="p">.</span><span class="nb">Object</span><span class="p">(</span><span class="s2">"movie"</span><span class="p">).</span><span class="nx">upVote</span><span class="p">(</span><span class="s2">"object_id"</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">res</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// success</span>
    <span class="p">},</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// error</span>
    <span class="p">})</span>
</code></pre>

<pre class="highlight nodejs"><code>  <span class="c1">// no method</span>
</code></pre>

<p>To upvote an object send a <code>PUT</code> request to the Object resource with the object <code>_id</code> in the URI, and a <code>type</code> property in the body specifying <code>upvote</code>.</p>

<table>
  <thead>
    <tr>
      <th>Attribute</th>
      <th> </th>
      <th style="text-align: center">Optional</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>object_id</code></td>
      <td>the Stamplay <code>_id</code> of the object to downvote</td>
      <td style="text-align: center"><i class="unchecked"></i></td>
    </tr>
    <tr>
      <td><code>type</code></td>
      <td><code>"upvote"</code> or <code>"downvote"</code></td>
      <td style="text-align: center"><i class="unchecked"></i></td>
    </tr>
  </tbody>
</table>

<h2 id="commenting">Commenting</h2>

<pre class="highlight shell"><code>  curl -X <span class="s2">"PUT"</span> <span class="s2">"https://APP-ID.stamplayapp.com/api/cobject/v1/movie/:object_id/comment"</span> <span class="se">\</span>
    -H <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
    -d <span class="s2">"{</span><span class="se">\"</span><span class="s2">text</span><span class="se">\"</span><span class="s2">:</span><span class="se">\"</span><span class="s2">comment text goes here</span><span class="se">\"</span><span class="s2">}"</span>
</code></pre>

<pre class="highlight javascript"><code>  <span class="kd">var</span> <span class="nx">txt</span> <span class="o">=</span> <span class="s2">"comment text goes here"</span><span class="p">;</span>

  <span class="nx">Stamplay</span><span class="p">.</span><span class="nb">Object</span><span class="p">(</span><span class="s2">"movie"</span><span class="p">).</span><span class="nx">comment</span><span class="p">(</span><span class="s2">"object_id"</span><span class="p">,</span> <span class="nx">txt</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">res</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// success</span>
    <span class="p">},</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// error</span>
    <span class="p">})</span>
</code></pre>

<pre class="highlight nodejs"><code>  <span class="c1">// no method</span>
</code></pre>

<p>The Stamplay API provides a comment mechansim for managing a comment system.</p>

<p>Each Stamplay Object is able to be commented upon, out of the box without any additional setup.</p>

<p>To comment on an object send a <code>PUT</code> request to the Object resource with the object <code>_id</code> in the URI, and a <code>text</code> property in the body specifying the comment text.</p>

<table>
  <thead>
    <tr>
      <th>Attribute</th>
      <th> </th>
      <th style="text-align: center">Optional</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>object_id</code></td>
      <td>the Stamplay <code>_id</code> of the object to add a comment to</td>
      <td style="text-align: center"><i class="unchecked"></i></td>
    </tr>
    <tr>
      <td><code>texd</code></td>
      <td>the content of the comment</td>
      <td style="text-align: center"><i class="unchecked"></i></td>
    </tr>
  </tbody>
</table>

<p>The data for comments is stored on a <code>actions</code> object on each Object.</p>

<p>For each comment, a comment object is stored in the <code>comments</code> array.</p>

<blockquote>
  <p>The following data is stored for comments.</p>
</blockquote>

<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"actions"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"comments"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
      </span><span class="p">{</span><span class="w">
        </span><span class="nt">"picture"</span><span class="p">:</span><span class="w"> </span><span class="s2">"user_image_url"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"displayName"</span><span class="p">:</span><span class="w"> </span><span class="s2">"user_displayName"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"userId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"user_id"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"text"</span><span class="p">:</span><span class="w"> </span><span class="s2">"comment text"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"comment_id"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"dt_create"</span><span class="p">:</span><span class="w"> </span><span class="s2">"date commented"</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">]</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<h2 id="rating">Rating</h2>

<pre class="highlight shell"><code>  curl -X <span class="s2">"PUT"</span> <span class="s2">"https://APP-ID.stamplayapp.com/api/cobject/v1/movie/:object_id/rate"</span> <span class="se">\</span>
    -H <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
    -d <span class="s2">"{</span><span class="se">\"</span><span class="s2">rate</span><span class="se">\"</span><span class="s2">: 5}"</span>
</code></pre>

<pre class="highlight javascript"><code>
  <span class="nx">Stamplay</span><span class="p">.</span><span class="nb">Object</span><span class="p">(</span><span class="s2">"movie"</span><span class="p">).</span><span class="nx">rate</span><span class="p">(</span><span class="s2">"object_id"</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">res</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// success</span>
    <span class="p">},</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// error</span>
    <span class="p">})</span>
</code></pre>

<pre class="highlight nodejs"><code>  <span class="c1">// no method</span>
</code></pre>

<p>The Stamplay API provides a rate mechansim for managing a rating system.</p>

<p>Each Stamplay Object is able to be be rated, out of the box without any additional setup.</p>

<p>To rate an object send a <code>PUT</code> request to the Object resource with the object <code>_id</code> in the URI, and a <code>rate</code> property in the body specifying the rating as an integer.</p>

<table>
  <thead>
    <tr>
      <th>Attribute</th>
      <th> </th>
      <th style="text-align: center">Optional</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>object_id</code></td>
      <td>the Stamplay <code>_id</code> of the object to rate</td>
      <td style="text-align: center"><i class="unchecked"></i></td>
    </tr>
    <tr>
      <td><code>rate</code></td>
      <td>an integer rating</td>
      <td style="text-align: center"><i class="unchecked"></i></td>
    </tr>
  </tbody>
</table>

<p>The data for <code>ratings</code> is stored on a <code>actions</code> object on each Object.</p>

<blockquote>
  <p>The following data is stored for ratings.</p>
</blockquote>

<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"actions"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"ratings"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nt">"users"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"user_id"</span><span class="p">,</span><span class="w"> </span><span class="s2">"another_user_id"</span><span class="p">,</span><span class="w"> </span><span class="s2">"third_user"</span><span class="p">],</span><span class="w">
      </span><span class="nt">"avg"</span><span class="p">:</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w">
      </span><span class="nt">"total"</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
