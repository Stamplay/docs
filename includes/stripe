<h1 id="stripe">Stripe</h1>

<p>A first class API layer for integrating Stripe into a Stamplay application.</p>

<h2 id="customers">Customers</h2>

<p>Stripe customers allow you to perform recurring charges and track multiple charges that are associated with the same customer.</p>

<h3 id="add-customer">Add Customer</h3>

<pre class="highlight shell"><code>  curl -X <span class="s2">"POST"</span> <span class="s2">"https://APP-ID.stamplayapp.com/api/stripe/v1/customers"</span> <span class="se">\</span>
    -H <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
    -d <span class="s2">"{</span><span class="se">\"</span><span class="s2">userId</span><span class="se">\"</span><span class="s2">:</span><span class="se">\"</span><span class="s2">546dc9f188104fee05000006</span><span class="se">\"</span><span class="s2">}"</span>
</code></pre>

<pre class="highlight javascript"><code>  <span class="nx">Stamplay</span><span class="p">.</span><span class="nx">Stripe</span><span class="p">.</span><span class="nx">createCustomer</span><span class="p">(</span><span class="s2">"userId"</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">res</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// success</span>
    <span class="p">},</span>
       <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// error</span>
    <span class="p">})</span>
</code></pre>

<pre class="highlight nodejs"><code>  <span class="c1">// no method</span>
</code></pre>

<blockquote>
  <p>The JSON response looks like this.</p>
</blockquote>

<pre class="highlight json"><code><span class="w">
</span><span class="p">{</span><span class="w">
  </span><span class="nt">"__v"</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="w">
  </span><span class="nt">"livemode"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
  </span><span class="nt">"customer_id"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"cus_8GrAxVnGSGHKxv"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"userId"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"571021095743954537b8c0cd"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"appId"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"APP-ID"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"_id"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"57102131da5d4db251c71c76"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"dt_create"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"2016-04-14T23:01:05.995Z"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"subscriptions"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w">
  </span><span class="nt">"billingHistory"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w">
  </span><span class="nt">"id"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"57102131da5d4db251c71c76"</span><span class="w">
</span><span class="p">}</span><span class="w">

</span></code></pre>

<p>Add a new customer on Stripe.</p>

<table>
  <thead>
    <tr>
      <th>Attribute</th>
      <th> </th>
      <th style="text-align: center">Optional</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>userId</code></td>
      <td>the Stamplay <code>_id</code> of the  user to add as a Stripe Customer</td>
      <td style="text-align: center"><i class="unchecked"></i></td>
    </tr>
  </tbody>
</table>

<h3 id="delete-customer">Delete Customer</h3>

<pre class="highlight shell"><code>  curl -X <span class="s2">"DELETE"</span> <span class="s2">"https://APP-ID.stamplayapp.com/api/stripe/v1/customers/546dc9f188104fee05000006"</span>
</code></pre>

<pre class="highlight javascript"><code>  <span class="c1">// no method</span>
</code></pre>

<pre class="highlight nodejs"><code>  <span class="kd">var</span> <span class="nx">userId</span> <span class="o">=</span> <span class="s1">'546dc9f188104fee05000006'</span><span class="p">;</span>
  <span class="nx">Stamplay</span><span class="p">.</span><span class="nx">Stripe</span><span class="p">.</span><span class="nx">deleteCustomer</span><span class="p">(</span><span class="nx">userId</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">res</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// response</span>
  <span class="p">})</span>
</code></pre>

<blockquote>
  <p>The JSON response looks like this.</p>
</blockquote>

<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"deleted"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
  </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"cus_9HuvMRmZlnuYg9"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>Deletes a customer from Stripe.</p>

<table>
  <thead>
    <tr>
      <th>Attribute</th>
      <th> </th>
      <th style="text-align: center">Optional</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>userId</code></td>
      <td>the Stamplay <code>_id</code> of the user to delete from Stripe</td>
      <td style="text-align: center"><i class="unchecked"></i></td>
    </tr>
  </tbody>
</table>

<h2 id="subscriptions">Subscriptions</h2>

<p>Subscriptions allow you to charge a customer's card on a recurring basis. A subscription ties a customer to a particular plan you've created.</p>

<h3 id="fetch-user-subscription">Fetch User Subscription</h3>

<pre class="highlight shell"><code>  curl -X <span class="s2">"GET"</span> <span class="s2">"https://stripe-docs.stamplayapp.com/api/stripe/v1/customers/:userId/subscriptions/:subscriptionId"</span>
</code></pre>

<pre class="highlight javascript"><code>  <span class="nx">Stamplay</span><span class="p">.</span><span class="nx">Stripe</span><span class="p">.</span><span class="nx">getSubscription</span><span class="p">(</span><span class="s2">"userId"</span><span class="p">,</span>
     <span class="s2">"subscriptionId"</span><span class="p">)</span>
      <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">res</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// success</span>
      <span class="p">},</span>
         <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">){</span>
        <span class="c1">// error</span>
      <span class="p">})</span>
</code></pre>

<pre class="highlight nodejs"><code>  <span class="c1">// no method</span>
</code></pre>

<blockquote>
  <p>The JSON response looks like this.</p>
</blockquote>

<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"id"</span><span class="p">:</span><span class="s2">"sub_8GrYtVQuzArBMy"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"object"</span><span class="p">:</span><span class="s2">"subscription"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"application_fee_percent"</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"cancel_at_period_end"</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="w">
  </span><span class="nt">"canceled_at"</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"current_period_end"</span><span class="p">:</span><span class="mi">1463268296</span><span class="p">,</span><span class="w">
  </span><span class="nt">"current_period_start"</span><span class="p">:</span><span class="mi">1460676296</span><span class="p">,</span><span class="w">
  </span><span class="nt">"customer"</span><span class="p">:</span><span class="s2">"cus_8GrAxVnGSGHKxv"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"discount"</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"ended_at"</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"metadata"</span><span class="p">:{},</span><span class="w">
  </span><span class="nt">"plan"</span><span class="p">:{</span><span class="w">
    </span><span class="nt">"id"</span><span class="p">:</span><span class="s2">"subscription_one"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"object"</span><span class="p">:</span><span class="s2">"plan"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"amount"</span><span class="p">:</span><span class="mi">999</span><span class="p">,</span><span class="w">
    </span><span class="nt">"created"</span><span class="p">:</span><span class="mi">1460675091</span><span class="p">,</span><span class="w">
    </span><span class="nt">"currency"</span><span class="p">:</span><span class="s2">"usd"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"interval"</span><span class="p">:</span><span class="s2">"month"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"interval_count"</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="w">
    </span><span class="nt">"livemode"</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="w">
    </span><span class="nt">"metadata"</span><span class="p">:{},</span><span class="w">
    </span><span class="nt">"name"</span><span class="p">:</span><span class="s2">"Subscription One"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"statement_descriptor"</span><span class="p">:</span><span class="s2">"Sub One"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"trial_period_days"</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"statement_description"</span><span class="p">:</span><span class="s2">"Sub One"</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="nt">"quantity"</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="w">
  </span><span class="nt">"start"</span><span class="p">:</span><span class="mi">1460676296</span><span class="p">,</span><span class="w">
  </span><span class="nt">"status"</span><span class="p">:</span><span class="s2">"active"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"tax_percent"</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"trial_end"</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"trial_start"</span><span class="p">:</span><span class="kc">null</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p>Retrieve a user subscription by a subscription ID.</p>

<table>
  <thead>
    <tr>
      <th>Attribute</th>
      <th> </th>
      <th style="text-align: center">Optional</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>userId</code></td>
      <td>the Stamplay <code>_id</code> of a user with a subscription</td>
      <td style="text-align: center"><i class="unchecked"></i></td>
    </tr>
    <tr>
      <td><code>subscriptionId</code></td>
      <td>the Stripe identifier of the subscription to fetch</td>
      <td style="text-align: center"><i class="unchecked"></i></td>
    </tr>
  </tbody>
</table>

<h3 id="fetch-users-subscriptions">Fetch User's Subscriptions</h3>

<pre class="highlight shell"><code>  curl -X <span class="s2">"GET"</span> <span class="s2">"https://APP-ID.stamplayapp.com/api/stripe/v1/customers/:userId/subscriptions"</span>
</code></pre>

<pre class="highlight javascript"><code>  <span class="nx">Stamplay</span><span class="p">.</span><span class="nx">Stripe</span><span class="p">.</span><span class="nx">getSubscriptions</span><span class="p">(</span><span class="s2">"userId"</span><span class="p">,</span>
     <span class="nx">options</span><span class="p">)</span>
      <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">res</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// success</span>
      <span class="p">},</span>
         <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">){</span>
        <span class="c1">// error</span>
      <span class="p">})</span>
</code></pre>

<pre class="highlight nodejs"><code>  <span class="c1">// no method</span>
</code></pre>

<blockquote>
  <p>The JSON response looks like this.</p>
</blockquote>

<pre class="highlight json"><code><span class="w">
</span><span class="p">{</span><span class="w">
  </span><span class="nt">"object"</span><span class="p">:</span><span class="s2">"list"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"data"</span><span class="p">:[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nt">"id"</span><span class="p">:</span><span class="s2">"sub_8GrYtVQuzArBMy"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"object"</span><span class="p">:</span><span class="s2">"subscription"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"application_fee_percent"</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="w">
      </span><span class="nt">"cancel_at_period_end"</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="w">
      </span><span class="nt">"canceled_at"</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="w">
      </span><span class="nt">"current_period_end"</span><span class="p">:</span><span class="mi">1463268296</span><span class="p">,</span><span class="w">
      </span><span class="nt">"current_period_start"</span><span class="p">:</span><span class="mi">1460676296</span><span class="p">,</span><span class="w">
      </span><span class="nt">"customer"</span><span class="p">:</span><span class="s2">"cus_8GrAxVnGSGHKxv"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"discount"</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="w">
      </span><span class="nt">"ended_at"</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="w">
      </span><span class="nt">"metadata"</span><span class="p">:{},</span><span class="w">
      </span><span class="nt">"plan"</span><span class="p">:{</span><span class="w">
        </span><span class="nt">"id"</span><span class="p">:</span><span class="s2">"subscription_one"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"object"</span><span class="p">:</span><span class="s2">"plan"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"amount"</span><span class="p">:</span><span class="mi">999</span><span class="p">,</span><span class="w">
        </span><span class="nt">"created"</span><span class="p">:</span><span class="mi">1460675091</span><span class="p">,</span><span class="w">
        </span><span class="nt">"currency"</span><span class="p">:</span><span class="s2">"usd"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"interval"</span><span class="p">:</span><span class="s2">"month"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"interval_count"</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="w">
        </span><span class="nt">"livemode"</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="w">
        </span><span class="nt">"metadata"</span><span class="p">:{},</span><span class="w">
        </span><span class="nt">"name"</span><span class="p">:</span><span class="s2">"Subscription One"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"statement_descriptor"</span><span class="p">:</span><span class="s2">"Sub One"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"trial_period_days"</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="w">
        </span><span class="nt">"statement_description"</span><span class="p">:</span><span class="s2">"Sub One"</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="nt">"quantity"</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="w">
      </span><span class="nt">"start"</span><span class="p">:</span><span class="mi">1460676296</span><span class="p">,</span><span class="w">
      </span><span class="nt">"status"</span><span class="p">:</span><span class="s2">"active"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"tax_percent"</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="w">
      </span><span class="nt">"trial_end"</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="w">
      </span><span class="nt">"trial_start"</span><span class="p">:</span><span class="kc">null</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">],</span><span class="w">
  </span><span class="nt">"has_more"</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="w">
  </span><span class="nt">"url"</span><span class="p">:</span><span class="s2">"/v1/customers/cus_8GrAxVnGSGHKxv/subscriptions"</span><span class="w">
</span><span class="p">}</span><span class="w">

</span></code></pre>

<p>Retrieve a user's subscriptions.</p>

<table>
  <thead>
    <tr>
      <th>Attribute</th>
      <th> </th>
      <th style="text-align: center">Optional</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>userId</code></td>
      <td>the Stamplay <code>_id</code> of the user to fetch subscriptions for</td>
      <td style="text-align: center"><i class="unchecked"></i></td>
    </tr>
  </tbody>
</table>

<h3 id="add-a-subscription">Add A Subscription</h3>

<p>Add a new subscription to a Stripe customer.</p>

<pre class="highlight shell"><code>  curl -X <span class="s2">"POST"</span> <span class="s2">"https://APP-ID.stamplayapp.com/api/stripe/v1/customers/:userId/subscriptions"</span> <span class="se">\</span>
    -H <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
    -d <span class="s2">"{</span><span class="se">\"</span><span class="s2">planId</span><span class="se">\"</span><span class="s2">:</span><span class="se">\"</span><span class="s2">stripePlanId</span><span class="se">\"</span><span class="s2">}"</span>
</code></pre>

<pre class="highlight javascript"><code>  <span class="nx">Stamplay</span><span class="p">.</span><span class="nx">Stripe</span><span class="p">.</span><span class="nx">createSubscription</span><span class="p">(</span><span class="s2">"userId"</span><span class="p">,</span>
     <span class="s2">"planId"</span><span class="p">)</span>
      <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">res</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// success</span>
      <span class="p">},</span>
         <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">){</span>
        <span class="c1">// error</span>
      <span class="p">})</span>
</code></pre>

<pre class="highlight nodejs"><code>  <span class="c1">// no method</span>
</code></pre>

<blockquote>
  <p>The JSON response looks like this.</p>
</blockquote>

<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"id"</span><span class="p">:</span><span class="s2">"sub_8GrYtVQuzArBMy"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"object"</span><span class="p">:</span><span class="s2">"subscription"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"application_fee_percent"</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"cancel_at_period_end"</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="w">
  </span><span class="nt">"canceled_at"</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"current_period_end"</span><span class="p">:</span><span class="mi">1463268296</span><span class="p">,</span><span class="w">
  </span><span class="nt">"current_period_start"</span><span class="p">:</span><span class="mi">1460676296</span><span class="p">,</span><span class="w">
  </span><span class="nt">"customer"</span><span class="p">:</span><span class="s2">"cus_8GrAxVnGSGHKxv"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"discount"</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"ended_at"</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"metadata"</span><span class="p">:{},</span><span class="w">
  </span><span class="nt">"plan"</span><span class="p">:{</span><span class="w">
    </span><span class="nt">"id"</span><span class="p">:</span><span class="s2">"subscription_one"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"object"</span><span class="p">:</span><span class="s2">"plan"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"amount"</span><span class="p">:</span><span class="mi">999</span><span class="p">,</span><span class="w">
    </span><span class="nt">"created"</span><span class="p">:</span><span class="mi">1460675091</span><span class="p">,</span><span class="w">
    </span><span class="nt">"currency"</span><span class="p">:</span><span class="s2">"usd"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"interval"</span><span class="p">:</span><span class="s2">"month"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"interval_count"</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="w">
    </span><span class="nt">"livemode"</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="w">
    </span><span class="nt">"metadata"</span><span class="p">:{},</span><span class="w">
    </span><span class="nt">"name"</span><span class="p">:</span><span class="s2">"Subscription One"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"statement_descriptor"</span><span class="p">:</span><span class="s2">"Sub One"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"trial_period_days"</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"statement_description"</span><span class="p">:</span><span class="s2">"Sub One"</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="nt">"quantity"</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="w">
  </span><span class="nt">"start"</span><span class="p">:</span><span class="mi">1460676296</span><span class="p">,</span><span class="w">
  </span><span class="nt">"status"</span><span class="p">:</span><span class="s2">"active"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"tax_percent"</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"trial_end"</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"trial_start"</span><span class="p">:</span><span class="kc">null</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<table>
  <thead>
    <tr>
      <th>Attribute</th>
      <th> </th>
      <th style="text-align: center">Optional</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>userId</code></td>
      <td>the Stamplay <code>_id</code> of the user to add a subscriptions for</td>
      <td style="text-align: center"><i class="unchecked"></i></td>
    </tr>
    <tr>
      <td><code>planId</code></td>
      <td>the Stripe identifier of the subscription to add</td>
      <td style="text-align: center"><i class="unchecked"></i></td>
    </tr>
  </tbody>
</table>

<h3 id="update-subscription">Update Subscription</h3>

<p>Update a subscription for a Stripe customer.</p>

<pre class="highlight shell"><code>  curl -X <span class="s2">"PUT"</span> <span class="s2">"https://APP-ID.stamplayapp.com/api/stripe/v1/customers/:userId/subscriptions/:subscriptionId"</span> <span class="se">\</span>
    -H <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
    -d <span class="s2">"{</span><span class="se">\"</span><span class="s2">options</span><span class="se">\"</span><span class="s2">:</span><span class="se">\"</span><span class="s2">{ </span><span class="se">\"</span><span class="s2">plan</span><span class="se">\"</span><span class="s2"> : </span><span class="se">\"</span><span class="s2">subscription_one</span><span class="se">\"</span><span class="s2">}</span><span class="se">\"</span><span class="s2">}"</span>
</code></pre>

<pre class="highlight javascript"><code>  <span class="nx">Stamplay</span><span class="p">.</span><span class="nx">Stripe</span><span class="p">.</span><span class="nx">updateSubscription</span><span class="p">(</span><span class="s2">"userId"</span><span class="p">,</span> <span class="s2">"planId"</span><span class="p">,</span>
     <span class="p">{</span> <span class="s2">"plan : subscription_one"</span> <span class="p">})</span>
      <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">res</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// success</span>
      <span class="p">},</span>
         <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">){</span>
        <span class="c1">// error</span>
      <span class="p">})</span>
</code></pre>

<pre class="highlight nodejs"><code>  <span class="c1">// no method</span>
</code></pre>

<blockquote>
  <p>The JSON response looks like this.</p>
</blockquote>

<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"id"</span><span class="p">:</span><span class="s2">"sub_8GrYtVQuzArBMy"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"object"</span><span class="p">:</span><span class="s2">"subscription"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"application_fee_percent"</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"cancel_at_period_end"</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="w">
  </span><span class="nt">"canceled_at"</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"current_period_end"</span><span class="p">:</span><span class="mi">1463268296</span><span class="p">,</span><span class="w">
  </span><span class="nt">"current_period_start"</span><span class="p">:</span><span class="mi">1460676296</span><span class="p">,</span><span class="w">
  </span><span class="nt">"customer"</span><span class="p">:</span><span class="s2">"cus_8GrAxVnGSGHKxv"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"discount"</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"ended_at"</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"metadata"</span><span class="p">:{},</span><span class="w">
  </span><span class="nt">"plan"</span><span class="p">:{</span><span class="w">
    </span><span class="nt">"id"</span><span class="p">:</span><span class="s2">"subscription_two"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"object"</span><span class="p">:</span><span class="s2">"plan"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"amount"</span><span class="p">:</span><span class="mi">1999</span><span class="p">,</span><span class="w">
    </span><span class="nt">"created"</span><span class="p">:</span><span class="mi">1460676804</span><span class="p">,</span><span class="w">
    </span><span class="nt">"currency"</span><span class="p">:</span><span class="s2">"usd"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"interval"</span><span class="p">:</span><span class="s2">"month"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"interval_count"</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="w">
    </span><span class="nt">"livemode"</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="w">
    </span><span class="nt">"metadata"</span><span class="p">:{},</span><span class="w">
    </span><span class="nt">"name"</span><span class="p">:</span><span class="s2">"Subscription Two"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"statement_descriptor"</span><span class="p">:</span><span class="s2">"Sub Two"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"trial_period_days"</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"statement_description"</span><span class="p">:</span><span class="s2">"Sub Two"</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="nt">"quantity"</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="w">
  </span><span class="nt">"start"</span><span class="p">:</span><span class="mi">1460695662</span><span class="p">,</span><span class="w">
  </span><span class="nt">"status"</span><span class="p">:</span><span class="s2">"active"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"tax_percent"</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"trial_end"</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"trial_start"</span><span class="p">:</span><span class="kc">null</span><span class="w">
</span><span class="p">}</span><span class="w">

</span></code></pre>

<table>
  <thead>
    <tr>
      <th>Attribute</th>
      <th> </th>
      <th style="text-align: center">Optional</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>userId</code></td>
      <td>the Stamplay <code>_id</code> of the user to update a subscriptions for</td>
      <td style="text-align: center"><i class="unchecked"></i></td>
    </tr>
    <tr>
      <td><code>subscriptionId</code></td>
      <td>the Stripe <code>_id</code> of the subscription to update</td>
      <td style="text-align: center"><i class="unchecked"></i></td>
    </tr>
    <tr>
      <td><code>options</code></td>
      <td>a set of options for updating a subscription, see <a href="https://stripe.com/docs/api/node#update_subscription">Stripe Documentation</a> for details</td>
      <td style="text-align: center"><i class="unchecked"></i></td>
    </tr>
  </tbody>
</table>

<h3 id="remove-subscription">Remove Subscription</h3>

<p>Remove a subscription from a Stripe customer.</p>

<pre class="highlight shell"><code>  curl -X <span class="s2">"DELETE"</span> <span class="s2">"https://APP-ID.stamplayapp.com/api/stripe/v1/customers/:userId/subscriptions/:subscriptionId"</span> <span class="se">\</span>
    -H <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
    -d <span class="s2">"{</span><span class="se">\"</span><span class="s2">options</span><span class="se">\"</span><span class="s2">:</span><span class="se">\"</span><span class="s2">{}</span><span class="se">\"</span><span class="s2">}"</span>
</code></pre>

<pre class="highlight javascript"><code>  <span class="nx">Stamplay</span><span class="p">.</span><span class="nx">Stripe</span><span class="p">.</span><span class="nx">deleteSubscription</span><span class="p">(</span><span class="s2">"userId"</span><span class="p">,</span> <span class="s2">"subscriptionId"</span><span class="p">,</span> <span class="nx">options</span><span class="p">)</span>
      <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">res</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// success</span>
      <span class="p">},</span>
         <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">){</span>
        <span class="c1">// error</span>
      <span class="p">})</span>
</code></pre>

<pre class="highlight nodejs"><code>  <span class="c1">// no method</span>
</code></pre>

<blockquote>
  <p>The JSON response looks like this.</p>
</blockquote>

<pre class="highlight json"><code><span class="w">
</span><span class="p">{</span><span class="w">
  </span><span class="nt">"id"</span><span class="p">:</span><span class="s2">"sub_8GrYtVQuzArBMy"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"object"</span><span class="p">:</span><span class="s2">"subscription"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"application_fee_percent"</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"cancel_at_period_end"</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="w">
  </span><span class="nt">"canceled_at"</span><span class="p">:</span><span class="mi">1460695945</span><span class="p">,</span><span class="w">
  </span><span class="nt">"current_period_end"</span><span class="p">:</span><span class="mi">1463268296</span><span class="p">,</span><span class="w">
  </span><span class="nt">"current_period_start"</span><span class="p">:</span><span class="mi">1460676296</span><span class="p">,</span><span class="w">
  </span><span class="nt">"customer"</span><span class="p">:</span><span class="s2">"cus_8GrAxVnGSGHKxv"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"discount"</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"ended_at"</span><span class="p">:</span><span class="mi">1460695945</span><span class="p">,</span><span class="w">
  </span><span class="nt">"metadata"</span><span class="p">:{},</span><span class="w">
  </span><span class="nt">"plan"</span><span class="p">:{</span><span class="w">
    </span><span class="nt">"id"</span><span class="p">:</span><span class="s2">"subscription_two"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"object"</span><span class="p">:</span><span class="s2">"plan"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"amount"</span><span class="p">:</span><span class="mi">1999</span><span class="p">,</span><span class="w">
    </span><span class="nt">"created"</span><span class="p">:</span><span class="mi">1460676804</span><span class="p">,</span><span class="w">
    </span><span class="nt">"currency"</span><span class="p">:</span><span class="s2">"usd"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"interval"</span><span class="p">:</span><span class="s2">"month"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"interval_count"</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="w">
    </span><span class="nt">"livemode"</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="w">
    </span><span class="nt">"metadata"</span><span class="p">:{},</span><span class="w">
    </span><span class="nt">"name"</span><span class="p">:</span><span class="s2">"Subscription Two"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"statement_descriptor"</span><span class="p">:</span><span class="s2">"Sub Two"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"trial_period_days"</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"statement_description"</span><span class="p">:</span><span class="s2">"Sub Two"</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="nt">"quantity"</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="w">
  </span><span class="nt">"start"</span><span class="p">:</span><span class="mi">1460695662</span><span class="p">,</span><span class="w">
  </span><span class="nt">"status"</span><span class="p">:</span><span class="s2">"canceled"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"tax_percent"</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"trial_end"</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"trial_start"</span><span class="p">:</span><span class="kc">null</span><span class="w">
</span><span class="p">}</span><span class="w">

</span></code></pre>

<table>
  <thead>
    <tr>
      <th>Attribute</th>
      <th> </th>
      <th style="text-align: center">Optional</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>userId</code></td>
      <td>the Stamplay <code>_id</code> of the user to remove a subscriptions for</td>
      <td style="text-align: center"><i class="unchecked"></i></td>
    </tr>
    <tr>
      <td><code>subscriptionId</code></td>
      <td>the Stripe <code>_id</code> of the subscription to update</td>
      <td style="text-align: center"><i class="unchecked"></i></td>
    </tr>
  </tbody>
</table>

<h2 id="cards">Cards</h2>

<p>You can store multiple cards on a customer in order to charge the customer later.</p>

<h3 id="fetch-a-users-card">Fetch A User's Card</h3>

<p>Retrieve a Stripe customer's card.</p>

<pre class="highlight shell"><code>  curl -X <span class="s2">"GET"</span> <span class="s2">"https://APP-ID.stamplayapp.com/api/stripe/v1/customers/:userId/cards"</span>
</code></pre>

<pre class="highlight javascript"><code>  <span class="nx">Stamplay</span><span class="p">.</span><span class="nx">Stripe</span><span class="p">.</span><span class="nx">getCreditCard</span><span class="p">(</span><span class="s2">"userId"</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">res</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// success</span>
    <span class="p">},</span>
       <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">){</span>
      <span class="c1">// error</span>
    <span class="p">})</span>
</code></pre>

<pre class="highlight nodejs"><code>  <span class="c1">// no method</span>
</code></pre>

<blockquote>
  <p>The JSON response looks like this.</p>
</blockquote>

<pre class="highlight json"><code><span class="w">
</span><span class="p">{</span><span class="w">
  </span><span class="nt">"last4"</span><span class="p">:</span><span class="s2">"4242"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"fingerprint"</span><span class="p">:</span><span class="s2">"0YBm29b7kpk2tbQe"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"exp_year"</span><span class="p">:</span><span class="s2">"2017"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"exp_month"</span><span class="p">:</span><span class="s2">"12"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"cvc_check"</span><span class="p">:</span><span class="s2">"pass"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"country"</span><span class="p">:</span><span class="s2">"US"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"card_id"</span><span class="p">:</span><span class="s2">"card_180Jb6JGp443qx8tOrIZ89PM"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"brand"</span><span class="p">:</span><span class="s2">"Visa"</span><span class="w">
</span><span class="p">}</span><span class="w">

</span></code></pre>

<table>
  <thead>
    <tr>
      <th>Attribute</th>
      <th> </th>
      <th style="text-align: center">Optional</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>userId</code></td>
      <td>the Stamplay <code>_id</code> of the user to fetch cards for</td>
      <td style="text-align: center"><i class="unchecked"></i></td>
    </tr>
  </tbody>
</table>

<h3 id="add-a-card">Add A Card</h3>

<p>Add a new card to a Stripe customer.</p>

<p>Obtain a token using <a href="https://stripe.com/docs/stripe.js?#card-createToken">Stripe.js</a>.</p>

<pre class="highlight shell"><code>  curl -X <span class="s2">"POST"</span> <span class="s2">"https://APP-ID.stamplayapp.com/api/stripe/v1/customers/:userId/cards"</span> <span class="se">\</span>
    -H <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
    -d <span class="s2">"{</span><span class="se">\"</span><span class="s2">token</span><span class="se">\"</span><span class="s2">:</span><span class="se">\"</span><span class="s2">card_token</span><span class="se">\"</span><span class="s2">}"</span>
</code></pre>

<pre class="highlight javascript"><code>  <span class="nx">Stamplay</span><span class="p">.</span><span class="nx">Stripe</span><span class="p">.</span><span class="nx">createCreditCard</span><span class="p">(</span><span class="s2">"userId"</span><span class="p">,</span>
     <span class="s2">"token"</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">res</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// success</span>
    <span class="p">},</span>
       <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">){</span>
      <span class="c1">// error</span>
    <span class="p">})</span>
</code></pre>

<pre class="highlight nodejs"><code>  <span class="c1">// no method</span>
</code></pre>

<blockquote>
  <p>The JSON response looks like this.</p>
</blockquote>

<pre class="highlight json"><code><span class="w">
</span><span class="p">{</span><span class="w">
  </span><span class="nt">"card_id"</span><span class="p">:</span><span class="s2">"card_180Jb6JGp443qx8tOrIZ89PM"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"last4"</span><span class="p">:</span><span class="s2">"4242"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"brand"</span><span class="p">:</span><span class="s2">"Visa"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"exp_month"</span><span class="p">:</span><span class="s2">"12"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"exp_year"</span><span class="p">:</span><span class="s2">"2017"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"fingerprint"</span><span class="p">:</span><span class="s2">"0YBm29b7kpk2tbQe"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"country"</span><span class="p">:</span><span class="s2">"US"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"cvc_check"</span><span class="p">:</span><span class="s2">"pass"</span><span class="w">
</span><span class="p">}</span><span class="w">

</span></code></pre>

<table>
  <thead>
    <tr>
      <th>Attribute</th>
      <th> </th>
      <th style="text-align: center">Optional</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>userId</code></td>
      <td>the Stamplay <code>_id</code> of the user to add a new card for</td>
      <td style="text-align: center"><i class="unchecked"></i></td>
    </tr>
    <tr>
      <td><code>token</code></td>
      <td>a token obtained from <a href="https://stripe.com/docs/stripe.js?#card-createToken">Stripe.js</a></td>
      <td style="text-align: center"><i class="unchecked"></i></td>
    </tr>
  </tbody>
</table>

<h3 id="update-a-card">Update A Card</h3>

<p>Update a card for a Stripe customer.</p>

<p>Obtain a token using <a href="https://stripe.com/docs/stripe.js?#card-createToken">Stripe.js</a>.</p>

<pre class="highlight shell"><code>  curl -X <span class="s2">"PUT"</span> <span class="s2">"https://APP-ID.stamplayapp.com/api/stripe/v1/customers/:userId/cards"</span> <span class="se">\</span>
    -H <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
    -d <span class="s2">"{</span><span class="se">\"</span><span class="s2">token</span><span class="se">\"</span><span class="s2">:</span><span class="se">\"</span><span class="s2">card_token</span><span class="se">\"</span><span class="s2">}"</span>
</code></pre>

<pre class="highlight javascript"><code>  <span class="nx">Stamplay</span><span class="p">.</span><span class="nx">Stripe</span><span class="p">.</span><span class="nx">updateCreditCard</span><span class="p">(</span><span class="s2">"userId"</span><span class="p">,</span>
     <span class="s2">"token"</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">res</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// success</span>
    <span class="p">},</span>
       <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">){</span>
      <span class="c1">// error</span>
    <span class="p">})</span>
</code></pre>

<pre class="highlight nodejs"><code>  <span class="c1">// no method</span>
</code></pre>

<blockquote>
  <p>The JSON response looks like this.</p>
</blockquote>

<pre class="highlight json"><code><span class="w">
</span><span class="p">{</span><span class="w">
  </span><span class="nt">"last4"</span><span class="p">:</span><span class="s2">"4242"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"fingerprint"</span><span class="p">:</span><span class="s2">"0YBm29b7kpk2tbQe"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"exp_year"</span><span class="p">:</span><span class="s2">"2017"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"exp_month"</span><span class="p">:</span><span class="s2">"12"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"cvc_check"</span><span class="p">:</span><span class="s2">"pass"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"country"</span><span class="p">:</span><span class="s2">"US"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"card_id"</span><span class="p">:</span><span class="s2">"card_180Jb6JGp443qx8tOrIZ89PM"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"brand"</span><span class="p">:</span><span class="s2">"Visa"</span><span class="w">
</span><span class="p">}</span><span class="w">

</span></code></pre>

<table>
  <thead>
    <tr>
      <th>Attribute</th>
      <th> </th>
      <th style="text-align: center">Optional</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>userId</code></td>
      <td>the Stamplay <code>_id</code> of the user to update a card for</td>
      <td style="text-align: center"><i class="unchecked"></i></td>
    </tr>
    <tr>
      <td><code>token</code></td>
      <td>a token obtained from <a href="https://stripe.com/docs/stripe.js?#card-createToken">Stripe.js</a></td>
      <td style="text-align: center"><i class="unchecked"></i></td>
    </tr>
  </tbody>
</table>

<h2 id="charges">Charges</h2>

<h3 id="create-charge">Create Charge</h3>

<p>Charge a Stripe customer's card.</p>

<pre class="highlight shell"><code>  curl -X <span class="s2">"POST"</span> <span class="s2">"https://APP-ID.stamplayapp.com/api/stripe/v1/charges"</span> <span class="se">\</span>
    -H <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
    -d <span class="s2">"{</span><span class="se">\"</span><span class="s2">userId</span><span class="se">\"</span><span class="s2">:</span><span class="se">\"</span><span class="s2">51e554184d88a4452c002233</span><span class="se">\"</span><span class="s2">,
      </span><span class="se">\"</span><span class="s2">token</span><span class="se">\"</span><span class="s2">:</span><span class="se">\"</span><span class="s2">card_id</span><span class="se">\"</span><span class="s2">,
      </span><span class="se">\"</span><span class="s2">amount</span><span class="se">\"</span><span class="s2">:500,
      </span><span class="se">\"</span><span class="s2">currency</span><span class="se">\"</span><span class="s2">:</span><span class="se">\"</span><span class="s2">USD</span><span class="se">\"</span><span class="s2">}"</span>
</code></pre>

<pre class="highlight javascript"><code>  <span class="nx">Stamplay</span><span class="p">.</span><span class="nx">Stripe</span><span class="p">.</span><span class="nx">charge</span><span class="p">(</span><span class="s2">"userId"</span><span class="p">,</span>
     <span class="s2">"token"</span><span class="p">,</span>
     <span class="s2">"amount"</span><span class="p">,</span>
     <span class="s2">"currency"</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">res</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// Success</span>
    <span class="p">},</span>
       <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">){</span>
      <span class="c1">// Handle Error</span>
    <span class="p">});</span>
      
</code></pre>

<pre class="highlight nodejs"><code>  <span class="c1">// no method</span>
</code></pre>

<blockquote>
  <p>The JSON response looks like this.</p>
</blockquote>

<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"id"</span><span class="p">:</span><span class="s2">"ch_180P6uJGp443qx8tho9DlZ5c"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"object"</span><span class="p">:</span><span class="s2">"charge"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"amount"</span><span class="p">:</span><span class="mi">1699</span><span class="p">,</span><span class="w">
  </span><span class="nt">"amount_refunded"</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="w">
  </span><span class="nt">"application_fee"</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"balance_transaction"</span><span class="p">:</span><span class="s2">"txn_180P6vJGp443qx8twAGVDTIl"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"captured"</span><span class="p">:</span><span class="kc">true</span><span class="p">,</span><span class="w">
  </span><span class="nt">"card"</span><span class="p">:{</span><span class="w">
    </span><span class="nt">"id"</span><span class="p">:</span><span class="s2">"card_180Jb6JGp443qx8tOrIZ89PM"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"object"</span><span class="p">:</span><span class="s2">"card"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"address_city"</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"address_country"</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"address_line1"</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"address_line1_check"</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"address_line2"</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"address_state"</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"address_zip"</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"address_zip_check"</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"brand"</span><span class="p">:</span><span class="s2">"Visa"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"country"</span><span class="p">:</span><span class="s2">"US"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"customer"</span><span class="p">:</span><span class="s2">"cus_8GrAxVnGSGHKxv"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"cvc_check"</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"dynamic_last4"</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"exp_month"</span><span class="p">:</span><span class="mi">12</span><span class="p">,</span><span class="w">
    </span><span class="nt">"exp_year"</span><span class="p">:</span><span class="mi">2017</span><span class="p">,</span><span class="w">
    </span><span class="nt">"fingerprint"</span><span class="p">:</span><span class="s2">"0YBm29b7kpk2tbQe"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"funding"</span><span class="p">:</span><span class="s2">"credit"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"last4"</span><span class="p">:</span><span class="s2">"4242"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"metadata"</span><span class="p">:{},</span><span class="w">
    </span><span class="nt">"name"</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"tokenization_method"</span><span class="p">:</span><span class="kc">null</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="nt">"created"</span><span class="p">:</span><span class="mi">1460696596</span><span class="p">,</span><span class="w">
  </span><span class="nt">"currency"</span><span class="p">:</span><span class="s2">"usd"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"customer"</span><span class="p">:</span><span class="s2">"cus_8GrAxVnGSGHKxv"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"description"</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"destination"</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"dispute"</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"failure_code"</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"failure_message"</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"fraud_details"</span><span class="p">:{},</span><span class="w">
  </span><span class="nt">"invoice"</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"livemode"</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="w">
  </span><span class="nt">"metadata"</span><span class="p">:{},</span><span class="w">
  </span><span class="nt">"order"</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"paid"</span><span class="p">:</span><span class="kc">true</span><span class="p">,</span><span class="w">
  </span><span class="nt">"receipt_email"</span><span class="p">:</span><span class="s2">"isaiahgrey@gmail.com"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"receipt_number"</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"refunded"</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="w">
  </span><span class="nt">"refunds"</span><span class="p">:{</span><span class="w">
    </span><span class="nt">"object"</span><span class="p">:</span><span class="s2">"list"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"data"</span><span class="p">:[],</span><span class="w">
    </span><span class="nt">"has_more"</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="w">
    </span><span class="nt">"total_count"</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="w">
    </span><span class="nt">"url"</span><span class="p">:</span><span class="s2">"/v1/charges/ch_180P6uJGp443qx8tho9DlZ5c/refunds"</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="nt">"shipping"</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"source"</span><span class="p">:{</span><span class="w">
    </span><span class="nt">"id"</span><span class="p">:</span><span class="s2">"card_180Jb6JGp443qx8tOrIZ89PM"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"object"</span><span class="p">:</span><span class="s2">"card"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"address_city"</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"address_country"</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"address_line1"</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"address_line1_check"</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"address_line2"</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"address_state"</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"address_zip"</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"address_zip_check"</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"brand"</span><span class="p">:</span><span class="s2">"Visa"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"country"</span><span class="p">:</span><span class="s2">"US"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"customer"</span><span class="p">:</span><span class="s2">"cus_8GrAxVnGSGHKxv"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"cvc_check"</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"dynamic_last4"</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"exp_month"</span><span class="p">:</span><span class="mi">12</span><span class="p">,</span><span class="w">
    </span><span class="nt">"exp_year"</span><span class="p">:</span><span class="mi">2017</span><span class="p">,</span><span class="w">
    </span><span class="nt">"fingerprint"</span><span class="p">:</span><span class="s2">"0YBm29b7kpk2tbQe"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"funding"</span><span class="p">:</span><span class="s2">"credit"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"last4"</span><span class="p">:</span><span class="s2">"4242"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"metadata"</span><span class="p">:{},</span><span class="w">
    </span><span class="nt">"name"</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"tokenization_method"</span><span class="p">:</span><span class="kc">null</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="nt">"source_transfer"</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"statement_descriptor"</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"status"</span><span class="p">:</span><span class="s2">"paid"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"statement_description"</span><span class="p">:</span><span class="kc">null</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<table>
  <thead>
    <tr>
      <th>Attribute</th>
      <th> </th>
      <th style="text-align: center">Optional</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>userId</code></td>
      <td>the Stamplay <code>_id</code> of the user to charge</td>
      <td style="text-align: center"><i class="unchecked"></i></td>
    </tr>
    <tr>
      <td><code>token</code></td>
      <td>the Stripe identifier for the customer card to charge</td>
      <td style="text-align: center"><i class="unchecked"></i></td>
    </tr>
    <tr>
      <td><code>amount</code></td>
      <td>the amount in cents to charge</td>
      <td style="text-align: center"><i class="unchecked"></i></td>
    </tr>
    <tr>
      <td><code>currency</code></td>
      <td>a 3-letter ISO code for currency, default <code>USD</code></td>
      <td style="text-align: center"><i class="checked"></i></td>
    </tr>
  </tbody>
</table>
