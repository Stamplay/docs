<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>Stamplay Documentation</title>
    <style>
      .highlight table td { padding: 5px; }
.highlight table pre { margin: 0; }
.highlight .c, .highlight .cd {
  color: #5e5d83;
  font-style: italic;
}
.highlight .cm {
  color: #5e5d83;
  font-style: italic;
}
.highlight .c1 {
  color: #5e5d83;
  font-style: italic;
}
.highlight .cp {
  color: #465457;
  font-weight: bold;
}
.highlight .cs {
  color: #465457;
  font-weight: bold;
  font-style: italic;
}
.highlight .err {
  color: #f8f8f2;
  background-color: #403d3d;
}
.highlight .gi {
  color: #a6e22e;
}
.highlight .gd {
  color: #f92672;
}
.highlight .ge {
  color: #1b1d1e;
  font-style: italic;
}
.highlight .gr {
  color: #f92672;
}
.highlight .gt {
  color: #f92672;
}
.highlight .gh {
  color: #403d3d;
}
.highlight .go {
  color: #403d3d;
}
.highlight .gp {
  color: #66d9ef;
}
.highlight .gs {
  font-weight: bold;
}
.highlight .gu {
  color: #465457;
}
.highlight .k, .highlight .kv {
  color: #66d9ef;
  font-weight: bold;
}
.highlight .kc {
  color: #66d9ef;
  font-weight: bold;
}
.highlight .kd {
  color: #66d9ef;
  font-weight: bold;
}
.highlight .kp {
  color: #66d9ef;
  font-weight: bold;
}
.highlight .kr {
  color: #66d9ef;
  font-weight: bold;
}
.highlight .kt {
  color: #66d9ef;
  font-weight: bold;
}
.highlight .kn {
  color: #f92672;
  font-weight: bold;
}
.highlight .ow {
  color: #f92672;
  font-weight: bold;
}
.highlight .o {
  color: #f92672;
  font-weight: bold;
}
.highlight .mf {
  color: #af87ff;
}
.highlight .mh {
  color: #af87ff;
}
.highlight .il {
  color: #af87ff;
}
.highlight .mi {
  color: #af87ff;
}
.highlight .mo {
  color: #af87ff;
}
.highlight .m, .highlight .mb, .highlight .mx {
  color: #af87ff;
}
.highlight .se {
  color: #af87ff;
}
.highlight .sb {
  color: #d7d787;
}
.highlight .sc {
  color: #d7d787;
}
.highlight .sd {
  color: #d7d787;
}
.highlight .s2 {
  color: #d7d787;
}
.highlight .sh {
  color: #d7d787;
}
.highlight .si {
  color: #d7d787;
}
.highlight .sx {
  color: #d7d787;
}
.highlight .sr {
  color: #d7d787;
}
.highlight .s1 {
  color: #d7d787;
}
.highlight .ss {
  color: #d7d787;
}
.highlight .s {
  color: #d7d787;
}
.highlight .na {
  color: #a6e22e;
}
.highlight .nc {
  color: #a6e22e;
  font-weight: bold;
}
.highlight .nd {
  color: #a6e22e;
  font-weight: bold;
}
.highlight .ne {
  color: #a6e22e;
  font-weight: bold;
}
.highlight .nf {
  color: #a6e22e;
  font-weight: bold;
}
.highlight .no {
  color: #66d9ef;
}
.highlight .bp {
  color: #f8f8f2;
}
.highlight .nb {
  color: #f8f8f2;
}
.highlight .ni {
  color: #f8f8f2;
}
.highlight .nn {
  color: #f8f8f2;
}
.highlight .vc {
  color: #f8f8f2;
}
.highlight .vg {
  color: #f8f8f2;
}
.highlight .vi {
  color: #f8f8f2;
}
.highlight .nv {
  color: #f8f8f2;
}
.highlight .w {
  color: #f8f8f2;
}
.highlight .nl {
  color: #f8f8f2;
  font-weight: bold;
}
.highlight .nt {
  color: #f92672;
}
.highlight {
  color: #f8f8f2;
  background-color: #1b1d1e;
}
    </style>
    <link href="images/favicon.png" rel="icon" type="image/png" />
    <link href="stylesheets/screen.css" rel="stylesheet" media="screen" />
    <link href="stylesheets/print.css" rel="stylesheet" media="print" />
      <script src="javascripts/all.js"></script>
  </head>

  <body class="index" data-languages="[&quot;shell&quot;,&quot;javascript&quot;,&quot;nodejs&quot;]">
    <a href="#" id="nav-button">
      <span>
        NAV
        <img src="images/navbar.png" />
      </span>
    </a>
    <div class="tocify-wrapper">
          <a href="https://stamplay.com"><img alt="logo" class="logo" src="images/logo.png" /></a>
        <div class="lang-selector">
              <a href="#" data-language-name="shell">cURL</a>
              <a href="#" data-language-name="javascript">JavaScript</a>
              <a href="#" data-language-name="nodejs">Node.js</a>
        </div>
        <div class="search">
          <input type="text" class="search" id="input-search" placeholder="Search">
        </div>
        <ul class="search-results"></ul>
      <div id="toc">
      </div>
    </div>
    <div class="page-wrapper">
      <div class="dark-box"></div>
      <div class="content">
        

          
<h1 id="getting-help">Getting Help</h1>

<h2 id="technical-questions">Technical Questions</h2>

<p>For questions related to our API, SDKs, or general technical help, use the <a href="https://stackoverflow.com/tags/stamplay">Stamplay tag on Stackoverflow</a>.</p>

<p>After posting on Stackoverflow, adding the link to your question in our <a href="http://slackinvites.stamplayapp.com">Slack Community</a> will allow other Stamplayers the opportunity to provide any insight into your question.</p>

<h2 id="discussion-and-feedback">Discussion and Feedback</h2>

<p>To discuss Stamplay with other Stamplayers, give feedback, report bugs, or submit feature requests, <a href="http://slackinvites.stamplayapp.com">join our Slack Community</a>.</p>

<p>For account related questions, submit a ticket to <a href="&#109;&#097;&#105;&#108;&#116;&#111;:&#115;&#117;&#112;&#112;&#111;&#114;&#116;&#064;&#115;&#116;&#097;&#109;&#112;&#108;&#097;&#121;&#046;&#099;&#111;&#109;">&#115;&#117;&#112;&#112;&#111;&#114;&#116;&#064;&#115;&#116;&#097;&#109;&#112;&#108;&#097;&#121;&#046;&#099;&#111;&#109;</a>.</p>

<h2 id="contributing">Contributing</h2>

<p>Our documentation is open source! This means if you would like to contribute to our community, tidy up or add a better example/explanation for a problem you've solved, suggest new content sections or just fix a typo, you can.</p>

<p>To contribute, checkout the repo to find out how get things setup in your local enviornment, and learn about our <a href="https://github.com/Stamplay/docs/wiki">contribution guidelines</a>, see our <a href="https://github.com/Stamplay/docs">Github</a>.</p>

          <h1 id="quickstart">Quickstart</h1>

<h2 id="create-an-account">Create An Account</h2>

<p>The first thing needed to get started with Stamplay is to <a href="https://editor.stamplay.com">signup for a free account</a>.</p>

<p>After signing up, create your first Stamplay application in the dashboard by entering a name for your application in the input and selecing <strong>CREATE</strong>.</p>

<h2 id="install-cli">Install CLI</h2>

<pre class="highlight shell-always"><code>  <span class="nx">npm</span> <span class="nx">install</span> <span class="o">-</span><span class="nx">g</span> <span class="nx">stamplay</span><span class="o">-</span><span class="nx">cli</span>
</code></pre>

<p>The Stamplay CLI will allow you to run your application locally, manage application versioning, deploy to the cloud, etc.</p>

<p>Ensure you have Node.js &amp; NPM installed, then <code>npm install</code> the <code>stamplay-cli</code> package globally.</p>

<p>After installing the CLI, initialize a project locally inside a project folder by running an <code>init</code> command from the <code>stamplay</code> CLI.</p>

<pre class="highlight shell-always"><code>  <span class="nx">stamplay</span> <span class="nx">init</span>
</code></pre>

<p>You will be prompted to enter an <code>APP ID</code> and <code>API KEY</code> for a Stamplay application. These can be found in the <strong>Dashboard</strong> of the application created in the previous step.</p>

<pre class="highlight shell-always"><code>  <span class="nx">stamplay</span> <span class="nx">start</span>
</code></pre>

<p>To run our application locally, run the <code>start</code> command from the <code>stamplay</code> CLI.</p>

<h2 id="setup">Setup</h2>

<pre class="highlight javascript"><code>  <span class="nx">bower</span> <span class="nx">install</span> <span class="nx">stamplay</span><span class="o">-</span><span class="nx">js</span><span class="o">-</span><span class="nx">sdk</span>
</code></pre>

<pre class="highlight javascript"><code>  <span class="nx">Stamplay</span><span class="p">.</span><span class="nx">init</span><span class="p">(</span><span class="s2">"APP-ID"</span><span class="p">)</span>
</code></pre>

<div class="lang-content javascript">

  <p>The <a href="https://github.com/Stamplay/stamplay-js-sdk">Stamplay JavaScript SDK</a> is a client-side library for interacting with Stamplay.</p>

  <p>Run <code>bower install</code> for the <code>stamplay-js-sdk</code> package to download from <code>bower</code> into your local project directory.</p>

  <p>To initialize the library, run the <code>init</code> method from the <code>Stamplay</code> SDK.</p>

</div>

<div class="lang-content shell">

  <p>For REST API Quickstart proceed to the next step, otherwise select the <strong>JavaScript</strong> tab for the SDK quickstart instructions for this step.</p>

</div>

<h2 id="define-schema">Define Schema</h2>

<p>Create a new Object schema by visiting the <strong>Object</strong> section within the editor for your application through the sidebar.</p>

<p>Inside the <strong>Object</strong> section, add a name and data type for each property on the schema desired and <strong>Save</strong>.</p>

<h2 id="write-data">Write Data</h2>

<pre class="highlight shell"><code>  curl -X <span class="s2">"POST"</span> <span class="s2">"https://APP-ID.stamplayapp.com/api/cobject/v1/car"</span> <span class="se">\</span>
    -H <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
    -d <span class="s2">"{</span><span class="se">\"</span><span class="s2">make</span><span class="se">\"</span><span class="s2">:</span><span class="se">\"</span><span class="s2">Volkswagen</span><span class="se">\"</span><span class="s2">,</span><span class="se">\"</span><span class="s2">model</span><span class="se">\"</span><span class="s2">:</span><span class="se">\"</span><span class="s2">Jetta</span><span class="se">\"</span><span class="s2">,</span><span class="se">\"</span><span class="s2">year</span><span class="se">\"</span><span class="s2">:2013,</span><span class="se">\"</span><span class="s2">color</span><span class="se">\"</span><span class="s2">:</span><span class="se">\"</span><span class="s2">silver</span><span class="se">\"</span><span class="s2">,</span><span class="se">\"</span><span class="s2">top_speed</span><span class="se">\"</span><span class="s2">:140}"</span>
</code></pre>

<pre class="highlight javascript"><code><span class="kd">var</span> <span class="nx">car</span> <span class="o">=</span> <span class="p">{</span>
  <span class="na">make</span> <span class="p">:</span> <span class="s2">"Volkswagen"</span><span class="p">,</span>
  <span class="na">model</span> <span class="p">:</span> <span class="s2">"Jetta"</span><span class="p">,</span>
  <span class="na">year</span> <span class="p">:</span> <span class="mi">2013</span><span class="p">,</span>
  <span class="na">color</span> <span class="p">:</span> <span class="s2">"silver"</span><span class="p">,</span>
  <span class="na">top_speed</span> <span class="p">:</span> <span class="mi">140</span>
<span class="p">}</span>

<span class="nx">Stamplay</span><span class="p">.</span><span class="nb">Object</span><span class="p">(</span><span class="s2">"car"</span><span class="p">).</span><span class="nx">save</span><span class="p">(</span><span class="nx">car</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">res</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// success</span>
  <span class="p">},</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// error</span>
  <span class="p">})</span>
</code></pre>

<div class="lang-content javascript">

  <p>To write data to Stamplay, model an object after the schema just created.</p>

  <p>Pass the object into the <code>save</code> method on the <code>Stamplay.Object</code> class.</p>

  <p>Most every SDK method returns a promise, or you can pass a callback in as the last method argument.</p>

</div>

<div class="lang-content shell">

  <p>To write data, send a JSON object modeled after the schema in a <code>POST</code> request body to the API <a href="#objects">Object</a> resource.</p>

</div>

<h2 id="read-data">Read Data</h2>

<pre class="highlight javascript"><code>  <span class="nx">Stamplay</span><span class="p">.</span><span class="nb">Object</span><span class="p">(</span><span class="s2">"car"</span><span class="p">).</span><span class="nx">get</span><span class="p">({})</span>
    <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">res</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// success</span>
    <span class="p">},</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// error</span>
    <span class="p">})</span>
</code></pre>

<pre class="highlight shell"><code>  curl -X <span class="s2">"GET"</span> <span class="s2">"https://APP-ID.stamplayapp.com/api/cobject/v1/car"</span>
</code></pre>

<div class="lang-content javascript">

  <p>To fetch <strong>Object</strong> data from  Stamplay, use the <code>get</code> method on the <code>Stamplay.Object</code> class.</p>

  <p>The <code>get</code> method takes an options object. The object is matched against all records, and returns only those that match.</p>

</div>

<div class="lang-content shell">

  <p>To read object data, send a <code>GET</code> request to the API Object resource.</p>

</div>

<h2 id="register-users">Register Users</h2>

<pre class="highlight javascript"><code>
<span class="kd">var</span> <span class="nx">credentials</span> <span class="o">=</span> <span class="p">{</span>
  <span class="na">email</span> <span class="p">:</span> <span class="s2">"user@provider.com"</span><span class="p">,</span>
  <span class="na">password</span> <span class="p">:</span> <span class="s2">"123123"</span>
<span class="p">};</span>

<span class="nx">Stamplay</span><span class="p">.</span><span class="nx">User</span><span class="p">.</span><span class="nx">signup</span><span class="p">(</span><span class="nx">credentials</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">res</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// success</span>
  <span class="p">},</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// error</span>
  <span class="p">})</span>

</code></pre>

<pre class="highlight shell"><code>
 curl -X <span class="s2">"POST"</span> <span class="s2">"https://APP-ID.stamplayapp.com/api/user/v1/users"</span> <span class="se">\</span>
    -H <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
    -d <span class="s2">"{</span><span class="se">\"</span><span class="s2">email</span><span class="se">\"</span><span class="s2">:</span><span class="se">\"</span><span class="s2">user@stamplay.com</span><span class="se">\"</span><span class="s2">,</span><span class="se">\"</span><span class="s2">password</span><span class="se">\"</span><span class="s2">:</span><span class="se">\"</span><span class="s2">my_password</span><span class="se">\"</span><span class="s2">}"</span>

</code></pre>

<p>To register a user with a local account, no additional setup within the Stamplay editor is required.</p>

<div class="lang-content javascript">

  <p>Use the <code>signup</code> method on the the <code>Stamplay.User</code> class, and pass in an object with at least an <code>email</code> and <code>password</code> property.</p>

</div>

<div class="lang-content shell">

  <p>To register, send a <code>POST</code> request to the API <a href="#users">User</a> resource, with a JSON object that has an <code>email</code> and <code>password</code> property, in the request body.</p>

</div>

<h2 id="login-users">Login Users</h2>

<div class="lang-content javascript">

  <p>To login a user to a local account, use the <code>login</code> method on the <code>Stamplay.User</code> class.</p>

</div>

<div class="lang-content shell">

  <p>To login a user to a local account, send a <code>POST</code> request with JSON object in the body, that contains an <code>email</code> and <code>password</code> of a registered account.</p>

</div>

<pre class="highlight javascript"><code><span class="kd">var</span> <span class="nx">credentials</span> <span class="o">=</span> <span class="p">{</span>
  <span class="na">email</span> <span class="p">:</span> <span class="s2">"user@provider.com"</span><span class="p">,</span>
  <span class="na">password</span> <span class="p">:</span> <span class="s2">"123123"</span>
<span class="p">}</span>

<span class="nx">Stamplay</span><span class="p">.</span><span class="nx">User</span><span class="p">.</span><span class="nx">login</span><span class="p">(</span><span class="nx">credentials</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">res</span><span class="p">)</span> <span class="p">{</span>
   <span class="c1">// success</span>
  <span class="p">},</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// error</span>
  <span class="p">})</span>
</code></pre>

<pre class="highlight shell"><code>
 curl -X <span class="s2">"POST"</span> <span class="s2">"https://APP-ID.stamplayapp.com/auth/v1/local/login"</span> <span class="se">\</span>
    -H <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
    -d <span class="s2">"{</span><span class="se">\"</span><span class="s2">email</span><span class="se">\"</span><span class="s2">:</span><span class="se">\"</span><span class="s2">user@stamplay.com</span><span class="se">\"</span><span class="s2">,</span><span class="se">\"</span><span class="s2">password</span><span class="se">\"</span><span class="s2">:</span><span class="se">\"</span><span class="s2">my_password</span><span class="se">\"</span><span class="s2">}"</span>

</code></pre>

<h2 id="deploy">Deploy</h2>

<p>To deploy your application, run the <code>deploy</code> command from the <code>stamplay</code> CLI.</p>

<pre class="highlight shell-always"><code>  <span class="nx">stamplay</span> <span class="nx">deploy</span>
</code></pre>

<p>After deployment is finished, your application will be live at <a href="[YOUR APP ID].stamplayapp.com">[YOUR APP ID].stamplayapp.com</a>.</p>

          <h1 id="api-overview">API Overview</h1>

<h2 id="summary">Summary</h2>

<p>The Stamplay API exposes the following resources:</p>

<!-- Manage and access object data.
Manage and access user data, create user sessions.
Manage and access user roles, assign roles.
Execute Code Blocks.
Manage customers and payment information, charge a customer, add subscriptions.
Send an email. -->

<table>
  <thead>
    <tr>
      <th>Resource</th>
      <th style="text-align: right">Endpoint</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><a href="#objects">Objects</a></td>
      <td style="text-align: right">/api/cobject/v1/:cobjectId</td>
    </tr>
    <tr>
      <td><a href="#users">Users</a></td>
      <td style="text-align: right">/api/user/v1/users</td>
    </tr>
    <tr>
      <td><a href="#roles">Roles</a></td>
      <td style="text-align: right">/api/user/v1/roles</td>
    </tr>
    <tr>
      <td><a href="#code-blocks">Code Blocks</a></td>
      <td style="text-align: right">/api/v1/run/:codeblockId</td>
    </tr>
    <tr>
      <td><a href="#stripe">Stripe</a></td>
      <td style="text-align: right">/api/stripe/v1/</td>
    </tr>
  </tbody>
</table>

<h2 id="pagination">Pagination</h2>

<pre class="highlight shell"><code>curl -X <span class="s2">"GET"</span> <span class="s2">"https://APP-ID.stamplayapp.com/api/cobject/v1/movie?page=2&amp;per_page=30"</span>
</code></pre>

<pre class="highlight javascript"><code><span class="nx">Stamplay</span><span class="p">.</span><span class="nb">Object</span><span class="p">(</span><span class="s2">"movie"</span><span class="p">).</span><span class="nx">get</span><span class="p">({</span>
  <span class="na">page</span> <span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
  <span class="na">per_page</span> <span class="p">:</span> <span class="mi">30</span>
<span class="p">}).</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">res</span><span class="p">)</span> <span class="p">{</span>
  <span class="c1">// success</span>
<span class="p">}.</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
  <span class="c1">// error</span>
<span class="p">})</span>
</code></pre>
<pre class="highlight nodejs"><code><span class="nx">Stamplay</span><span class="p">.</span><span class="nb">Object</span><span class="p">(</span><span class="s2">"movie"</span><span class="p">).</span><span class="nx">get</span><span class="p">({</span>
  <span class="na">page</span> <span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
  <span class="na">per_page</span> <span class="p">:</span> <span class="mi">30</span>
<span class="p">},</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">res</span><span class="p">)</span> <span class="p">{</span>
  <span class="c1">// response</span>
<span class="p">})</span>
</code></pre>
<p>Responses from the <strong>User</strong> and <strong>Object</strong> resource will also return a <code>pagination</code> object.</p>

<p>Pagination can be managed by using the <code>page</code> and <code>per_page</code> query parameters. The maximum <code>per_page</code> value allowed is capped at <code>250</code>. This means that any <code>per_page</code> value beyond that will always return <code>250</code> results.</p>

<p>Pagination details are included using the Link header introduced by RFC 5988.
The Link header returns a set of ready-made links so the API consumer does not have to construct the links themselves.</p>

<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w">
  </span><span class="nt">"pagination"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"page"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
    </span><span class="nt">"per_page"</span><span class="p">:</span><span class="w"> </span><span class="mi">20</span><span class="p">,</span><span class="w">
    </span><span class="nt">"total_pages"</span><span class="p">:</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w">
    </span><span class="nt">"total_elements"</span><span class="p">:</span><span class="w"> </span><span class="mi">71</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<hr />

<p><em>Default pagination attribute values:</em></p>

<table>
  <thead>
    <tr>
      <th>Property</th>
      <th>Type</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>page</td>
      <td>Number</td>
      <td>1</td>
    </tr>
    <tr>
      <td>per_page</td>
      <td>Number</td>
      <td>20</td>
    </tr>
    <tr>
      <td>total_pages</td>
      <td>Number</td>
      <td><code>total_elements / per_page</code></td>
    </tr>
    <tr>
      <td>total_elements</td>
      <td>Number</td>
      <td>total of the type queried</td>
    </tr>
  </tbody>
</table>

<h2 id="filtering">Filtering</h2>

<pre class="highlight shell"><code>  curl -X <span class="s2">"GET"</span> <span class="s2">"https://APP-ID.stamplayapp.com/api/cobject/v1/picture?status=published"</span>
</code></pre>

<pre class="highlight javascript"><code><span class="nx">Stamplay</span><span class="p">.</span><span class="nb">Object</span><span class="p">(</span><span class="s2">"picture"</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">get</span><span class="p">({</span> <span class="na">status</span> <span class="p">:</span> <span class="s2">"published"</span> <span class="p">})</span>
  <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">res</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// success</span>
  <span class="p">},</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// error</span>
  <span class="p">})</span>
</code></pre>

<pre class="highlight nodejs"><code><span class="nx">Stamplay</span><span class="p">.</span><span class="nb">Object</span><span class="p">(</span><span class="s1">'picture'</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">get</span><span class="p">({</span> <span class="na">status</span> <span class="p">:</span> <span class="s2">"published"</span> <span class="p">},</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">res</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// response</span>
  <span class="p">})</span>
</code></pre>

<p>To filter a response based on a value of a field, set the field and value as a parameter in the request. To filter by more than one field, add each filterable field to the request as a paramter.</p>

<hr />

<p><em>Default properties available to filter by:</em></p>

<table>
  <thead>
    <tr>
      <th>Property</th>
      <th>Type</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>dt_create</td>
      <td>Date</td>
    </tr>
    <tr>
      <td>dt_update</td>
      <td>Date</td>
    </tr>
    <tr>
      <td>_id</td>
      <td>MongoID (String)</td>
    </tr>
  </tbody>
</table>

<p>Any property on a data structure is filterable, the above only contain the absolute base structure which is always present on a Stamplay database record.</p>

<h2 id="sorting">Sorting</h2>

<pre class="highlight shell"><code>	curl -X <span class="s2">"GET"</span> <span class="s2">"https://APP-ID.stamplayapp.com/api/cobject/v1/movie?sort=-dt_create"</span>
</code></pre>

<pre class="highlight javascript"><code><span class="nx">Stamplay</span><span class="p">.</span><span class="nb">Object</span><span class="p">(</span><span class="s2">"movie"</span><span class="p">).</span><span class="nx">get</span><span class="p">({</span> <span class="na">sort</span> <span class="p">:</span> <span class="s2">"-dt_create"</span> <span class="p">})</span>
  <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">res</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// success</span>
  <span class="p">},</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// error</span>
  <span class="p">})</span>
</code></pre>

<pre class="highlight nodejs"><code><span class="nx">Stamplay</span><span class="p">.</span><span class="nb">Object</span><span class="p">(</span><span class="s1">'movie'</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">get</span><span class="p">({</span> <span class="na">sort</span> <span class="p">:</span> <span class="s2">"-dt_create"</span> <span class="p">},</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">res</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// response</span>
  <span class="p">})</span>
</code></pre>

<p>To sort the response, set a <code>sort</code> parameter as a comma delimited list to sort by in order of importance.</p>

<p>If a field name is appened to an <code>-</code> character then that field will be sorted in descending order based on the type, otherwise by default the field will be sort in ascending order.</p>

<p><em>Default properties available to sort by:</em></p>

<table>
  <thead>
    <tr>
      <th>Property</th>
      <th>Data Type</th>
      <th style="text-align: center">Sort By : Default - Ascending</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>dt_create</td>
      <td>Date</td>
      <td style="text-align: center"><i class="checked"></i></td>
    </tr>
    <tr>
      <td>dt_update</td>
      <td>Date</td>
      <td style="text-align: center"><i class="unchecked"></i></td>
    </tr>
    <tr>
      <td>_id</td>
      <td>MongoID (String)</td>
      <td style="text-align: center"><i class="unchecked"></i></td>
    </tr>
  </tbody>
</table>

<h2 id="selecting">Selecting</h2>

<pre class="highlight shell"><code>curl -X <span class="s2">"GET"</span> <span class="s2">"https://APP-ID.stamplayapp.com/api/cobject/v1/movie?select=-dt_create,owner,title"</span>
</code></pre>

<pre class="highlight javascript"><code><span class="nx">Stamplay</span><span class="p">.</span><span class="nb">Object</span><span class="p">(</span><span class="s2">"movie"</span><span class="p">).</span><span class="nx">get</span><span class="p">({</span> <span class="na">select</span> <span class="p">:</span> <span class="s2">"dt_create,owner,title"</span> <span class="p">})</span>
  <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">res</span><span class="p">)</span> <span class="p">{</span>
	  <span class="c1">// success</span>
	<span class="p">},</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
	  <span class="c1">// error</span>
  <span class="p">})</span>
</code></pre>

<pre class="highlight nodejs"><code><span class="nx">Stamplay</span><span class="p">.</span><span class="nb">Object</span><span class="p">(</span><span class="s1">'movie'</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">get</span><span class="p">({</span> <span class="na">sort</span> <span class="p">:</span> <span class="s2">"dt_create,owner,title"</span> <span class="p">},</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">res</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// response</span>
  <span class="p">})</span>
</code></pre>

<p>Selecting is the response projection for each object returned. This allows for a lighter data transfer between requests, and simplifies response objects.</p>

<p>To select a field to return, set the <code>select</code> request parameter to the value of the field name to return. If you want to return more than one field, set the <code>select</code> parameter as a comma delimited set of properties to return.</p>

<p>The <code>_id</code> field is always returned.</p>

<hr />

<p><em>Default return properties:</em></p>

<p>By default all properties are returned.</p>

<h2 id="populating-references">Populating References</h2>

<pre class="highlight shell"><code>curl -X <span class="s2">"GET"</span> <span class="s2">"https://APP-ID.stamplayapp.com/api/cobject/v1/movie?populate=true"</span>

</code></pre>

<pre class="highlight javascript"><code>  <span class="nx">Stamplay</span><span class="p">.</span><span class="nb">Object</span><span class="p">(</span><span class="s2">"movie"</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">get</span><span class="p">({</span> <span class="na">populate</span> <span class="p">:</span> <span class="kc">true</span> <span class="p">})</span>
    <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">res</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// success</span>
    <span class="p">},</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// error</span>
    <span class="p">})</span>
</code></pre>

<pre class="highlight nodejs"><code><span class="nx">Stamplay</span><span class="p">.</span><span class="nb">Object</span><span class="p">(</span><span class="s1">'movie'</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">get</span><span class="p">({</span> <span class="na">populate</span> <span class="p">:</span> <span class="kc">true</span> <span class="p">},</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">res</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// response</span>
  <span class="p">})</span>
</code></pre>

<div class="lang-content shell">
  <p>To populate reference fields in the response, add the <code>populate</code> parameter to the request URI as <code>true</code>.</p>
</div>

<div class="lang-content javascript nodejs">
  <p>To populate reference fields in the response, add the <code>populate</code> property to the <code>get</code> SDK method options object.</p>
</div>

<h2 id="advanced-queries">Advanced Queries</h2>

<pre class="highlight shell"><code>  curl -X <span class="s2">"GET"</span> <span class="s1">'https://APP-ID.stamplayapp.com/api/cobject/v1/movie?where=\{"rating":\{"$gt":5\}\}'</span>
</code></pre>

<pre class="highlight javascript"><code>  <span class="nx">Stamplay</span><span class="p">.</span><span class="nb">Object</span><span class="p">(</span><span class="s2">"movie"</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">get</span><span class="p">({</span> <span class="na">where</span> <span class="p">:</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">({</span> <span class="na">rating</span> <span class="p">:</span> <span class="p">{</span> <span class="na">$gt</span> <span class="p">:</span> <span class="mi">5</span> <span class="p">}</span> <span class="p">})</span> <span class="p">})</span>
    <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">res</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// success</span>
    <span class="p">},</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// error</span>
    <span class="p">})</span>
</code></pre>

<pre class="highlight nodejs"><code><span class="nx">Stamplay</span><span class="p">.</span><span class="nb">Object</span><span class="p">(</span><span class="s1">'movie'</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">get</span><span class="p">({</span> <span class="na">where</span> <span class="p">:</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">({</span> <span class="na">rating</span> <span class="p">:</span> <span class="p">{</span> <span class="na">$gt</span> <span class="p">:</span> <span class="mi">5</span> <span class="p">}</span> <span class="p">})</span> <span class="p">},</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">res</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// response</span>
  <span class="p">})</span>
</code></pre>

<p>For more advanced methods of queries, Stamplay supports an array of MongoDB's conditional operators.</p>

<p>By setting a JSON query string to the <code>where</code> parameter you can use the operators to perform advanced queries.</p>

<table>
  <thead>
    <tr>
      <th>Operator</th>
      <th>Summary</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>$gt</td>
      <td>Matches values that are greater than the value specified in the query.</td>
    </tr>
    <tr>
      <td>$gte</td>
      <td>Matches values that are greater than or equal to the value specified in the query.</td>
    </tr>
    <tr>
      <td>$in</td>
      <td>Matches any of the values that exist in an array specified in the query.</td>
    </tr>
    <tr>
      <td>$lt</td>
      <td>Matches values that are less than the value specified in the query.</td>
    </tr>
    <tr>
      <td>$lte</td>
      <td>Matches values that are less than or equal to the value specified in the query.</td>
    </tr>
    <tr>
      <td>$ne</td>
      <td>Matches all values that are not equal to the value specified in the query.</td>
    </tr>
    <tr>
      <td>$nin</td>
      <td>Matches values that do not exist in an array specified to the query.</td>
    </tr>
    <tr>
      <td>$or</td>
      <td>Joins query clauses with a logical OR returns all documents that match the conditions of either clause.</td>
    </tr>
    <tr>
      <td>$and</td>
      <td>Joins query clauses with a logical AND returns all documents that match the conditions of both clauses.</td>
    </tr>
    <tr>
      <td>$not</td>
      <td>Inverts the effect of a query expression and returns documents that do not match the query expression.</td>
    </tr>
    <tr>
      <td>$nor</td>
      <td>Joins query clauses with a logical NOR returns all documents that fail to match both clauses.</td>
    </tr>
    <tr>
      <td>$exists</td>
      <td>Matches documents that have the specified field.</td>
    </tr>
    <tr>
      <td>$type</td>
      <td>Selects documents if a field is of the specified type.</td>
    </tr>
    <tr>
      <td>$all</td>
      <td>Matches arrays that contain all elements specified in the query.</td>
    </tr>
    <tr>
      <td>$elemMatch</td>
      <td>Selects documents if element in the array field matches all the specified $elemMatch condition.</td>
    </tr>
    <tr>
      <td>$size</td>
      <td>Selects documents if the array field is a specified size</td>
    </tr>
    <tr>
      <td>$regex</td>
      <td>Selects documents where values match a specified regular expression.</td>
    </tr>
  </tbody>
</table>

<h2 id="authorization">Authorization</h2>

<pre class="highlight shell-always"><code>	
  <span class="s2">"Authorization"</span> <span class="err">:</span> <span class="s2">"Basic c3RhbXBsYXlrYjo5MTRhMmUzMaMwZWRlMDdmZThhNjYzMzkxMWQyYWQyOTNkNjJkNTQ3OGFiYmViNjEyNzhhYjFjYzE2MDhiZaRi"</span>
</code></pre>

<pre class="highlight shell-always"><code>  <span class="s2">"x-stamplay-jwt"</span> <span class="err">:</span> <span class="s2">"eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ0eXBlIjoidXNlciIsImFwcERvbWFpbiI6InN0YW1wbGF5a2Iuc3RhbXBsYXlscHAuY29tIiwiYXBwSWQiOiJzdGFtcGxheWtiIiwidXNlciI6IjU2ZjAyZDY0NjFkNWI0MTA1ZDFhMjY4NCIsImlhdCI6MTQ1ODU4MTQwNiwiZXhwIjoxNDU5MTg2Mjc4fQ.UDFUe0Zb2ZHx3HXdiUXWnHSyKghVI_harpkkyC3BU8A"</span>
</code></pre>

<p>Depending on the origin enviornment of a request to Stamplay, the method of authenticating the request differs.</p>

<p>Client side requests can be authenticated by setting the <code>x-stamplay-jwt</code> header as the JSON Web Token issued when a user authenticates with an email and password, or social provider.</p>

<p>Server side request can be authenticated by setting the <code>Authorization</code> header as <code>Basic AppId:ApiKey</code>. The <code>AppId:ApiKey</code> are to be set as a base64 encoding.</p>

<h2 id="cors-policy">CORS Policy</h2>

<p>Stamplay uses a selective cross-origin resource sharing (CORS) policy, meaning that you may only make requests to the Stamplay from an origin that has been previously declared.</p>

<p>This is made to govern which origins are authorized and which are not. By default only the base URL ending with <code>.stamplayapp.com</code> is the one allowed to send requests.</p>

<p>To enabled other CORS enabled domains, visit the <strong>Hosting</strong> section with the Stamplay editor.</p>

<h2 id="allowed-http-requests">Allowed HTTP Requests</h2>

<table>
  <thead>
    <tr>
      <th>Method</th>
      <th>Summary</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>GET</td>
      <td>Get a resource or list of resources</td>
    </tr>
    <tr>
      <td>POST</td>
      <td>Create a resource</td>
    </tr>
    <tr>
      <td>PUT</td>
      <td>Update a resource</td>
    </tr>
    <tr>
      <td>PATCH</td>
      <td>Update a resource partially</td>
    </tr>
    <tr>
      <td>DELETE</td>
      <td>Delete a resource</td>
    </tr>
  </tbody>
</table>

<h2 id="error-codes">Error Codes</h2>

<table>
  <thead>
    <tr>
      <th>Status Code</th>
      <th>Status Text</th>
      <th>Summary</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>200</td>
      <td>OK</td>
      <td>The request was successful.</td>
    </tr>
    <tr>
      <td>201</td>
      <td>Created</td>
      <td>The request was successful and a resource was created.</td>
    </tr>
    <tr>
      <td>204</td>
      <td>No Content</td>
      <td>The request was successful but there is no representation to return (i.e. the response is empty).</td>
    </tr>
    <tr>
      <td>400</td>
      <td>Bad Request</td>
      <td>The request could not be understood or was missing required parameters.</td>
    </tr>
    <tr>
      <td>401</td>
      <td>Unauthorized</td>
      <td>Authentication failed or the user request the resource doesn’t have the required permissions for reqested operation.</td>
    </tr>
    <tr>
      <td>403</td>
      <td>Forbidden</td>
      <td>Access denied, Authentication will not help.</td>
    </tr>
    <tr>
      <td>404</td>
      <td>Not Found</td>
      <td>Resource not found.</td>
    </tr>
    <tr>
      <td>405</td>
      <td>Method Not Allowed</td>
      <td>Requested method is not supported for resource.</td>
    </tr>
    <tr>
      <td>500</td>
      <td>Internal Server Error</td>
      <td>Something went wrong during your request</td>
    </tr>
  </tbody>
</table>

          <h1 id="sdk-and-client-libraries">SDK and Client Libraries</h1>

<h2 id="javascript-sdk">Javascript SDK</h2>

<pre class="highlight shell-always"><code>  <span class="nx">bower</span> <span class="nx">install</span> <span class="nx">stamplay</span><span class="o">-</span><span class="nx">js</span><span class="o">-</span><span class="nx">sdk</span>

  <span class="nx">or</span>

  <span class="nx">npm</span> <span class="nx">install</span> <span class="nx">stamplay</span><span class="o">-</span><span class="nx">sdk</span>
</code></pre>

<pre class="highlight shell-always"><code>  <span class="nx">Stamplay</span><span class="p">.</span><span class="nx">init</span><span class="p">(</span><span class="s2">"APP ID"</span><span class="p">);</span>
</code></pre>

<p>The JavaScript SDK is a client side library to help simplify interacting with the Stamplay API. It is available both on <code>npm</code> and <code>bower</code>.</p>

<p>To install the JavaScript SDK, run <code>bower install</code> for the <code>stamplay-js-sdk</code>.</p>

<p>To initialize the SDK within your client side enviornment, run the <code>init</code> method on the <code>Stamplay</code> global object. Ensure the module has been included before running the method, and pass in your <code>APP ID</code> as the sole method argument.</p>

<p>An additional options object can be passed in as the second argument, but is primarily meant for use within a mobile application.</p>

<p>Our <a href="https://github.com/Stamplay/stamplay-js-sdk">JavaScript SDK is open source on Github</a>!</p>

<h3 id="javascript-api-reference">JavaScript API Reference</h3>

<p>The JavaScript SDK exposes the following components and methods:</p>

<h4 id="users">Users</h4>

<table>
  <thead>
    <tr>
      <th><a href="#users">User</a></th>
      <th><code>Stamplay.User</code></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>save</td>
      <td><strong>save(data, [callback])</strong></td>
    </tr>
    <tr>
      <td>get</td>
      <td><strong>get(data, [callback])</strong></td>
    </tr>
    <tr>
      <td>getById</td>
      <td><strong>getById(id, data, [callback])</strong></td>
    </tr>
    <tr>
      <td>remove</td>
      <td><strong>remove(id, [callback])</strong></td>
    </tr>
    <tr>
      <td>update</td>
      <td><strong>update(id, data, [callback] )</strong></td>
    </tr>
    <tr>
      <td>currentUser</td>
      <td><strong>currentUser([callback])</strong></td>
    </tr>
    <tr>
      <td>login</td>
      <td><strong>login(data, [callback])</strong></td>
    </tr>
    <tr>
      <td>socialLogin</td>
      <td><strong>socialLogin(provider)</strong></td>
    </tr>
    <tr>
      <td>signup</td>
      <td><strong>signup(data, [callback])</strong></td>
    </tr>
    <tr>
      <td>logout</td>
      <td><strong>logout()</strong></td>
    </tr>
    <tr>
      <td>resetPassword</td>
      <td><strong>resetPassword(data, [callback])</strong></td>
    </tr>
    <tr>
      <td>getRoles</td>
      <td><strong>getRoles([callback])</strong></td>
    </tr>
    <tr>
      <td>getRole</td>
      <td><strong>getRole(id, [callback])</strong></td>
    </tr>
    <tr>
      <td>setRole</td>
      <td><strong>setRole(id, roleId, [callback])</strong></td>
    </tr>
  </tbody>
</table>

<h4 id="objects">Objects</h4>

<table>
  <thead>
    <tr>
      <th><a href="#objects">Object</a></th>
      <th><code>Stamplay.Object("cobject")</code></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>save</td>
      <td><strong>save(data, [callback])</strong></td>
    </tr>
    <tr>
      <td>get</td>
      <td><strong>get(data, [callback])</strong></td>
    </tr>
    <tr>
      <td>getById</td>
      <td><strong>getById(id, data, [callback])</strong></td>
    </tr>
    <tr>
      <td>remove</td>
      <td><strong>remove(id, [callback])</strong></td>
    </tr>
    <tr>
      <td>update</td>
      <td><strong>update(id, data, [callback])</strong></td>
    </tr>
    <tr>
      <td>patch</td>
      <td><strong>patch(id, data, [callback])</strong></td>
    </tr>
    <tr>
      <td>findByCurrentUser</td>
      <td><strong>findByCurrentUser([attr], [callback])</strong></td>
    </tr>
    <tr>
      <td>upVote</td>
      <td><strong>upVote(id, [callback])</strong></td>
    </tr>
    <tr>
      <td>downVote</td>
      <td><strong>downVote(id, [callback])</strong></td>
    </tr>
    <tr>
      <td>rate</td>
      <td><strong>rate(id, rate, [callback])</strong></td>
    </tr>
    <tr>
      <td>comment</td>
      <td><strong>comment(id, text, [callback])</strong></td>
    </tr>
    <tr>
      <td>push</td>
      <td><strong>push(id, attribute, data, [callback])</strong></td>
    </tr>
  </tbody>
</table>

<h4 id="code-blocks">Code Blocks</h4>

<table>
  <thead>
    <tr>
      <th><a href="#code-blocks">Code Block</a></th>
      <th><code>Stamplay.Codeblock("codeblock")</code></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>post</td>
      <td><strong>post( data, queryParams, [callback])</strong></td>
    </tr>
    <tr>
      <td>put</td>
      <td><strong>put( data, queryParams, [callback])</strong></td>
    </tr>
    <tr>
      <td>patch</td>
      <td><strong>patch( data, queryParams, [callback])</strong></td>
    </tr>
    <tr>
      <td>get</td>
      <td><strong>get( queryParams, [callback])</strong></td>
    </tr>
    <tr>
      <td>delete</td>
      <td><strong>delete( queryParams, [callback])</strong></td>
    </tr>
  </tbody>
</table>

<h4 id="webhooks">Webhooks</h4>

<table>
  <thead>
    <tr>
      <th><a href="#webhooks">Webhook</a></th>
      <th><code>Stamplay.Webhook("webhook")</code></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>post</td>
      <td><strong>post(data, [callback])</strong></td>
    </tr>
  </tbody>
</table>

<h4 id="stripe">Stripe</h4>

<table>
  <thead>
    <tr>
      <th><a href="#stripe">Stripe</a></th>
      <th><code>Stamplay.Stripe</code></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>charge</td>
      <td><strong>charge(userId, token, amount, currency, [callback])</strong></td>
    </tr>
    <tr>
      <td>createCreditCard</td>
      <td><strong>createCreditCard(userId, token, [callback])</strong></td>
    </tr>
    <tr>
      <td>createCustomer</td>
      <td><strong>createCustomer(userId, [callback])</strong></td>
    </tr>
    <tr>
      <td>createSubscriptionuserId</td>
      <td><strong>createSubscriptionuserId, planId, [callback])</strong></td>
    </tr>
    <tr>
      <td>deleteSubscription</td>
      <td><strong>deleteSubscription(userId, subscriptionId, options, [callback])</strong></td>
    </tr>
    <tr>
      <td>getCreditCard</td>
      <td><strong>getCreditCard(userId, [callback])</strong></td>
    </tr>
    <tr>
      <td>getSubscription</td>
      <td><strong>getSubscription(userId, subscriptionId, [callback])</strong></td>
    </tr>
    <tr>
      <td>getSubscriptions</td>
      <td><strong>getSubscriptions(userId, options, [callback])</strong></td>
    </tr>
    <tr>
      <td>updateCreditCard</td>
      <td><strong>updateCreditCard(userId, token, [callback])</strong></td>
    </tr>
    <tr>
      <td>updateSubscription</td>
      <td><strong>updateSubscription(userId, subscriptionId, options, [callback])</strong></td>
    </tr>
  </tbody>
</table>

<h4 id="queries">Queries</h4>

<table>
  <thead>
    <tr>
      <th><a href="#query">Query</a></th>
      <th><code>Stamplay.Query("type", "resource")</code></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>greaterThan</td>
      <td><strong>greaterThan(attr, value)</strong></td>
    </tr>
    <tr>
      <td>greaterThanOrEqual</td>
      <td><strong>greaterThanOrEqual(attr, value)</strong></td>
    </tr>
    <tr>
      <td>lessThan</td>
      <td><strong>lessThan(attr, value)</strong></td>
    </tr>
    <tr>
      <td>lessThanOrEqual</td>
      <td><strong>lessThanOrEqual(attr, value)</strong></td>
    </tr>
    <tr>
      <td>pagination</td>
      <td><strong>pagination(page, per_page)</strong></td>
    </tr>
    <tr>
      <td>between</td>
      <td><strong>between(attr, value1, value2)</strong></td>
    </tr>
    <tr>
      <td>equalTo</td>
      <td><strong>equalTo(attr, value)</strong></td>
    </tr>
    <tr>
      <td>notEqualTo</td>
      <td><strong>notEqualTo(attr, value)</strong></td>
    </tr>
    <tr>
      <td>exists</td>
      <td><strong>exists(attr)</strong></td>
    </tr>
    <tr>
      <td>notExists</td>
      <td><strong>notExists(attr)</strong></td>
    </tr>
    <tr>
      <td>sortAscending</td>
      <td><strong>sortAscending(attr)</strong></td>
    </tr>
    <tr>
      <td>sortDescending</td>
      <td><strong>sortDescending(attr)</strong></td>
    </tr>
    <tr>
      <td>populate</td>
      <td><strong>populate()</strong></td>
    </tr>
    <tr>
      <td>populateOwner</td>
      <td><strong>populateOwner()</strong></td>
    </tr>
    <tr>
      <td>select</td>
      <td><strong>select(attr,…)</strong></td>
    </tr>
    <tr>
      <td>regex</td>
      <td><strong>regex(attr, regex, options)</strong></td>
    </tr>
    <tr>
      <td>near</td>
      <td><strong>near(type, coordinates, maxDistance, minDistance)</strong></td>
    </tr>
    <tr>
      <td>nearSphere</td>
      <td><strong>nearSphere(type, coordinates, maxDistance, minDistance)</strong></td>
    </tr>
    <tr>
      <td>geoIntersects</td>
      <td><strong>geoIntersects(type, coordinates)</strong></td>
    </tr>
    <tr>
      <td>geoWithinGeometry</td>
      <td><strong>geoWithinGeometry(type, coordinates)</strong></td>
    </tr>
    <tr>
      <td>geoWithinCenterSphere</td>
      <td><strong>geoWithinCenterSphere(coordinates, radius)</strong></td>
    </tr>
    <tr>
      <td>or</td>
      <td><strong>or(query,..)</strong></td>
    </tr>
    <tr>
      <td>exec</td>
      <td><strong>exec([callback])</strong></td>
    </tr>
  </tbody>
</table>

<h2 id="nodejs-sdk">NodeJS SDK</h2>

<pre class="highlight shell-always"><code>  <span class="nx">npm</span> <span class="nx">install</span> <span class="nx">stamplay</span>
</code></pre>

<pre class="highlight shell-always"><code>  <span class="kd">var</span> <span class="nx">stamplay</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s2">"stamplay"</span><span class="p">),</span>
  <span class="nx">Stamplay</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">stamplay</span><span class="p">(</span><span class="s2">"APP ID"</span><span class="p">,</span> <span class="s2">"API KEY"</span><span class="p">)</span>

</code></pre>

<p>The Node.js SDK is a server side library to help simplify admin interaction with the Stamplay API.</p>

<p>To install the Node.js SDK, run <code>npm install</code> for the <code>stamplay</code>.</p>

<p>To initialize the SDK within your server side enviornment, first <code>require</code> the module, then create a new instance of the module require and pass in your <code>APP ID</code> and <code>API KEY</code> credentials as seperate arguments.</p>

<p>Our <a href="https://github.com/Stamplay/stamplay-nodejs-sdk">Node.js SDK is open source on Github</a>!</p>

<h3 id="nodejs-api-reference">Node.js API Reference</h3>

<p>The JavaScript SDK exposes the following components and methods:</p>

<h4 id="users-1">Users</h4>

<table>
  <thead>
    <tr>
      <th><a href="#users">User</a></th>
      <th><code>Stamplay.User</code></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>save</td>
      <td><strong>save(data, [callback])</strong></td>
    </tr>
    <tr>
      <td>get</td>
      <td><strong>get(data, [callback])</strong></td>
    </tr>
    <tr>
      <td>remove</td>
      <td><strong>remove(id, [callback])</strong></td>
    </tr>
    <tr>
      <td>update</td>
      <td><strong>update(id, data, [callback] )</strong></td>
    </tr>
  </tbody>
</table>

<h4 id="objects-1">Objects</h4>

<table>
  <thead>
    <tr>
      <th><a href="#objects">Object</a></th>
      <th><code>Stamplay.Object("cobject")</code></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>save</td>
      <td><strong>save(data, [callback])</strong></td>
    </tr>
    <tr>
      <td>get</td>
      <td><strong>get(data, [callback])</strong></td>
    </tr>
    <tr>
      <td>remove</td>
      <td><strong>remove(id, [callback])</strong></td>
    </tr>
    <tr>
      <td>update</td>
      <td><strong>update(id, data, [callback])</strong></td>
    </tr>
    <tr>
      <td>patch</td>
      <td><strong>patch(id, data, [callback])</strong></td>
    </tr>
    <tr>
      <td>upVote</td>
      <td><strong>upVote(id, [callback])</strong></td>
    </tr>
    <tr>
      <td>downVote</td>
      <td><strong>downVote(id, [callback])</strong></td>
    </tr>
    <tr>
      <td>rate</td>
      <td><strong>rate(id, rate, [callback])</strong></td>
    </tr>
    <tr>
      <td>comment</td>
      <td><strong>comment(id, text, [callback])</strong></td>
    </tr>
    <tr>
      <td>push</td>
      <td><strong>push(id, attribute, data, [callback])</strong></td>
    </tr>
  </tbody>
</table>

<h4 id="code-blocks-1">Code Blocks</h4>

<table>
  <thead>
    <tr>
      <th><a href="#code-blocks">Code Block</a></th>
      <th><code>Stamplay.Codeblock("codeblock")</code></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>run</td>
      <td><strong>run(data, queryParams, [callback])</strong></td>
    </tr>
  </tbody>
</table>

<h4 id="webhooks-1">Webhooks</h4>

<table>
  <thead>
    <tr>
      <th><a href="#webhooks">Webhook</a></th>
      <th><code>Stamplay.Webhook("webhook")</code></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>post</td>
      <td><strong>post(data, [callback])</strong></td>
    </tr>
  </tbody>
</table>

<h4 id="stripe-1">Stripe</h4>

<table>
  <thead>
    <tr>
      <th><a href="#stripe">Stripe</a></th>
      <th><code>Stamplay.Stripe</code></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>createSubscriptionuserId</td>
      <td><strong>createSubscriptionuserId, planId, [callback])</strong></td>
    </tr>
    <tr>
      <td>deleteSubscription</td>
      <td><strong>deleteSubscription(userId, subscriptionId, options, [callback])</strong></td>
    </tr>
    <tr>
      <td>getSubscription</td>
      <td><strong>getSubscription(userId, subscriptionId, [callback])</strong></td>
    </tr>
    <tr>
      <td>getSubscriptions</td>
      <td><strong>getSubscriptions(userId, options, [callback])</strong></td>
    </tr>
    <tr>
      <td>updateSubscription</td>
      <td><strong>updateSubscription(userId, subscriptionId, options, [callback])</strong></td>
    </tr>
  </tbody>
</table>

<h4 id="queries-1">Queries</h4>

<table>
  <thead>
    <tr>
      <th><a href="#advanced-queries">Query</a></th>
      <th><code>Stamplay.Query("type", "resource")</code></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>greaterThan</td>
      <td><strong>greaterThan(attr, value)</strong></td>
    </tr>
    <tr>
      <td>greaterThanOrEqual</td>
      <td><strong>greaterThanOrEqual(attr, value)</strong></td>
    </tr>
    <tr>
      <td>lessThan</td>
      <td><strong>lessThan(attr, value)</strong></td>
    </tr>
    <tr>
      <td>lessThanOrEqual</td>
      <td><strong>lessThanOrEqual(attr, value)</strong></td>
    </tr>
    <tr>
      <td>pagination</td>
      <td><strong>pagination(page, per_page)</strong></td>
    </tr>
    <tr>
      <td>between</td>
      <td><strong>between(attr, value1, value2)</strong></td>
    </tr>
    <tr>
      <td>equalTo</td>
      <td><strong>equalTo(attr, value)</strong></td>
    </tr>
    <tr>
      <td>notEqualTo</td>
      <td><strong>notEqualTo(attr, value)</strong></td>
    </tr>
    <tr>
      <td>exists</td>
      <td><strong>exists(attr)</strong></td>
    </tr>
    <tr>
      <td>notExists</td>
      <td><strong>notExists(attr)</strong></td>
    </tr>
    <tr>
      <td>sortAscending</td>
      <td><strong>sortAscending(attr)</strong></td>
    </tr>
    <tr>
      <td>sortDescending</td>
      <td><strong>sortDescending(attr)</strong></td>
    </tr>
    <tr>
      <td>populate</td>
      <td><strong>populate()</strong></td>
    </tr>
    <tr>
      <td>populateOwner</td>
      <td><strong>populateOwner()</strong></td>
    </tr>
    <tr>
      <td>select</td>
      <td><strong>select(attr,…)</strong></td>
    </tr>
    <tr>
      <td>regex</td>
      <td><strong>regex(attr, regex, options)</strong></td>
    </tr>
    <tr>
      <td>near</td>
      <td><strong>near(type, coordinates, maxDistance, minDistance)</strong></td>
    </tr>
    <tr>
      <td>nearSphere</td>
      <td><strong>nearSphere(type, coordinates, maxDistance, minDistance)</strong></td>
    </tr>
    <tr>
      <td>geoIntersects</td>
      <td><strong>geoIntersects(type, coordinates)</strong></td>
    </tr>
    <tr>
      <td>geoWithinGeometry</td>
      <td><strong>geoWithinGeometry(type, coordinates)</strong></td>
    </tr>
    <tr>
      <td>geoWithinCenterSphere</td>
      <td><strong>geoWithinCenterSphere(coordinates, radius)</strong></td>
    </tr>
    <tr>
      <td>or</td>
      <td><strong>or(query,..)</strong></td>
    </tr>
    <tr>
      <td>exec</td>
      <td><strong>exec([callback])</strong></td>
    </tr>
  </tbody>
</table>

          <h1 id="users">Users</h1>

<p>The base user data structure:</p>

<table>
  <thead>
    <tr>
      <th>Property</th>
      <th>Summary</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>_id</td>
      <td>a unique identifier</td>
    </tr>
    <tr>
      <td>displayName</td>
      <td>the user's displayName</td>
    </tr>
    <tr>
      <td>name</td>
      <td>the user's name</td>
    </tr>
    <tr>
      <td>email</td>
      <td>the user's email</td>
    </tr>
    <tr>
      <td>identities</td>
      <td>an object that contains social informations provided by the third party authentication services</td>
    </tr>
    <tr>
      <td>dt_create</td>
      <td>a date that represent the user's signup date</td>
    </tr>
    <tr>
      <td>dt_update</td>
      <td>a date that represent the last time the user has been updated</td>
    </tr>
    <tr>
      <td>givenRole</td>
      <td>the role'sunique id</td>
    </tr>
  </tbody>
</table>

<p>The User data collection is schemaless, meaning that properties can be added on the go without adding them to a defined schema with specific property data types.</p>

<h2 id="local-authentication">Local Authentication</h2>

<p>A local authentication flow for login and signups is baked in to every Stamplay application.</p>

<h3 id="signup">Signup</h3>

<pre class="highlight shell"><code>  curl -X <span class="s2">"POST"</span> <span class="s2">"https://APP-ID.stamplayapp.com/api/user/v1/users"</span> <span class="se">\</span>
    -H <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
    -d <span class="s2">"{</span><span class="se">\"</span><span class="s2">email</span><span class="se">\"</span><span class="s2">:</span><span class="se">\"</span><span class="s2">user@stamplay.com</span><span class="se">\"</span><span class="s2">,</span><span class="se">\"</span><span class="s2">password</span><span class="se">\"</span><span class="s2">:</span><span class="se">\"</span><span class="s2">my_password</span><span class="se">\"</span><span class="s2">}"</span>
</code></pre>

<pre class="highlight javascript"><code>  <span class="kd">var</span> <span class="nx">credentials</span> <span class="o">=</span> <span class="p">{</span>
    <span class="na">email</span> <span class="p">:</span> <span class="s2">"user@stamplay.com"</span><span class="p">,</span>
    <span class="na">password</span> <span class="p">:</span> <span class="s2">"my_password"</span>
  <span class="p">}</span>

  <span class="nx">Stamplay</span><span class="p">.</span><span class="nx">User</span><span class="p">.</span><span class="nx">signup</span><span class="p">(</span><span class="nx">credentials</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">res</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// success</span>
    <span class="p">},</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// error  </span>
    <span class="p">})</span>
</code></pre>

<pre class="highlight nodejs"><code>  <span class="kd">var</span> <span class="nx">credentials</span> <span class="o">=</span> <span class="p">{</span>
    <span class="na">email</span> <span class="p">:</span> <span class="s2">"user@stamplay.com"</span><span class="p">,</span>
    <span class="na">password</span> <span class="p">:</span> <span class="s2">"my_password"</span>
  <span class="p">}</span>

  <span class="nx">Stamplay</span><span class="p">.</span><span class="nx">User</span><span class="p">.</span><span class="nx">save</span><span class="p">(</span><span class="nx">credentials</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">res</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// response</span>
  <span class="p">})</span>
</code></pre>

<blockquote>
  <p>The JSON response looks like.</p>
</blockquote>

<pre class="highlight json"><code><span class="w">
</span><span class="p">{</span><span class="w">
  </span><span class="nt">"__v"</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="w">
  </span><span class="nt">"email"</span><span class="p">:</span><span class="s2">"user@stamplay.com"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"password"</span><span class="p">:</span><span class="s2">"$2a$12$ERoo1bSRttQm9zLRkJIpnO9tgjtTnFRUt/57R.gLhnJor1RYkzUBS"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"givenRole"</span><span class="p">:</span><span class="s2">"561c001ce57bdca90ee4482b"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"appId"</span><span class="p">:</span><span class="s2">"stamplaykb"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"_id"</span><span class="p">:</span><span class="s2">"570eca8ec0d4b16b26a4bbe0"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"dt_update"</span><span class="p">:</span><span class="s2">"2016-04-13T22:39:10.621Z"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"dt_create"</span><span class="p">:</span><span class="s2">"2016-04-13T22:39:10.621Z"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"emailVerified"</span><span class="p">:</span><span class="kc">true</span><span class="p">,</span><span class="w">
  </span><span class="nt">"verificationCode"</span><span class="p">:</span><span class="s2">"98175bf31b80f59e2956"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"profileImg"</span><span class="p">:</span><span class="s2">""</span><span class="p">,</span><span class="w">
  </span><span class="nt">"id"</span><span class="p">:</span><span class="s2">"570eca8ec0d4b16b26a4bbe0"</span><span class="w">
</span><span class="p">}</span><span class="w">

</span></code></pre>

<p>Sign up a user for a local user account.</p>

<table>
  <thead>
    <tr>
      <th>Attribute</th>
      <th> </th>
      <th style="text-align: center">Optional</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>email</code></td>
      <td>a valid email address</td>
      <td style="text-align: center"><i class="unchecked"></i></td>
    </tr>
    <tr>
      <td><code>password</code></td>
      <td>user provided secret</td>
      <td style="text-align: center"><i class="unchecked"></i></td>
    </tr>
  </tbody>
</table>

<h3 id="login">Login</h3>

<pre class="highlight shell"><code>  curl -X <span class="s2">"POST"</span> <span class="s2">"https://APP-ID.stamplayapp.com/auth/v1/local/login"</span> <span class="se">\</span>
    -H <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
    -d <span class="s2">"{</span><span class="se">\"</span><span class="s2">email</span><span class="se">\"</span><span class="s2">:</span><span class="se">\"</span><span class="s2">user@stamplay.com</span><span class="se">\"</span><span class="s2">,</span><span class="se">\"</span><span class="s2">password</span><span class="se">\"</span><span class="s2">:</span><span class="se">\"</span><span class="s2">my_password</span><span class="se">\"</span><span class="s2">}"</span>
</code></pre>

<pre class="highlight javascript"><code>  <span class="kd">var</span> <span class="nx">credentials</span> <span class="o">=</span> <span class="p">{</span>
    <span class="na">email</span> <span class="p">:</span> <span class="s2">"user@stamplay.com"</span><span class="p">,</span>
    <span class="na">password</span> <span class="p">:</span> <span class="s2">"my_password"</span>
  <span class="p">}</span>

  <span class="nx">Stamplay</span><span class="p">.</span><span class="nx">User</span><span class="p">.</span><span class="nx">login</span><span class="p">(</span><span class="nx">credentials</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">res</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// success</span>
    <span class="p">},</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// error  </span>
    <span class="p">})</span>
</code></pre>

<pre class="highlight nodejs"><code>  <span class="c1">// no method</span>
</code></pre>

<blockquote>
  <p>The JSON response looks like.</p>
</blockquote>

<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"_id"</span><span class="p">:</span><span class="s2">"570eca8ec0d4b16b26a4bbe0"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"email"</span><span class="p">:</span><span class="s2">"user@stamplay.com"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"password"</span><span class="p">:</span><span class="s2">"$2a$12$ERoo1bSRttQm9zLRkJIpnO9tgjtTnFRUt/57R.gLhnJor1RYkzUBS"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"givenRole"</span><span class="p">:</span><span class="s2">"561c001ce57bdca90ee4482b"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"appId"</span><span class="p">:</span><span class="s2">"stamplaykb"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"__v"</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="w">
  </span><span class="nt">"username"</span><span class="p">:</span><span class="s2">""</span><span class="p">,</span><span class="w">
  </span><span class="nt">"displayName"</span><span class="p">:</span><span class="s2">""</span><span class="p">,</span><span class="w">
  </span><span class="nt">"dt_update"</span><span class="p">:</span><span class="s2">"2016-04-13T22:39:10.893Z"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"dt_create"</span><span class="p">:</span><span class="s2">"2016-04-13T22:39:10.621Z"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"emailVerified"</span><span class="p">:</span><span class="kc">true</span><span class="p">,</span><span class="w">
  </span><span class="nt">"verificationCode"</span><span class="p">:</span><span class="s2">"98175bf31b80f59e2956"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"profileImg"</span><span class="p">:</span><span class="s2">""</span><span class="p">,</span><span class="w">
  </span><span class="nt">"id"</span><span class="p">:</span><span class="s2">"570eca8ec0d4b16b26a4bbe0"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>Login a user to a local account.</p>

<table>
  <thead>
    <tr>
      <th>Attribute</th>
      <th> </th>
      <th style="text-align: center">Optional</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>email</code></td>
      <td>a valid email address</td>
      <td style="text-align: center"><i class="unchecked"></i></td>
    </tr>
    <tr>
      <td><code>password</code></td>
      <td>user provided secret</td>
      <td style="text-align: center"><i class="unchecked"></i></td>
    </tr>
  </tbody>
</table>

<h2 id="social-authentication">Social Authentication</h2>

<pre class="highlight shell"><code>  curl -X <span class="s2">"GET"</span> <span class="s2">"https://APP-ID.stamplayapp.com/auth/v1/:provider/connect"</span>
</code></pre>

<pre class="highlight javascript"><code>  <span class="nx">Stamplay</span><span class="p">.</span><span class="nx">User</span><span class="p">.</span><span class="nx">socialLogin</span><span class="p">(</span><span class="s2">"provider"</span><span class="p">)</span>
</code></pre>

<pre class="highlight nodejs"><code>  <span class="c1">// no method</span>
</code></pre>

<blockquote>
  <p>Response is a redirect, as specified in the Authentication section, on social login success.</p>
</blockquote>

<p>Authentication via an array of different social provider is possibled by some minor configuration with the Stamplay editor, and a simple request to the Stamplay API.</p>

<table>
  <thead>
    <tr>
      <th>Attribute</th>
      <th> </th>
      <th style="text-align: center">Optional</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>provider</code></td>
      <td>the slug identifier of the social provider</td>
      <td style="text-align: center"><i class="unchecked"></i></td>
    </tr>
  </tbody>
</table>

<h3 id="ionic-integration">Ionic Integration</h3>

<pre class="highlight shell-always"><code>  <span class="nx">Stamplay</span><span class="p">.</span><span class="nx">init</span><span class="p">(</span><span class="s2">"APP-ID"</span><span class="p">,</span> <span class="p">{</span>
    <span class="na">isMobile</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
    <span class="na">absoluteUrl</span> <span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
    <span class="na">autorefreshSocialLogin</span> <span class="p">:</span> <span class="kc">false</span>
  <span class="p">})</span>
</code></pre>

<p>Login users with social accounts inside an Ionic mobile application.</p>

<p>To use a social provider within an Ionic application, you must pass in an additonal options object in the <code>Stamplay.init</code> method when intializing the SDK.</p>

<table>
  <thead>
    <tr>
      <th>Attribute</th>
      <th> </th>
      <th style="text-align: center">Optional</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>isMobile</code></td>
      <td>manages the login/signup behavior for hybrid environments like Ionic, if true opens auth dialog in new window.</td>
      <td style="text-align: center"><i class="unchecked"></i></td>
    </tr>
    <tr>
      <td><code>absoluteUrl</code></td>
      <td>force the path to be absolute</td>
      <td style="text-align: center"><i class="unchecked"></i></td>
    </tr>
    <tr>
      <td><code>autorefreshSocialLogin</code></td>
      <td>refresh application after a successful socialLogin</td>
      <td style="text-align: center"><i class="checked"></i></td>
    </tr>
  </tbody>
</table>

<h3 id="facebook">Facebook</h3>

<pre class="highlight shell"><code>  curl -X <span class="s2">"GET"</span> <span class="s2">"https://APP-ID.stamplayapp.com/auth/v1/facebook/connect"</span>
</code></pre>

<pre class="highlight javascript"><code>  <span class="nx">Stamplay</span><span class="p">.</span><span class="nx">User</span><span class="p">.</span><span class="nx">socialLogin</span><span class="p">(</span><span class="s2">"facebook"</span><span class="p">)</span>
</code></pre>

<pre class="highlight nodejs"><code>  <span class="c1">// no method</span>
</code></pre>

<p>Login a user with a Facebook account.</p>

<hr />

<p><strong>Create a Facebook App</strong></p>

<p>1.1. Go to Facebook developers.</p>

<p><strong>1.2.</strong> In the upper right corner, click on <strong>Add a New App</strong>.</p>

<p><strong>1.3.</strong> Choose the type of app you want to create.</p>

<p><strong>1.4.</strong> Name your Facebook App and select <strong>Create Facebook App Id</strong>.</p>

<p><strong>1.5.</strong> Skip the Quick Start by clicking on the button in the upper right corner.</p>

<hr />

<p><strong>Configure the Facebook App Settings</strong></p>

<p><strong>2.1.</strong> Click on <strong>Settings</strong> in the left menu.</p>

<p><strong>2.2.</strong> Click on <strong>+ Add Platform</strong>.</p>

<p><strong>2.3.</strong> Fill the <strong>Site Url</strong> field with your Stamplay domain: <a href="https://APP-ID.stamplayapp.com">https://APP-ID.stamplayapp.com</a> (and/or your custom domain if you have a paid plan).</p>

<p><strong>2.4.</strong> From the <strong>Settings</strong> view click on the <strong>Advanced</strong> tab and type in the <strong>OAuth Redirect URIs</strong> the following: <a href="https://APP-ID.stamplayapp.com/auth/v1/facebook/callback">https://APP-ID.stamplayapp.com/auth/v1/facebook/callback</a> and <a href="https://localhost:8080/auth/v1/facebook/callback">https://localhost:8080/auth/v1/facebook/callback</a> so that you can also test the signup flow locally when using Stamplay Command Line.</p>

<hr />

<p><strong>Add the Facebook Integration to Stamplay</strong></p>

<p><strong>3.1.</strong> Copy the <code>App Id</code> and <code>App Secret</code> from the Facebook App and add the values to the corresponding field inside the Stamplay editor in the <strong>Users</strong> - <strong>Authentication</strong> section.</p>

<p><strong>3.2.</strong> To test the social login integration, copy and paste this link with your <code>APP ID</code> into a browser: <a href="https://APP-ID.stamplayapp.com/auth/v1/facebook/connect">https://APP-ID.stamplayapp.com/auth/v1/facebook/connect</a>. After connecting your account, check the <strong>DATA</strong> section to inspect the new User record created.</p>

<p><strong>3.3.</strong> The steps covered in this guide are not enough to have a Facebook app approved for production. You need to provide other information and submit the app for review; the process can take many days to complete. Refer to Facebook documentation for more information.</p>

<p>Stamplay asks for the following permissions:</p>

<ul>
  <li><code>public_profile</code></li>
  <li><code>email</code></li>
  <li><code>user_friends</code></li>
</ul>

<p>We store data from <code>public_profile</code> and <code>email</code>. Refer to the Facebook documentation for more information.</p>

<h3 id="google">Google+</h3>

<pre class="highlight shell"><code>  curl -X <span class="s2">"GET"</span> <span class="s2">"https://APP-ID.stamplayapp.com/auth/v1/google/connect"</span>
</code></pre>

<pre class="highlight javascript"><code>  <span class="nx">Stamplay</span><span class="p">.</span><span class="nx">User</span><span class="p">.</span><span class="nx">socialLogin</span><span class="p">(</span><span class="s2">"google"</span><span class="p">)</span>
</code></pre>

<pre class="highlight nodejs"><code>  <span class="c1">// no method</span>
</code></pre>

<p>Login a user with a Google+ account.</p>

<hr />

<p><strong>Create a Google Client Id</strong></p>

<p><strong>1.1.</strong> Go to <a href="https://code.google.com/apis/console">https://code.google.com/apis/console</a> and create an APIs project.</p>

<p><strong>1.2.</strong> Click on <strong>Credentials</strong> from the <strong>API &amp; Auth</strong> section of the left menu.</p>

<p><strong>1.3.</strong> Click on <strong>Create new Client Id</strong> button.</p>

<hr />

<p><strong>Configure the Client ID</strong></p>

<p><strong>2.1.</strong> Choose the type <strong>Web application</strong> and click on <strong>Configure Consent Screen</strong> button.</p>

<p><strong>2.2.</strong> Add the required information to the consent screen and save.</p>

<p><strong>2.3.</strong> Fill in the <strong>Authorized Javascripts Origins</strong> field with your Stamplay 
  domain: <a href="https://APP-ID.stamplayapp.com">https://APP-ID.stamplayapp.com</a> (and/or your custom domain if you have a paid plan).</p>

<p><strong>2.4.</strong> Fill in the <strong>Authorized Redirect URIs</strong> field with the following value: <a href="https://APP-ID.stamplayapp.com/auth/v1/google/callback">https://APP-ID.stamplayapp.com/auth/v1/google/callback</a>.</p>

<p><strong>2.5.</strong> Click on <strong>Create client ID</strong></p>

<hr />

<p><strong>Add the Google+ Integration To Stamplay</strong></p>

<p><strong>3.1.</strong> Copy the <strong>Client Id</strong> and <strong>Client Secret</strong> from the Google App and add the values to the Stamplay app.</p>

<p><strong>3.2.</strong> To quickly test the integration, copy and paste this link into your browser: <a href="https://APP-ID.stamplayapp.com/auth/v1/google/connect">https://APP-ID.stamplayapp.com/auth/v1/google/connect</a>.</p>

<p><strong>3.3.</strong> Then click on <strong>Users</strong> in the left menu of the Editor to browse the data fetched.</p>

<p>Stamplay asks for the following permissions:</p>

<ul>
  <li><code>userinfo.profile</code></li>
  <li><code>userinfo.email</code></li>
</ul>

<p>Refer to the Google documentation for more information.</p>

<h3 id="twitter">Twitter</h3>

<pre class="highlight shell"><code>  curl -X <span class="s2">"GET"</span> <span class="s2">"https://APP-ID.stamplayapp.com/auth/v1/twitter/connect"</span>
</code></pre>

<pre class="highlight javascript"><code>  <span class="nx">Stamplay</span><span class="p">.</span><span class="nx">User</span><span class="p">.</span><span class="nx">socialLogin</span><span class="p">(</span><span class="s2">"twitter"</span><span class="p">)</span>
</code></pre>

<pre class="highlight nodejs"><code>  <span class="c1">// no method</span>
</code></pre>

<p>Login a user with a Twitter account.</p>

<hr />

<p><strong>Create a Twitter app</strong></p>

<p><strong>1.1.</strong> Go to <a href="https://apps.twitter.com/app/new">https://apps.twitter.com/app/new</a> to create a new Twitter app.</p>

<hr />

<p><strong>Configure the app</strong></p>

<p><strong>2.1.</strong> Fill in name and description.</p>

<p><strong>2.2.</strong> Fill in the Website field with your Stamplay domain: <a href="https://APP-ID.stamplayapp.com">https://APP-ID.stamplayapp.com</a> (and/or your custom domain if you have a paid plan).</p>

<p><strong>2.3.</strong> Fill in the Authorized Redirect URIs field with the following value: <a href="https://APP-ID.stamplayapp.com/auth/v1/twitter/callback">https://APP-ID.stamplayapp.com/auth/v1/twitter/callback</a>. Create the Twitter application.</p>

<hr />

<p><strong>Add the Twitter Integration to Stamplay</strong></p>

<p><strong>3.1.</strong> Click on the <strong>Keys and Access Tokens</strong> tab.</p>

<p><strong>3.2.</strong> Copy the <strong>Consumer Key</strong> (API Key) and <strong>Consumer Secret</strong> (API Secret) from the Twitter app and add the values to the Stamplay app.</p>

<p><strong>3.3.</strong> To quickly test the integration, copy and paste this link into your browser: <a href="https://APP-ID.stamplayapp.com/auth/v1/twitter/connect">https://APP-ID.stamplayapp.com/auth/v1/twitter/connect</a>. Then click on <strong>Users</strong> in the left menu of the editor to browse the data fetched.</p>

<p>Stamplay collects all profile data provided.</p>

<p>Twitter does not have scopes, and the user <code>email</code> is not provided. You must request access from Twitter, and be whitelisted to receive user emails.</p>

<p>Please refer to the Twitter documentation for more information.</p>

<h3 id="dropbox">Dropbox</h3>

<pre class="highlight shell"><code>  curl -X <span class="s2">"GET"</span> <span class="s2">"https://APP-ID.stamplayapp.com/auth/v1/dropbox/connect"</span>
</code></pre>

<pre class="highlight javascript"><code>  <span class="nx">Stamplay</span><span class="p">.</span><span class="nx">User</span><span class="p">.</span><span class="nx">socialLogin</span><span class="p">(</span><span class="s2">"dropbox"</span><span class="p">)</span>
</code></pre>

<pre class="highlight nodejs"><code>  <span class="c1">// no method</span>
</code></pre>

<p>Login a user with a Dropbox account.</p>

<hr />

<p><strong>Create a Drop API App</strong></p>

<p><strong>1.1.</strong> Go to <a href="https://www.dropbox.com/developers/apps/create">https://www.dropbox.com/developers/apps/create</a>.</p>

<p><strong>1.2.</strong> Create a Dropbox API app.</p>

<p><strong>1.3.</strong> Choose the values you prefer for the data type and file the app can access (these options are not relevant for login). Name your app.</p>

<hr />

<p><strong>Configure The Dropbox App</strong></p>

<p><strong>2.1.</strong> Fill in the <strong>Redirect URIs</strong> field in the <strong>Oauth2</strong> section with the following value: <a href="https://APP-ID.stamplayapp.com">https://APP-ID.stamplayapp.com</a> (and/or your custom domain if you have a paid plan).</p>

<hr />

<p><strong>Add the Dropbox Integration To Stamplay</strong></p>

<p><strong>3.1.</strong> Copy the <strong>App Key</strong> and <strong>App Secret</strong> from the Dropbox app and add the values to the Stamplay app.</p>

<p><strong>3.2.</strong> To quickly test the integration, copy and paste this link into your browser: <a href="https://APP-ID.stamplayapp.com/auth/v1/dropbox/connect">https://APP-ID.stamplayapp.com/auth/v1/dropbox/connect</a>. Then click on “Users” in the left menu of the Editor to browse the data fetched.</p>

<p><strong>3.3.</strong> You have added Dropbox login to your Stamplay app, but be aware that you must provide Dropbox with a lot of other information to get their approval. Refer to the Dropbox documentation to learn how to have your Dropbox app approved for production. In the mean time, you can continue to develop and test the integration.</p>

<p>Stamplay collects the following data from Dropbox:</p>

<ul>
  <li><code>userinfo.profile</code></li>
</ul>

<p>Refer to the Dropbox documentation for more information.</p>

<h3 id="linkedin">Linkedin</h3>

<pre class="highlight shell"><code>  curl -X <span class="s2">"GET"</span> <span class="s2">"https://APP-ID.stamplayapp.com/auth/v1/linkedin/connect"</span>
</code></pre>

<pre class="highlight javascript"><code>  <span class="nx">Stamplay</span><span class="p">.</span><span class="nx">User</span><span class="p">.</span><span class="nx">socialLogin</span><span class="p">(</span><span class="s2">"linkedin"</span><span class="p">)</span>
</code></pre>

<pre class="highlight nodejs"><code>  <span class="c1">// no method</span>
</code></pre>

<p>Login a user with a LinkedIn account.</p>

<hr />

<p><strong>Create a LinkedIn app</strong></p>

<p><strong>1.1.</strong> Go to <a href="https://www.linkedin.com/secure/developer">https://www.linkedin.com/secure/developer</a> and click on “Add a new application”.</p>

<hr />

<p><strong>Configure the app</strong></p>

<p><strong>2.1.</strong> Fill in all the required data.</p>

<p><strong>2.2.</strong> Fill in the OAuth <strong>redirect_uri</strong> field with the following value: <a href="https://APP-ID.stamplayapp.com/auth/v1/linkedin/callback">https://APP-ID.stamplayapp.com/auth/v1/linkedin/callback</a>.</p>

<p><strong>2.3.</strong> Click the “Add application” button.</p>

<hr />

<p><strong>Add the LinkedIn Integration to Stamplay</strong></p>

<p><strong>3.1.</strong> Copy the <strong>API Key</strong> and <strong>Secret Key</strong> from the LinkedIn app and add the values to the Stamplay app.</p>

<p><strong>3.2.</strong> Click on the “End” button.</p>

<p><strong>3.3.</strong> To quickly test the integration, copy and paste this link into your browser: <a href="https://APP-ID.stamplayapp.com/auth/v1/linkedin/connect">https://APP-ID.stamplayapp.com/auth/v1/linkedin/connect</a>. Then click on <strong>Users</strong> in the left menu of the Editor to browse the data fetched.</p>

<p>Stamplay asks for the following permissions:</p>

<ul>
  <li><code>r_basicprofile</code></li>
  <li><code>r_emailaddress</code></li>
  <li><code>r_fullprofile</code></li>
</ul>

<p>We store only data from <code>r_basicprofile and r_emailaddress</code>.</p>

<p>Refer to the Linkedin documentation for more information.</p>

<h3 id="instagram">Instagram</h3>

<p>Login a user with a Instagram account.</p>

<pre class="highlight shell"><code>  curl -X <span class="s2">"GET"</span> <span class="s2">"https://APP-ID.stamplayapp.com/auth/v1/instagram/connect"</span>
</code></pre>

<pre class="highlight javascript"><code>  <span class="nx">Stamplay</span><span class="p">.</span><span class="nx">User</span><span class="p">.</span><span class="nx">socialLogin</span><span class="p">(</span><span class="s2">"instagram"</span><span class="p">)</span>
</code></pre>

<pre class="highlight nodejs"><code>  <span class="c1">// no method</span>
</code></pre>

<hr />

<p><strong>Create an Instagram App</strong></p>

<p><strong>1.1.</strong> Go to <a href="https://instagram.com/developer/clients/manage">https://instagram.com/developer/clients/manage</a>.</p>

<p><strong>1.2.</strong> Click on <strong>Manage Client</strong> in the menu bar.</p>

<p><strong>1.3.</strong> Click on <strong>Register a new Client ID</strong>.</p>

<hr />

<p><strong>Configure the App</strong></p>

<p><strong>2.1.</strong> Fill in the required fields.</p>

<p><strong>2.2.</strong> Fill in the <strong>Website</strong> field with your Stamplay domain: <a href="https://APP-ID.stamplayapp.com">https://APP-ID.stamplayapp.com</a> (and/or your custom domain if you have a paid plan).</p>

<p><strong>2.3.</strong> Fill in the OAuth <strong>redirect_uri</strong> field with the following value: <a href="https://APP-ID.stamplayapp.com/auth/v1/instagram/callback">https://APP-ID.stamplayapp.com/auth/v1/instagram/callback</a>.</p>

<hr />

<p><strong>Add the Instagram Integration to Stamplay</strong></p>

<p><strong>3.1.</strong> Copy the <strong>Client Id</strong> and <strong>Client Secret</strong> from the Instagram client and add the values to the Stamplay app.</p>

<p><strong>3.2.</strong> To quickly test the integration, copy and paste this link into your browser: <a href="https://APP-ID.stamplayapp.com/auth/v1/instagram/connect">https://APP-ID.stamplayapp.com/auth/v1/instagram/connect</a>. Then click on <strong>Users</strong> in the left menu of the Editor to browse the data fetched.</p>

<p>Stamplay asks for the following permissions:</p>

<ul>
  <li><code>basic</code></li>
</ul>

<p>We store only data from <code>basic</code>.</p>

<p>Refer to the Instagram documentation for more information.</p>

<h3 id="github">Github</h3>

<p>Login a user with a Github account.</p>

<pre class="highlight shell"><code>  curl -X <span class="s2">"GET"</span> <span class="s2">"https://APP-ID.stamplayapp.com/auth/v1/github/connect"</span>
</code></pre>

<pre class="highlight javascript"><code>  <span class="nx">Stamplay</span><span class="p">.</span><span class="nx">User</span><span class="p">.</span><span class="nx">socialLogin</span><span class="p">(</span><span class="s2">"github"</span><span class="p">)</span>
</code></pre>

<pre class="highlight nodejs"><code>  <span class="c1">// no method</span>
</code></pre>

<hr />

<p><strong>Create a Github App</strong></p>

<p><strong>1.1.</strong> Go to <a href="https://github.com/settings/profile">https://github.com/settings/profile</a>.</p>

<p><strong>1.2</strong> Click on <strong>Applications</strong> in the left menu.</p>

<p><strong>1.3.</strong> Click on <strong>Register new application</strong> button.</p>

<hr />

<p><strong>Configure the app</strong></p>

<p><strong>2.1.</strong> Fill in all the required fields.</p>

<p><strong>2.2.</strong> Fill in the <strong>Homepage URL</strong> field with your Stamplay domain: <a href="https://APP-ID.stamplayapp.com">https://APP-ID.stamplayapp.com</a> (and/or your custom domain if you have a paid plan).</p>

<p><strong>2.3.</strong> Fill the <strong>Authorization Callback URL</strong> field with the following value: <a href="https://APP-ID.stamplayapp.com/auth/v1/github/callback">https://APP-ID.stamplayapp.com/auth/v1/github/callback</a>.</p>

<hr />

<p><strong>Add the Github Integration to Stamplay</strong></p>

<p><strong>3.1.</strong> Copy the <strong>Client ID</strong> and <strong>Client Secret</strong> from the Github app and add the values to the Stamplay app.</p>

<p><strong>3.2.</strong> To quickly test the integration, copy and paste this link into your browser: <a href="https://APP-ID.stamplayapp.com/auth/v1/github/connect">https://APP-ID.stamplayapp.com/auth/v1/github/connect</a>. Then click on <strong>Users</strong> in the left menu of the Editor to browse the data fetched.</p>

<p>Stamplay requests access to public information. We store all public data.</p>

<p>Refer to the Github documentation for more information.</p>

<h3 id="angellist">Angellist</h3>

<p>Login a user with an Angellist account.</p>

<pre class="highlight shell"><code>  curl -X <span class="s2">"GET"</span> <span class="s2">"https://APP-ID.stamplayapp.com/auth/v1/angellist/connect"</span>
</code></pre>

<pre class="highlight javascript"><code>  <span class="nx">Stamplay</span><span class="p">.</span><span class="nx">User</span><span class="p">.</span><span class="nx">socialLogin</span><span class="p">(</span><span class="s2">"angellist"</span><span class="p">)</span>
</code></pre>

<pre class="highlight nodejs"><code>  <span class="c1">// no method</span>
</code></pre>

<hr />

<p><strong>Create an Angel List App</strong></p>

<p><strong>1.1.</strong> Go to <a href="https://angel.co/api/oauth/clients">https://angel.co/api/oauth/clients</a>.</p>

<hr />

<p><strong>Configure the App</strong></p>

<p><strong>2.1.</strong> Name your app.</p>

<p><strong>2.2.</strong> Fill in the <strong>Main URL</strong> field with your Stamplay domain: <a href="https://APP-ID.stamplayapp.com">https://APP-ID.stamplayapp.com</a> (and/or your custom domain if you have a paid plan).</p>

<p><strong>2.3.</strong> Fill in the field Callback URL with the following value: <a href="https://APP-ID.stamplayapp.com/auth/v1/angellist/callback">https://APP-ID.stamplayapp.com/auth/v1/angellist/callback</a>.</p>

<hr />

<p><strong>Add the Angellist Integration to Stamplay</strong></p>

<p><strong>3.1.</strong> Angel List will send you an email with the <strong>Client ID</strong> and <strong>Client Secret</strong>. Add these values to the Stamplay app.</p>

<p><strong>3.2.</strong> To quickly test the integration, copy and paste this link into your browser: <a href="https://APP-ID.stamplayapp.com/auth/v1/angellist/connect">https://APP-ID.stamplayapp.com/auth/v1/angellist/connect</a>. Then click on <strong>Users</strong> in the left menu of the Editor to browse the data fetched.</p>

<p>Stamplay requests permission to access the following:</p>

<ul>
  <li><code>default information</code></li>
  <li><code>email</code></li>
</ul>

<p>We store the default information data and email.</p>

<p>Refer to the Angel List documentation for more information.</p>

<h3 id="slack">Slack</h3>

<p>Login a user with a Slack account.</p>

<pre class="highlight shell"><code>  curl -X <span class="s2">"GET"</span> <span class="s2">"https://APP-ID.stamplayapp.com/auth/v1/slack/connect"</span>
</code></pre>

<pre class="highlight javascript"><code>  <span class="nx">Stamplay</span><span class="p">.</span><span class="nx">User</span><span class="p">.</span><span class="nx">socialLogin</span><span class="p">(</span><span class="s2">"slack"</span><span class="p">)</span>
</code></pre>

<pre class="highlight nodejs"><code>  <span class="c1">// no method</span>
</code></pre>

<hr />

<p><strong>Create an Slack App</strong></p>

<p><strong>1.1.</strong> Go to <a href="https://api.slack.com">https://api.slack.com</a>.</p>

<hr />

<p><strong>Configure the App</strong></p>

<p><strong>2.1.</strong> Name your app.</p>

<p><strong>2.2.</strong> Fill in the field Redirect URL with the following value: <a href="https://APP-ID.stamplayapp.com/auth/v1/slack/callback">https://APP-ID.stamplayapp.com/auth/v1/slack/callback</a>.</p>

<p><strong>2.3</strong> Click on App Credentials to get your Client Id and Client Secret.</p>

<hr />

<p><strong>Add the Slack Integration to Stamplay</strong></p>

<p><strong>3.1</strong> Go to <strong>Users</strong> &gt; <strong>Authentication</strong> &gt; <strong>Slack</strong>. Enter your app credentials and click <strong>Save</strong>.</p>

<p><strong>3.2.</strong> To quickly test the integration, copy and paste this link into your browser: <a href="https://APP-ID.stamplayapp.com/auth/v1/slack/connect">https://APP-ID.stamplayapp.com/auth/v1/slack/connect</a>. Then click on <strong>Users</strong> in the left menu of the Editor to browse the data fetched.</p>

<p>Stamplay requests permission to access the following:</p>

<ul>
  <li><code>access your team's profile information</code></li>
</ul>

<p>We store the default information data and email.</p>

<p>Refer to the Slack API documentation for more information.</p>

<h3 id="auth0">Auth0</h3>

<p>Login a user with Auth0.</p>

<pre class="highlight shell"><code>  curl -X <span class="s2">"GET"</span> <span class="s2">"https://APP-ID.stamplayapp.com/auth/v1/auth0/connect"</span>
</code></pre>

<pre class="highlight javascript"><code>  <span class="nx">Stamplay</span><span class="p">.</span><span class="nx">User</span><span class="p">.</span><span class="nx">socialLogin</span><span class="p">(</span><span class="s2">"auth0"</span><span class="p">)</span>
</code></pre>

<pre class="highlight nodejs"><code>  <span class="c1">// no method</span>
</code></pre>

<hr />

<p><strong>Create an Slack App</strong></p>

<p><strong>1.1.</strong> Go to <a href="https://manage.auth0.com">https://manage.auth0.com</a>.</p>

<hr />

<p><strong>Configure the App</strong></p>

<p><strong>2.1.</strong> Go to <strong>Client</strong> &gt; <strong>+ New Client</strong>.</p>

<p><strong>2.2.</strong> Fill in the field Allowed Callback URLs with the following value: <a href="https://APP-ID.stamplayapp.com/auth/v1/auth0/callback">https://APP-ID.stamplayapp.com/auth/v1/auth0/callback</a>.</p>

<hr />

<p><strong>Add the Auth0 Integration to Stamplay</strong></p>

<p><strong>3.1</strong> Go to <strong>Users</strong> &gt; <strong>Authentication</strong> &gt; <strong>Auth0</strong>. Enter your app credentials and click <strong>Save</strong>.</p>

<p><strong>3.2.</strong> To quickly test the integration, copy and paste this link into your browser: <a href="https://APP-ID.stamplayapp.com/auth/v1/auth0/connect">https://APP-ID.stamplayapp.com/auth/v1/auth0/connect</a>. Then click on <strong>Users</strong> in the left menu of the Editor to browse the data fetched.</p>

<p>Stamplay requests permission to access the following:</p>

<ul>
  <li><code>username</code></li>
  <li><code>password</code></li>
</ul>

<p>We store the default information data and email.</p>

<p>Refer to the Auth0 documentation for more information.</p>

<h2 id="sessions">Sessions</h2>

<pre class="highlight shell-always"><code>  
  <span class="s2">"Authorization"</span> <span class="err">:</span> <span class="s2">"Basic c3RhbXBsYXlrYjo5MTRhMmUzMaMwZWRlMDdmZThhNjYzMzkxMWQyYWQyOTNkNjJkNTQ3OGFiYmViNjEyNzhhYjFjYzE2MDhiZaRi"</span>
</code></pre>

<pre class="highlight shell-always"><code>  <span class="s2">"x-stamplay-jwt"</span> <span class="err">:</span> <span class="s2">"eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ0eXBlIjoidXNlciIsImFwcERvbWFpbiI6InN0YW1wbGF5a2Iuc3RhbXBsYXlscHAuY29tIiwiYXBwSWQiOiJzdGFtcGxheWtiIiwidXNlciI6IjU2ZjAyZDY0NjFkNWI0MTA1ZDFhMjY4NCIsImlhdCI6MTQ1ODU4MTQwNiwiZXhwIjoxNDU5MTg2Mjc4fQ.UDFUe0Zb2ZHx3HXdiUXWnHSyKghVI_harpkkyC3BU8A"</span>
</code></pre>

<p>A session represents an instance of a user logged into a device within a Stamplay application. A session is automatically created when users log in or sign up.</p>

<p>By default user sessions last 7 days.</p>

<p>Stamplay manages session leveraging a <a href="https://jwt.io/">Token-Based Authentication</a> approach. This relies on a signed token that is sent to the server on each request. The implementation is done by generating a token when the user is authenticated and then setting that token in the <code>x-stamplay-jwt</code> header of each subsequent request to our back-end, or as part of the <code>Authorization</code> header from server to server requests.</p>

<p>If you use the <strong>Stamplay Javascript SDK</strong> you do not need to worry about this; but in the case you send request to our APIs without the SDK, this is something you need to be aware of.</p>

<p>If users log in or sign up using an external provider (e.g. <a href="#facebook">Facebook</a>, <a href="#linkedin">Linkedin</a>, <a href="#google+">Google</a>, etc.) the token issued by Stamplay will be available as a query param <code>?jwt</code>. Again, if you are using the SDK, you will not need to manage the token yourself.</p>

<p>If your app let users log in or sign up with the traditional email+password API, tokens will be in the <code>x-stamplay-jwt</code> header of the response.</p>

<p>To check whether or not the token is expired you can do the following:</p>

<ol>
  <li>Split the token in three parts using the <code>.</code> (dot) as the divider.</li>
  <li>Base64 decode of the second chunk.</li>
  <li>Check if the current date (in UNIX timestamp format) is between the "issued at time" date and "expiration" date to check that the token is still valid.</li>
</ol>

<h2 id="reset-password">Reset Password</h2>

<pre class="highlight shell"><code>  curl -X <span class="s2">"POST"</span> <span class="s2">"https://stamplaykb.stamplayapp.com/api/user/v1/users/resetpassword"</span> <span class="se">\</span>
  -H <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
  -d <span class="s1">'{"email":"user@stamplay.com", "newPassword" : "stamplay_rocks!"}'</span>
</code></pre>

<pre class="highlight javascript"><code>  <span class="kd">var</span> <span class="nx">emailAndNewPass</span> <span class="o">=</span> <span class="p">{</span>
    <span class="na">email</span><span class="p">:</span> <span class="s2">"user@stamplay.com"</span><span class="p">,</span>
    <span class="na">newPassword</span><span class="p">:</span> <span class="s2">"stamplay_rocks!"</span>
  <span class="p">}</span>
  <span class="nx">Stamplay</span><span class="p">.</span><span class="nx">User</span><span class="p">.</span><span class="nx">resetPassword</span><span class="p">(</span><span class="nx">emailAndNewPass</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">res</span><span class="p">){</span>
      <span class="c1">// success</span>
    <span class="p">},</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// error</span>
    <span class="p">})</span>
</code></pre>

<blockquote>
  <p>The JSON response looks like.</p>
</blockquote>

<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ok"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>Reset a local user's account password.</p>

<p>Successful submission of a password reset request will send an email to the account holder's email address with a confirmation link that will set the password reset into affect.</p>

<table>
  <thead>
    <tr>
      <th>Attribute</th>
      <th> </th>
      <th style="text-align: center">Optional</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>email</code></td>
      <td>valid email address associated with the account</td>
      <td style="text-align: center"><i class="unchecked"></i></td>
    </tr>
    <tr>
      <td><code>newPassword</code></td>
      <td>new password for the account being reset</td>
      <td style="text-align: center"><i class="unchecked"></i></td>
    </tr>
  </tbody>
</table>

<h2 id="user-to-user-permissions">User to User Permissions</h2>

<p>Stamplay supports Role-Based Authorization schemes, on a per object level, and user to user level.</p>

<p>The Roles scheme can be configured with the <strong>Users</strong> section <strong>Roles</strong> section for the <strong>Role -&gt; Role</strong> permissions, and inside each <strong>Object</strong> model's view under the <strong>Permissions</strong> tab for each object individual schema.</p>

<p>For further detail, view the <a href="#roles">Roles documetation</a>.</p>

<h2 id="logging-out">Logging Out</h2>

<pre class="highlight shell"><code>  curl -X <span class="s2">"GET"</span> <span class="s2">"https://APP-ID.stamplayapp.com/auth/v1/logout"</span> <span class="se">\</span>
  -H <span class="s2">"x-stamplay-jwt: eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ0eXBlIjoidXNlciIsImFwcERvbWFpbiI6InN0YW1wbGF5a2Iuc3RhbXBsYXlscHAuY29tIiwiYXBwSWQiOiJzdGFtcGxheWtiIiwidXNlciI6IjU2ZjAyZDY0NjFkNWI0MTA1ZDFhMjY4NCIsImlhdCI6MTQ1ODU4MTQwNiwiZXhwIjoxNDU5MTg2Mjc4fQ.UDFUe0Zb2ZHx3HXdiUXWnHSyKghVI_harpkkyC3BU8A"</span>

</code></pre>

<pre class="highlight javascript"><code>  <span class="c1">//sync</span>
  <span class="nx">Stamplay</span><span class="p">.</span><span class="nx">User</span><span class="p">.</span><span class="nx">logout</span><span class="p">();</span>

  <span class="c1">//async</span>
  <span class="nx">Stamplay</span><span class="p">.</span><span class="nx">User</span><span class="p">.</span><span class="nx">logout</span><span class="p">(</span><span class="kc">true</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">res</span><span class="p">){</span>
  <span class="err">……</span>
  <span class="p">})</span>
</code></pre>

<pre class="highlight nodejs"><code>  <span class="c1">// no method</span>
</code></pre>

<blockquote>
  <p>Response is a redirect, as specified in the Authentication section in Stamplay.</p>
</blockquote>

<p>To logout and end a user session, send a request to the logout endpoint. The <code>x-stamplay-jwt</code> header must be included otherwise the session will not be ended.</p>

<p>The request response will redirect the application by default to the root of your application. This can be managed within the Stamplay editor in the <strong>User</strong> -&gt; <strong>Authentication</strong> section by select the settings icon.</p>

<h2 id="fetch-users">Fetch Users</h2>

<p>Retrieve an individual user, all users, or the current session user, or any users matching specific criteria.</p>

<h3 id="current-user">Current User</h3>

<pre class="highlight shell"><code>  curl -X <span class="s2">"GET"</span> <span class="s2">"https://APP-ID.stamplayapp.com/api/user/v1/getstatus"</span> <span class="se">\</span>
  -H <span class="s2">"x-stamplay-jwt: eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ0eXBlIjoidXNlciIsImFwcERvbWFpbiI6InN0YW1wbGF5a2Iuc3RhbXBsYXlscHAuY29tIiwiYXBwSWQiOiJzdGFtcGxheWtiIiwidXNlciI6IjU2ZjAyZDY0NjFkNWI0MTA1ZDFhMjY4NCIsImlhdCI6MTQ1ODU4MTQwNiwiZXhwIjoxNDU5MTg2Mjc4fQ.UDFUe0Zb2ZHx3HXdiUXWnHSyKghVI_harpkkyC3BU8A"</span>
</code></pre>

<pre class="highlight javascript"><code>  <span class="nx">Stamplay</span><span class="p">.</span><span class="nx">User</span><span class="p">.</span><span class="nx">currentUser</span><span class="p">()</span>
    <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">res</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// success</span>
    <span class="p">},</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// error</span>
    <span class="p">})</span>
</code></pre>

<pre class="highlight nodejs"><code>  <span class="c1">// no method</span>
</code></pre>

<blockquote>
  <p>The JSON response looks like this.</p>
</blockquote>

<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"user"</span><span class="p">:{</span><span class="w">
    </span><span class="nt">"_id"</span><span class="p">:</span><span class="s2">"5685876dcb19408f345a4890"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"email"</span><span class="p">:</span><span class="s2">"isaiahgrey@gmail.com"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"givenRole"</span><span class="p">:</span><span class="s2">"56838ed5948583ff7dcd7c9f"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"appId"</span><span class="p">:</span><span class="s2">"stamplay-angular-seed"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"salt"</span><span class="p">:</span><span class="s2">"875be8da8da96d5a2c16"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"__v"</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="w">
    </span><span class="nt">"password"</span><span class="p">:</span><span class="s2">"$2a$12$bAV9Wxl8LmgY.BazFi.o.OsTPrJS9tc2Ih3po6GxGh8SNW0BiIDiq"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"dt_update"</span><span class="p">:</span><span class="s2">"2015-12-31T19:52:13.576Z"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"dt_create"</span><span class="p">:</span><span class="s2">"2015-12-31T19:52:13.576Z"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"emailVerified"</span><span class="p">:</span><span class="kc">true</span><span class="p">,</span><span class="w">
    </span><span class="nt">"verificationCode"</span><span class="p">:</span><span class="s2">"359472b0e1f115fc5006"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"profileImg"</span><span class="p">:</span><span class="s2">""</span><span class="p">,</span><span class="w">
    </span><span class="nt">"id"</span><span class="p">:</span><span class="s2">"5685876dcb19408f345a4890"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>To fetch the user that is currently logged in, send a request to the <code>getStatus</code> endpoint, on the user API resource.</p>

<h3 id="fetch-user-by-id">Fetch User By Id</h3>

<pre class="highlight shell"><code>  curl -X <span class="s2">"GET"</span> <span class="s2">"https://APP-ID.stamplayapp.com/api/user/v1/users/:user_id"</span>
</code></pre>

<pre class="highlight javascript"><code>  <span class="nx">Stamplay</span><span class="p">.</span><span class="nx">User</span><span class="p">.</span><span class="nx">get</span><span class="p">({</span> <span class="na">_id</span> <span class="p">:</span> <span class="s2">"user_id"</span> <span class="p">})</span>
    <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">res</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// success</span>
    <span class="p">},</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// error</span>
    <span class="p">})</span>
</code></pre>

<pre class="highlight nodejs"><code>  <span class="nx">Stamplay</span><span class="p">.</span><span class="nx">User</span><span class="p">.</span><span class="nx">get</span><span class="p">({</span> <span class="na">_id</span> <span class="p">:</span> <span class="s2">"user_id"</span> <span class="p">},</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">res</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// success</span>
  <span class="p">})</span>
</code></pre>

<blockquote>
  <p>The JSON response looks like this.</p>
</blockquote>

<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"data"</span><span class="p">:[</span><span class="w">
    </span><span class="p">{</span><span class="w">
       </span><span class="nt">"_id"</span><span class="p">:</span><span class="s2">"5685876dcb19408f345a4890"</span><span class="p">,</span><span class="w">
       </span><span class="nt">"email"</span><span class="p">:</span><span class="s2">"isaiahgrey@gmail.com"</span><span class="p">,</span><span class="w">
       </span><span class="nt">"givenRole"</span><span class="p">:</span><span class="s2">"56838ed5948583ff7dcd7c9f"</span><span class="p">,</span><span class="w">
       </span><span class="nt">"appId"</span><span class="p">:</span><span class="s2">"stamplay-angular-seed"</span><span class="p">,</span><span class="w">
       </span><span class="nt">"salt"</span><span class="p">:</span><span class="s2">"875be8da8da96d5a2c16"</span><span class="p">,</span><span class="w">
       </span><span class="nt">"__v"</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="w">
       </span><span class="nt">"password"</span><span class="p">:</span><span class="s2">"$2a$12$bAV9Wxl8LmgY.BazFi.o.OsTPrJS9tc2Ih3po6GxGh8SNW0BiIDiq"</span><span class="p">,</span><span class="w">
       </span><span class="nt">"dt_update"</span><span class="p">:</span><span class="s2">"2015-12-31T19:52:13.576Z"</span><span class="p">,</span><span class="w">
       </span><span class="nt">"dt_create"</span><span class="p">:</span><span class="s2">"2015-12-31T19:52:13.576Z"</span><span class="p">,</span><span class="w">
       </span><span class="nt">"emailVerified"</span><span class="p">:</span><span class="kc">true</span><span class="p">,</span><span class="w">
       </span><span class="nt">"verificationCode"</span><span class="p">:</span><span class="s2">"359472b0e1f115fc5006"</span><span class="p">,</span><span class="w">
       </span><span class="nt">"profileImg"</span><span class="p">:</span><span class="s2">""</span><span class="p">,</span><span class="w">
       </span><span class="nt">"id"</span><span class="p">:</span><span class="s2">"5685876dcb19408f345a4890"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">],</span><span class="w">
  </span><span class="nt">"pagination"</span><span class="p">:{</span><span class="w">
    </span><span class="nt">"page"</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="w">
    </span><span class="nt">"per_page"</span><span class="p">:</span><span class="mi">20</span><span class="p">,</span><span class="w">
    </span><span class="nt">"total_pages"</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="w">
    </span><span class="nt">"total_elements"</span><span class="p">:</span><span class="mi">1</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>To fetch an single user, send the <code>_id</code> of the user to fetch in the request body to the user API resource.</p>

<table>
  <thead>
    <tr>
      <th>Attribute</th>
      <th> </th>
      <th style="text-align: center">Optional</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>user_id</code></td>
      <td>the Stamplay <code>_id</code> of the user to fetch</td>
      <td style="text-align: center"><i class="unchecked"></i></td>
    </tr>
  </tbody>
</table>

<h3 id="all-users">All Users</h3>

<pre class="highlight shell"><code>  curl -X <span class="s2">"GET"</span> <span class="s2">"https://APP-ID.stamplayapp.com/api/user/v1/users"</span>
</code></pre>

<pre class="highlight javascript"><code>  <span class="nx">Stamplay</span><span class="p">.</span><span class="nx">User</span><span class="p">.</span><span class="nx">get</span><span class="p">({})</span>
    <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">res</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// success</span>
    <span class="p">},</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// error</span>
    <span class="p">})</span>
</code></pre>

<pre class="highlight nodejs"><code>  <span class="nx">Stamplay</span><span class="p">.</span><span class="nx">User</span><span class="p">.</span><span class="nx">get</span><span class="p">({},</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">res</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// success</span>
  <span class="p">})</span>
</code></pre>

<blockquote>
  <p>The JSON response looks like this.</p>
</blockquote>

<pre class="highlight json"><code><span class="w">
</span><span class="p">{</span><span class="w">
   </span><span class="nt">"data"</span><span class="p">:[</span><span class="w">
      </span><span class="p">{</span><span class="w">
         </span><span class="nt">"_id"</span><span class="p">:</span><span class="s2">"568463adcb19408f345a4870"</span><span class="p">,</span><span class="w">
         </span><span class="nt">"givenRole"</span><span class="p">:</span><span class="s2">"56838ed5948583ff7dcd7c9f"</span><span class="p">,</span><span class="w">
         </span><span class="nt">"dt_update"</span><span class="p">:</span><span class="s2">"2015-12-30T23:07:25.730Z"</span><span class="p">,</span><span class="w">
         </span><span class="nt">"dt_create"</span><span class="p">:</span><span class="s2">"2015-12-30T23:07:25.730Z"</span><span class="p">,</span><span class="w">
         </span><span class="nt">"emailVerified"</span><span class="p">:</span><span class="kc">true</span><span class="p">,</span><span class="w">
         </span><span class="nt">"verificationCode"</span><span class="p">:</span><span class="s2">"c4b0263a8cb5bea890ca"</span><span class="p">,</span><span class="w">
         </span><span class="nt">"profileImg"</span><span class="p">:</span><span class="s2">""</span><span class="p">,</span><span class="w">
         </span><span class="nt">"id"</span><span class="p">:</span><span class="s2">"568463adcb19408f345a4870"</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="p">{</span><span class="w">
         </span><span class="nt">"_id"</span><span class="p">:</span><span class="s2">"5685876dcb19408f345a4890"</span><span class="p">,</span><span class="w">
         </span><span class="nt">"givenRole"</span><span class="p">:</span><span class="s2">"56838ed5948583ff7dcd7c9f"</span><span class="p">,</span><span class="w">
         </span><span class="nt">"dt_update"</span><span class="p">:</span><span class="s2">"2015-12-31T19:52:13.576Z"</span><span class="p">,</span><span class="w">
         </span><span class="nt">"dt_create"</span><span class="p">:</span><span class="s2">"2015-12-31T19:52:13.576Z"</span><span class="p">,</span><span class="w">
         </span><span class="nt">"emailVerified"</span><span class="p">:</span><span class="kc">true</span><span class="p">,</span><span class="w">
         </span><span class="nt">"verificationCode"</span><span class="p">:</span><span class="s2">"c4b0263a8cb5bea890ca"</span><span class="p">,</span><span class="w">
         </span><span class="nt">"profileImg"</span><span class="p">:</span><span class="s2">""</span><span class="p">,</span><span class="w">
         </span><span class="nt">"id"</span><span class="p">:</span><span class="s2">"5685876dcb19408f345a4890"</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="err">...</span><span class="w">
      </span><span class="err">...</span><span class="mi">18</span><span class="w"> </span><span class="err">More</span><span class="w">
      </span><span class="err">...</span><span class="w">
   </span><span class="p">],</span><span class="w">
   </span><span class="nt">"pagination"</span><span class="p">:{</span><span class="w">
      </span><span class="nt">"page"</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="w">
      </span><span class="nt">"per_page"</span><span class="p">:</span><span class="mi">20</span><span class="p">,</span><span class="w">
      </span><span class="nt">"total_pages"</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="w">
      </span><span class="nt">"total_elements"</span><span class="p">:</span><span class="mi">19</span><span class="w">
   </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">

</span></code></pre>

<p>To retrieve all users, send a request without any parameters to match in the body, to the user API resource.</p>

<h3 id="query-users">Query Users</h3>

<pre class="highlight shell"><code>  curl -X <span class="s2">"GET"</span> <span class="s2">"https://APP-ID.stamplayapp.com/api/user/v1/users"</span> <span class="se">\</span>
  -H <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
  -d <span class="s2">"{</span><span class="se">\"</span><span class="s2">name</span><span class="se">\"</span><span class="s2">:</span><span class="se">\"</span><span class="s2">John</span><span class="se">\"</span><span class="s2">,</span><span class="se">\"</span><span class="s2">age</span><span class="se">\"</span><span class="s2">:</span><span class="se">\"</span><span class="s2">30</span><span class="se">\"</span><span class="s2">}"</span>
</code></pre>

<pre class="highlight javascript"><code>  <span class="kd">var</span> <span class="nx">query</span> <span class="o">=</span> <span class="p">{</span>
    <span class="na">name</span> <span class="p">:</span> <span class="s2">"John"</span><span class="p">,</span>
    <span class="na">age</span> <span class="p">:</span> <span class="mi">30</span>
  <span class="p">}</span>

  <span class="nx">Stamplay</span><span class="p">.</span><span class="nx">User</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">query</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">res</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// success</span>
    <span class="p">},</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// error</span>
    <span class="p">})</span>
</code></pre>

<pre class="highlight nodejs"><code>  <span class="kd">var</span> <span class="nx">query</span> <span class="o">=</span> <span class="p">{</span>
    <span class="na">name</span> <span class="p">:</span> <span class="s2">"John"</span><span class="p">,</span>
    <span class="na">age</span> <span class="p">:</span> <span class="mi">30</span>
  <span class="p">}</span>

  <span class="nx">Stamplay</span><span class="p">.</span><span class="nx">User</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">query</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">res</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// success</span>
  <span class="p">})</span>
</code></pre>

<blockquote>
  <p>The JSON response looks like this.</p>
</blockquote>

<pre class="highlight json"><code><span class="p">{</span><span class="w">
   </span><span class="nt">"data"</span><span class="p">:[</span><span class="w">
      </span><span class="p">{</span><span class="w">
         </span><span class="nt">"_id"</span><span class="p">:</span><span class="s2">"568463adcb19408f345a4870"</span><span class="p">,</span><span class="w">
         </span><span class="nt">"name"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"John"</span><span class="p">,</span><span class="w">
         </span><span class="nt">"age"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">30</span><span class="p">,</span><span class="w">
         </span><span class="nt">"givenRole"</span><span class="p">:</span><span class="s2">"56838ed5948583ff7dcd7c9f"</span><span class="p">,</span><span class="w">
         </span><span class="nt">"dt_update"</span><span class="p">:</span><span class="s2">"2015-12-30T23:07:25.730Z"</span><span class="p">,</span><span class="w">
         </span><span class="nt">"dt_create"</span><span class="p">:</span><span class="s2">"2015-12-30T23:07:25.730Z"</span><span class="p">,</span><span class="w">
         </span><span class="nt">"emailVerified"</span><span class="p">:</span><span class="kc">true</span><span class="p">,</span><span class="w">
         </span><span class="nt">"verificationCode"</span><span class="p">:</span><span class="s2">"c4b0263a8cb5bea890ca"</span><span class="p">,</span><span class="w">
         </span><span class="nt">"profileImg"</span><span class="p">:</span><span class="s2">""</span><span class="p">,</span><span class="w">
         </span><span class="nt">"id"</span><span class="p">:</span><span class="s2">"568463adcb19408f345a4870"</span><span class="w">
      </span><span class="p">}</span><span class="w">
   </span><span class="p">],</span><span class="w">
   </span><span class="nt">"pagination"</span><span class="p">:{</span><span class="w">
      </span><span class="nt">"page"</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="w">
      </span><span class="nt">"per_page"</span><span class="p">:</span><span class="mi">20</span><span class="p">,</span><span class="w">
      </span><span class="nt">"total_pages"</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="w">
      </span><span class="nt">"total_elements"</span><span class="p">:</span><span class="mi">1</span><span class="w">
   </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">

</span></code></pre>

<p>To retrieve all users that match a certain set of parameters, send a request with any parameters to match in the body, to the user API resource.</p>

<h2 id="update-user">Update User</h2>

<pre class="highlight shell"><code>  curl -X <span class="s2">"PUT"</span> <span class="s2">"https://APP-ID.stamplayapp.com/api/user/v1/users/:user_id"</span> <span class="se">\</span>
  -H <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
  -d <span class="s2">"{</span><span class="se">\"</span><span class="s2">name</span><span class="se">\"</span><span class="s2">:</span><span class="se">\"</span><span class="s2">John</span><span class="se">\"</span><span class="s2">,</span><span class="se">\"</span><span class="s2">age</span><span class="se">\"</span><span class="s2">:</span><span class="se">\"</span><span class="s2">30</span><span class="se">\"</span><span class="s2">}"</span>
</code></pre>

<pre class="highlight javascript"><code>  <span class="kd">var</span> <span class="nx">updatedInfo</span> <span class="o">=</span> <span class="p">{</span>
    <span class="na">name</span> <span class="p">:</span> <span class="s2">"John"</span><span class="p">,</span>
    <span class="na">age</span> <span class="p">:</span> <span class="mi">30</span>
  <span class="p">}</span>

  <span class="nx">Stamplay</span><span class="p">.</span><span class="nx">User</span><span class="p">.</span><span class="nx">update</span><span class="p">(</span><span class="s2">"user_id"</span><span class="p">,</span> <span class="nx">updatedInfo</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">res</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// success</span>
    <span class="p">},</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// error</span>
    <span class="p">})</span>
</code></pre>

<pre class="highlight nodejs"><code>  <span class="kd">var</span> <span class="nx">updatedInfo</span> <span class="o">=</span> <span class="p">{</span>
    <span class="na">name</span> <span class="p">:</span> <span class="s2">"John"</span><span class="p">,</span>
    <span class="na">age</span> <span class="p">:</span> <span class="mi">30</span>
  <span class="p">}</span>

  <span class="nx">Stamplay</span><span class="p">.</span><span class="nx">User</span><span class="p">.</span><span class="nx">update</span><span class="p">(</span><span class="s2">"user_id"</span><span class="p">,</span> <span class="nx">updatedInfo</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">res</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// success</span>
  <span class="p">})</span>
</code></pre>

<blockquote>
  <p>The JSON response looks like this.</p>
</blockquote>

<pre class="highlight json"><code><span class="w">
</span><span class="p">{</span><span class="w">
  </span><span class="nt">"_id"</span><span class="p">:</span><span class="s2">"570eab5bc0d4b16b26a4bbdc"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"displayName"</span><span class="p">:</span><span class="s2">""</span><span class="p">,</span><span class="w">
  </span><span class="nt">"givenRole"</span><span class="p">:</span><span class="s2">"57059a25d229692c639df406"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"age"</span><span class="p">:</span><span class="mi">30</span><span class="p">,</span><span class="w">
  </span><span class="nt">"name"</span><span class="p">:</span><span class="s2">"John"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"dt_update"</span><span class="p">:</span><span class="s2">"2016-04-13T23:16:30.366Z"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"dt_create"</span><span class="p">:</span><span class="s2">"2016-04-13T20:26:03.677Z"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"emailVerified"</span><span class="p">:</span><span class="kc">true</span><span class="p">,</span><span class="w">
  </span><span class="nt">"verificationCode"</span><span class="p">:</span><span class="s2">"6f11f44ad0ec8bd0fa27"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"profileImg"</span><span class="p">:</span><span class="s2">""</span><span class="p">,</span><span class="w">
  </span><span class="nt">"id"</span><span class="p">:</span><span class="s2">"570eab5bc0d4b16b26a4bbdc"</span><span class="w">
</span><span class="p">}</span><span class="w">

</span></code></pre>

<p>To update a user record, send a <code>PUT</code> request with a with updated data.</p>

<p>Include this data in the request body, in the request to the User API resource with the <code>_id</code> of the user to update.</p>

<table>
  <thead>
    <tr>
      <th>Attribute</th>
      <th> </th>
      <th style="text-align: center">Optional</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>user_id</code></td>
      <td>the Stamplay <code>_id</code> of the user to update</td>
      <td style="text-align: center"><i class="unchecked"></i></td>
    </tr>
  </tbody>
</table>

<h2 id="remove-user">Remove User</h2>

<pre class="highlight shell"><code>  curl -X <span class="s2">"DELETE"</span> <span class="s2">"https://APP-ID.stamplayapp.com/api/user/v1/users/:user_id"</span>
</code></pre>

<pre class="highlight javascript"><code>  <span class="nx">Stamplay</span><span class="p">.</span><span class="nx">User</span><span class="p">.</span><span class="nx">remove</span><span class="p">(</span><span class="s2">"user_id"</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">res</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// success</span>
    <span class="p">},</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// error</span>
    <span class="p">})</span>
</code></pre>

<pre class="highlight nodejs"><code>  <span class="nx">Stamplay</span><span class="p">.</span><span class="nx">User</span><span class="p">.</span><span class="nx">remove</span><span class="p">(</span><span class="s2">"user_id"</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">res</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// success</span>
  <span class="p">})</span>
</code></pre>

<blockquote>
  <p>The JSON response looks like this.</p>
</blockquote>

<pre class="highlight json"><code><span class="w">
</span><span class="p">{</span><span class="w">
  </span><span class="nt">"_id"</span><span class="p">:</span><span class="s2">"570eab5bc0d4b16b26a4bbdc"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"displayName"</span><span class="p">:</span><span class="s2">"John"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"givenRole"</span><span class="p">:</span><span class="s2">"57059a25d229692c639df406"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"age"</span><span class="p">:</span><span class="mi">30</span><span class="p">,</span><span class="w">
  </span><span class="nt">"name"</span><span class="p">:</span><span class="s2">"John"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"dt_update"</span><span class="p">:</span><span class="s2">"2016-04-13T23:16:30.366Z"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"dt_create"</span><span class="p">:</span><span class="s2">"2016-04-13T20:26:03.677Z"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"emailVerified"</span><span class="p">:</span><span class="kc">true</span><span class="p">,</span><span class="w">
  </span><span class="nt">"verificationCode"</span><span class="p">:</span><span class="s2">"6f11f44ad0ec8bd0fa27"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"profileImg"</span><span class="p">:</span><span class="s2">""</span><span class="p">,</span><span class="w">
  </span><span class="nt">"id"</span><span class="p">:</span><span class="s2">"570eab5bc0d4b16b26a4bbdc"</span><span class="w">
</span><span class="p">}</span><span class="w">

</span></code></pre>

<p>To remove a user record from the database, send a <code>DELETE</code> request to the user resource with the user <code>_id</code> to the User API resource.</p>

<table>
  <thead>
    <tr>
      <th>Attribute</th>
      <th> </th>
      <th style="text-align: center">Optional</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>user_id</code></td>
      <td>the Stamplay <code>_id</code> of the user to delete</td>
      <td style="text-align: center"><i class="unchecked"></i></td>
    </tr>
  </tbody>
</table>

<!-- ## Activity -->

<!-- 
  Return the activities that user with the specified userId has done. Each activity is composed by a triple:

  activity: the name of the activity
  actor: the entity that has done the activity
  target: the entity on which the activity is done
 -->

<!-- ## Follower System
### Follow User
### Unfollow User
### Get Followers
### Get Following -->

          <h1 id="roles">Roles</h1>

<p>Stamplay supports role based access control for a fine grained authorization layer.</p>

<h2 id="how-roles-work">How Roles Work</h2>

<p>Roles provide a logical way of grouping users with common access privileges.</p>

<p>Any permission granted to a role is implicitly granted to its users and to the users in any roles it contains.</p>

<p>By default, any Stamplay app has two pre-defined roles: <code>guest</code> and <code>registered</code>.</p>

<p>You can add as many roles as you need and define hierarchies to grant a user with role <code>X</code> the permission to change the role of another user with role <code>Y</code>.</p>

<p>Roles and permissions each has are defined within the Stamplay editor entirely, the API resource if for reading and assiging the roles you define only.</p>

<h2 id="fetch-all-roles">Fetch All Roles</h2>

<pre class="highlight shell"><code>curl -X <span class="s2">"GET"</span> <span class="s2">"https://APP-ID.stamplayapp.com/api/user/v1/roles"</span>
</code></pre>

<pre class="highlight javascript"><code><span class="nx">Stamplay</span><span class="p">.</span><span class="nx">User</span><span class="p">.</span><span class="nx">getRoles</span><span class="p">()</span>
  <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">res</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// success</span>
  <span class="p">},</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// error</span>
  <span class="p">})</span>
</code></pre>

<pre class="highlight nodejs"><code><span class="c1">// no method</span>
</code></pre>

<blockquote>
  <p>The JSON response looks like this.</p>
</blockquote>

<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nt">"_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"561c001ce57bdca90ee4482a"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"guest"</span><span class="w">
    </span><span class="p">},</span><span class="w">
     </span><span class="p">{</span><span class="w">
      </span><span class="nt">"_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"561c001ce57bdca90ee4482b"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"registered"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nt">"_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"56f8d353e252697a51cce376"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"admin"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">],</span><span class="w">
  </span><span class="nt">"pagination"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"page"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
    </span><span class="nt">"per_page"</span><span class="p">:</span><span class="w"> </span><span class="mi">20</span><span class="p">,</span><span class="w">
    </span><span class="nt">"total_elements"</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w">
    </span><span class="nt">"total_pages"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>To retrieve all roles within your application, send a <code>GET</code> request to the Roles API resource.</p>

<h2 id="fetch-individual-role">Fetch Individual Role</h2>

<pre class="highlight shell"><code>curl -X <span class="s2">"GET"</span> <span class="s2">"https://APP-ID.stamplayapp.com/api/user/v1/roles/:role_id"</span>
</code></pre>

<pre class="highlight javascript"><code><span class="nx">Stamplay</span><span class="p">.</span><span class="nx">User</span><span class="p">.</span><span class="nx">getRole</span><span class="p">(</span><span class="s2">"role_Id"</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">res</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// success</span>
  <span class="p">},</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// error</span>
  <span class="p">})</span>
</code></pre>

<pre class="highlight nodejs"><code><span class="c1">// no method</span>
</code></pre>

<blockquote>
  <p>The JSON response looks like this.</p>
</blockquote>

<pre class="highlight json"><code><span class="w">
</span><span class="p">{</span><span class="w">
  </span><span class="nt">"_id"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"56f8d353e252697a51cce376"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"name"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"admin"</span><span class="w">
</span><span class="p">}</span><span class="w">

</span></code></pre>

<p>To fetch a single role, send a <code>GET</code> request to the Roles API resource, with the <code>_id</code> as part of the request URI.</p>

<table>
  <thead>
    <tr>
      <th>Attribute</th>
      <th> </th>
      <th style="text-align: center">Optional</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>role_id</code></td>
      <td>the Stamplay <code>_id</code> of the role to fetch</td>
      <td style="text-align: center"><i class="unchecked"></i></td>
    </tr>
  </tbody>
</table>

<h2 id="assign-role">Assign Role</h2>

<pre class="highlight shell"><code>curl -X <span class="s2">"PATCH"</span> <span class="s2">"https://APP-ID.stamplayapp.com/api/user/v1/users/:user_id"</span> <span class="se">\</span>
-H <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
-d <span class="s2">"{</span><span class="se">\"</span><span class="s2">givenRole</span><span class="se">\"</span><span class="s2">:</span><span class="se">\"</span><span class="s2">role_id</span><span class="se">\"</span><span class="s2">}"</span>

</code></pre>

<pre class="highlight javascript"><code><span class="nx">Stamplay</span><span class="p">.</span><span class="nx">User</span><span class="p">.</span><span class="nx">setRole</span><span class="p">(</span><span class="s2">"userId"</span><span class="p">,</span> <span class="s2">"role_id"</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">res</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// success</span>
  <span class="p">},</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// error</span>
  <span class="p">})</span>
</code></pre>

<pre class="highlight nodejs"><code><span class="nx">Stamplay</span><span class="p">.</span><span class="nx">User</span><span class="p">.</span><span class="nx">patch</span><span class="p">(</span><span class="s2">"user_id"</span><span class="p">,</span> <span class="p">{</span> <span class="na">givenRole</span> <span class="p">:</span> <span class="s2">"role_id"</span> <span class="p">},</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">res</span><span class="p">)</span> <span class="p">{</span>
  <span class="c1">// success</span>
<span class="p">})</span>
</code></pre>

<blockquote>

</blockquote>

<pre class="highlight json"><code><span class="w">
</span><span class="p">{</span><span class="w">  
  </span><span class="nt">"_id"</span><span class="p">:</span><span class="s2">"570eb000c0d4b16b26a4bbdd"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"email"</span><span class="p">:</span><span class="s2">"user@stamplay.com"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"password"</span><span class="p">:</span><span class="s2">"$2a$12$lv9lbkAiwyvfT13oosMefuWHCp87NC/azMlwYwxsSUVVpw.YI0ZfO"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"givenRole"</span><span class="p">:</span><span class="s2">"570ec91fb7581ccd707c4d48"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"appId"</span><span class="p">:</span><span class="s2">"stamplaykb"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"__v"</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="w">
  </span><span class="nt">"username"</span><span class="p">:</span><span class="s2">""</span><span class="p">,</span><span class="w">
  </span><span class="nt">"displayName"</span><span class="p">:</span><span class="s2">""</span><span class="p">,</span><span class="w">
  </span><span class="nt">"dt_update"</span><span class="p">:</span><span class="s2">"2016-04-13T22:33:54.595Z"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"dt_create"</span><span class="p">:</span><span class="s2">"2016-04-13T20:45:52.498Z"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"emailVerified"</span><span class="p">:</span><span class="kc">true</span><span class="p">,</span><span class="w">
  </span><span class="nt">"verificationCode"</span><span class="p">:</span><span class="s2">"65d1b991bd0010536416"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"profileImg"</span><span class="p">:</span><span class="s2">""</span><span class="p">,</span><span class="w">
  </span><span class="nt">"id"</span><span class="p">:</span><span class="s2">"570eb000c0d4b16b26a4bbdd"</span><span class="w">
</span><span class="p">}</span><span class="w">

</span></code></pre>

<p>To assign a new role to a user, send a <code>PATCH</code> request with the <code>givenRole</code> property as the unique <code>_id</code> of the role to assign in the request body, to the User API resource with the user's <code>_id</code> as part of the URI.</p>

<table>
  <thead>
    <tr>
      <th>Attribute</th>
      <th> </th>
      <th style="text-align: center">Optional</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>user_id</code></td>
      <td>the Stamplay <code>_id</code> of the user to assign a role</td>
      <td style="text-align: center"><i class="unchecked"></i></td>
    </tr>
    <tr>
      <td><code>role_id</code></td>
      <td>the Stamplay <code>_id</code> of the role to assign to the user</td>
      <td style="text-align: center"><i class="unchecked"></i></td>
    </tr>
  </tbody>
</table>


          <h1 id="objects">Objects</h1>

<p>The Object API resource is based of the user defined Schemas in the Stamplay Editor.</p>

<p>For each Schema, and API endpoint is generated, and new database collection is added.</p>

<p>Out of the box, the Object API resource supports user relationships, object relationships, geolocation data, file uploads, and role based interaction for each schema type.</p>

<h2 id="schemas">Schemas</h2>

<p>Schemas are defined data structures that enfore type validation.</p>

<p>They can be created throught Stamplay Editor, inside the <strong>Object</strong> section.</p>

<p>Below is an example schema of a <strong>Restaurant</strong> with every possible data type available as a field type.</p>

<p>There are 3 properties that are included by default:</p>

<table>
  <thead>
    <tr>
      <th>Attribute</th>
      <th> </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>dt_create</code></td>
      <td>The date the record was created</td>
    </tr>
    <tr>
      <td><code>dt_update</code></td>
      <td>The date the record was last updated</td>
    </tr>
    <tr>
      <td><code>owner</code></td>
      <td>The <code>_id</code> of the user who created this object.</td>
    </tr>
  </tbody>
</table>

<aside class="notice">
  <p>The <strong>owner</strong> field is set when an active user session is in place, and the session <strong>JSON Web Token</strong>, is in the request as the <strong>x-stamplay-jwt</strong> header.</p>

  <p>The JavaScript SDK manages this header for you, so only via an API request via REST will need you to set this header for the owner property to be set to the current user session.</p>
</aside>

<h2 id="data-types">Data Types</h2>

<p>The types and formats of each field type is listed below:</p>

<blockquote>
  <p>In the example schema object below, each key-value pair is a possible schema property type, and a valid value for that property type.</p>
</blockquote>

<pre class="highlight json"><code><span class="w">
</span><span class="p">{</span><span class="w">
  </span><span class="nt">"boolean"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
  </span><span class="nt">"string"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"Hello World"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"number"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">45</span><span class="p">,</span><span class="w">
  </span><span class="nt">"float"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mf">3.14</span><span class="p">,</span><span class="w">
  </span><span class="nt">"plain_object"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"prop_one"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"GoodBye World"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"prop_two"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">1200</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="nt">"array_number"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="mi">23</span><span class="p">,</span><span class="w"> </span><span class="mi">76</span><span class="p">,</span><span class="w"> </span><span class="mi">345</span><span class="p">],</span><span class="w">
  </span><span class="nt">"array_string"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"Hello"</span><span class="p">,</span><span class="w"> </span><span class="s2">"World"</span><span class="p">],</span><span class="w">
  </span><span class="nt">"date"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"2016-03-10T14:51:28.625Z"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"file"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"https://file-upload.stamplayapp.com/upload/cobject/image/1458238116389_file-upload.png"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"_geolocation"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"type"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"Point"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"coordinates "</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
      </span><span class="mf">12.4608</span><span class="p">,</span><span class="w">
      </span><span class="mf">41.9015</span><span class="w">
    </span><span class="p">]</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="nt">"object_relation_array"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="s2">"562c45af4c0f20367d7ca4be"</span><span class="p">,</span><span class="w"> </span><span class="s2">"562ec06e77589e2e0f86c207"</span><span class="p">],</span><span class="w">
  </span><span class="nt">"user_relation_string"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"562bb24e007983c67c8ee9df"</span><span class="w">
</span><span class="p">}</span><span class="w">  
</span></code></pre>

<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Summary</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><a href="#boolean">Boolean</a></td>
      <td>A boolean value type</td>
    </tr>
    <tr>
      <td><a href="#string">String</a></td>
      <td>String value type. Strings are stored as UTF-8.</td>
    </tr>
    <tr>
      <td><a href="#number">Number</a></td>
      <td>An integer value type.</td>
    </tr>
    <tr>
      <td><a href="#float">Float</a></td>
      <td>A float value type.</td>
    </tr>
    <tr>
      <td><a href="#plain-object">Plain Object</a></td>
      <td>A Javascript object.</td>
    </tr>
    <tr>
      <td><a href="#array-number">Array - Number</a></td>
      <td>An array of integer value types.</td>
    </tr>
    <tr>
      <td><a href="#array-string">Array - String</a></td>
      <td>An array of string value types.</td>
    </tr>
    <tr>
      <td><a href="#date">Date</a></td>
      <td>Date value type. Dates are stored in ISODateTimeFormat.</td>
    </tr>
    <tr>
      <td><a href="#file">File</a></td>
      <td>Any kind of file. Location of the resource uploaded.</td>
    </tr>
    <tr>
      <td><a href="#geolocation">Geolocation</a></td>
      <td>GeoJSON object.</td>
    </tr>
    <tr>
      <td><a href="#object-relation">Object Relation - Array</a></td>
      <td>An arrays of pointers to an specific object type.</td>
    </tr>
    <tr>
      <td><a href="#user-relation">User Relation - String</a></td>
      <td>A pointer to a user object.</td>
    </tr>
  </tbody>
</table>

<h3 id="boolean">Boolean</h3>

<pre class="highlight shell-always"><code>  <span class="p">{</span>
    <span class="nl">_id</span><span class="p">:</span> <span class="s2">"56cf08e362641ca813b1ae6c"</span><span class="p">,</span>
    <span class="nx">verified</span> <span class="err">:</span> <span class="kc">true</span>
  <span class="p">}</span>
</code></pre>

<p>A <strong>Boolean</strong> type is a <code>true</code> or <code>false</code> value.</p>

<h3 id="string">String</h3>

<pre class="highlight shell-always"><code>  <span class="p">{</span>
    <span class="nl">_id</span><span class="p">:</span> <span class="s2">"56cf08e362641ca813b1ae6c"</span><span class="p">,</span>
    <span class="nx">name</span> <span class="err">:</span> <span class="s2">"John"</span>
  <span class="p">}</span>
</code></pre>

<p>A <strong>String</strong> type is a series of characters enclosed by single, or double quotes.</p>

<h3 id="number">Number</h3>

<pre class="highlight shell-always"><code>  <span class="p">{</span>
    <span class="nl">_id</span><span class="p">:</span> <span class="s2">"56cf08e362641ca813b1ae6c"</span><span class="p">,</span>
    <span class="nx">age</span> <span class="err">:</span> <span class="mi">29</span>
  <span class="p">}</span>
</code></pre>

<p>A <strong>Number</strong> type is an integer value type without a period or exponent notation.</p>

<h3 id="float">Float</h3>

<pre class="highlight shell-always"><code>  <span class="p">{</span>
    <span class="nl">_id</span><span class="p">:</span> <span class="s2">"56cf08e362641ca813b1ae6c"</span><span class="p">,</span>
    <span class="nx">pie</span> <span class="err">:</span> <span class="mf">3.14</span>
  <span class="p">}</span>
</code></pre>

<p>A <strong>Float</strong> type is an integer value type with a period or exponent notation.</p>

<h3 id="plain-object">Plain Object</h3>

<pre class="highlight shell-always"><code>  <span class="p">{</span>
    <span class="nl">_id</span><span class="p">:</span> <span class="s2">"56cf08e362641ca813b1ae6c"</span><span class="p">,</span>
    <span class="nx">car</span> <span class="err">:</span> <span class="p">{</span>
      <span class="nl">color</span> <span class="p">:</span> <span class="s2">"blue"</span><span class="p">,</span>
      <span class="nx">year</span> <span class="err">:</span> <span class="mi">2014</span><span class="p">,</span>
      <span class="nx">automatic</span> <span class="err">:</span> <span class="kc">false</span>
    <span class="p">}</span>
  <span class="p">}</span>
</code></pre>

<p>A <strong>Plain Object</strong> type is a plain javascript object. The property <code>car</code> is a plain object type in the example.</p>

<h3 id="array---number">Array - Number</h3>

<pre class="highlight shell-always"><code>  <span class="p">{</span>
    <span class="nl">_id</span><span class="p">:</span> <span class="s2">"56cf08e362641ca813b1ae6c"</span><span class="p">,</span>
    <span class="nx">colors</span> <span class="err">:</span> <span class="p">[</span><span class="mi">12</span><span class="p">,</span> <span class="mi">43</span><span class="p">,</span> <span class="mi">235</span><span class="p">,</span> <span class="mi">66</span><span class="p">]</span>
  <span class="p">}</span>
</code></pre>

<p>An <strong>Array</strong> of <strong>Number</strong> value types:</p>

<h3 id="array---string">Array - String</h3>

<pre class="highlight shell-always"><code>  <span class="p">{</span>
    <span class="nl">_id</span><span class="p">:</span> <span class="s2">"56cf08e362641ca813b1ae6c"</span><span class="p">,</span>
    <span class="nx">colors</span> <span class="err">:</span> <span class="p">[</span><span class="s2">"yellow"</span><span class="p">,</span> <span class="s2">"green"</span><span class="p">,</span> <span class="s2">"blue"</span><span class="p">,</span> <span class="s2">"red"</span><span class="p">]</span>
  <span class="p">}</span>
</code></pre>

<p>An <strong>Array</strong> of <strong>String</strong> value types:</p>

<h3 id="date">Date</h3>

<pre class="highlight shell-always"><code>    <span class="p">{</span>
      <span class="nl">_id</span> <span class="p">:</span> <span class="s2">"56cf08e362641ca813b1ae6c"</span><span class="p">,</span>
      <span class="nx">start_date</span> <span class="err">:</span> <span class="s2">"2016-03-10T14:51:28.625Z"</span>
    <span class="p">}</span>
</code></pre>

<pre class="highlight shell-always"><code>  <span class="p">{</span>
      <span class="nl">_id</span> <span class="p">:</span> <span class="s2">"56cf08e362641ca813b1ae6c"</span><span class="p">,</span>
      <span class="nx">end_date</span> <span class="err">:</span> <span class="s2">"Thu, 10 Mar 2016 14:51:43 GMT"</span>
    <span class="p">}</span>
</code></pre>

<p>A <strong>Date</strong> type is a date string in either the <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Date/toISOString">ISO 8601</a> format, or <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Date/toUTCString">RFC-1123</a> format.</p>

<p>The property <code>start_date</code> is a Date type in <strong>ISO 8601</strong> format in the first example.</p>

<p>The property <code>end_date</code> is a Date type in <strong>RFC-1123</strong> format in the last example.</p>

<h3 id="file">File</h3>

<pre class="highlight shell-always"><code>  <span class="p">{</span>
    <span class="nl">_id</span> <span class="p">:</span> <span class="s2">"56cf08e362641ca813b1ae6c"</span><span class="p">,</span>
    <span class="nx">profile_image</span> <span class="err">:</span> <span class="s2">"https://APP-ID.stamplayapp.com/upload/cobject/[cobject-name]/1457032441927_stamplay.png"</span>
  <span class="p">}</span>
</code></pre>

<p>A <strong>File</strong> type is a file upload. Any kind of file is accepted. When a file is uploaded, and saved, the property will be a link to the file upload location.</p>

<p>To save a file type, the request must be sent as <code>multipart/form-data</code>.</p>

<p>The <code>profile_image</code> is an example of a <strong>File</strong> type in the example.</p>

<h3 id="geolocation">Geolocation</h3>

<pre class="highlight shell-always"><code>  <span class="p">{</span>
    <span class="nl">_id</span><span class="p">:</span> <span class="s2">"56cf08e362641ca813b1ae6c"</span><span class="p">,</span>
    <span class="nx">_geolocation</span> <span class="err">:</span> <span class="p">{</span>
      <span class="nl">type</span><span class="p">:</span> <span class="s2">"Point"</span><span class="p">,</span>
      <span class="nx">coordinates</span><span class="err">:</span> <span class="p">[</span>
        <span class="mf">12.4608</span><span class="p">,</span>
        <span class="mf">41.9015</span>
      <span class="p">]</span>
    <span class="p">}</span>
  <span class="p">}</span>
</code></pre>

<p>A <strong>Geolocation</strong> type is stored as <strong>GeoJSON</strong> object with this coordinate-axis order: <code>longitude</code>, <code>latitude</code>.</p>

<p>A Point stored on Stamplay will look like the example:</p>

<p>Currently supported data types are:</p>

<ul>
  <li>
    <ul>
      <li><a href="https://docs.mongodb.org/manual/reference/geojson/#point">Point</a></li>
    </ul>
  </li>
  <li>
    <ul>
      <li><a href="https://docs.mongodb.org/manual/reference/geojson/#linestring">LineString</a></li>
    </ul>
  </li>
  <li>
    <ul>
      <li><a href="https://docs.mongodb.org/manual/reference/geojson/#polygon">Polygon</a></li>
    </ul>
  </li>
  <li>
    <ul>
      <li><a href="https://docs.mongodb.org/manual/reference/geojson/#multipoint">MultiPoint</a></li>
    </ul>
  </li>
  <li>
    <ul>
      <li><a href="https://docs.mongodb.org/manual/reference/geojson/#multilinestring">MultiLineString</a></li>
    </ul>
  </li>
  <li>
    <ul>
      <li><a href="https://docs.mongodb.org/manual/reference/geojson/#multipolygon">MultiPolygon</a></li>
    </ul>
  </li>
</ul>

<p>In order to save any instance of geolocation data you need to send the complete <strong>GeoJSON</strong> representation.</p>

<p>To make this easier if you want to create a Point you're allowed to send an array of coordinates in <code>longitude, latitude</code> format and Stamplay will create the <strong>GeoJSON</strong> for you.</p>

<h3 id="object-relation">Object Relation</h3>

<pre class="highlight shell-always"><code>  <span class="p">{</span>
    <span class="nl">_id</span> <span class="p">:</span> <span class="s2">"56cf08e362641ca813b1ae6c"</span><span class="p">,</span>
    <span class="nx">solutions</span> <span class="err">:</span> <span class="p">[</span><span class="s2">"6c641c8a81e3625f03b1ae6c"</span><span class="p">,</span> <span class="s2">"3b1ae6c8a81e3625f06c641c"</span><span class="p">,</span> <span class="s2">"825f06c641c3ba81e361ae6c"</span><span class="p">,</span> <span class="s2">"f06c641c3b8a81e3625ae6c"</span><span class="p">]</span>
  <span class="p">}</span>
</code></pre>

<p>A <strong>Object Relation</strong> is set of pointers to another object.</p>

<p>Select the <strong>Object Relation - [Object Name]</strong> from the dropdown to the object type to point to. The pointers are each a <code>_id</code> of another object. This field can be populated.</p>

<p>The <code>solutions</code> property is an example of a <strong>Object Relation</strong> type in the example.</p>

<h3 id="user-relation">User Relation</h3>

<pre class="highlight shell-always"><code>  <span class="p">{</span>
    <span class="nl">_id</span> <span class="p">:</span> <span class="s2">"56cf08e362641ca813b1ae6c"</span><span class="p">,</span>
    <span class="nx">author</span> <span class="err">:</span> <span class="s2">"8a81e3625f06c641c3b1ae6c"</span>
  <span class="p">}</span>
</code></pre>

<p>A <strong>User Relation</strong> is a pointer to a user object represented by an <code>_id</code> of a user. This field can be populated. The <code>author</code> property is an example of a <code>User Relation</code> in the example.</p>

<h2 id="permissions">Permissions</h2>

<p>With permissions at an Object level, you define who can perform operations on your data. You can do that by choosing a preset or creating your own permission model.</p>

<p><img alt="Permissions Overview" src="images/object-permissions-overview.png" /></p>

<p>We’ve identified some commonly used permission patterns (we refer to them as "policies"). Stamplay provides an easy way to use these patterns on the data your app manages. These policies offer a convenient mechanism for supporting very common security scenarios without having to manage complex settings:</p>

<ul>
  <li>
    <p><strong>Private</strong>: Use this preset if you want to make users’ data inaccessible to other users. Any user will be able to read and write only his or her own information.</p>
  </li>
  <li>
    <p><strong>Public</strong>: When this policy is applied to user profiles, any user can read and write any other user's information. Proceed with caution.</p>
  </li>
  <li>
    <p><strong>Read-only</strong>: Use this preset if you want users to read all profiles, but you don’t want to give them permission to write any profile information.</p>
  </li>
  <li>
    <p><strong>Shared</strong>: This preset is suitable for social apps; any user can modify his or her own profile and can read all other user profiles.</p>
  </li>
</ul>

<p>If the predefined security policies are not flexible enough for your app and you have created your own user roles, you can choose to use role-based security. The settings specify whether a role is allowed to create, read, update or delete items.</p>

<h2 id="create">Create</h2>
<pre class="highlight shell"><code>  curl -X <span class="s2">"POST"</span> <span class="s2">"https://APP-ID.stamplayapp.com/api/cobject/v1/object"</span> <span class="se">\</span>
    -H <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
    -d <span class="s2">"{</span><span class="se">\"</span><span class="s2">title</span><span class="se">\"</span><span class="s2">:</span><span class="se">\"\\\"</span><span class="s2">Hello World</span><span class="se">\\\"\"</span><span class="s2">,</span><span class="se">\"</span><span class="s2">year</span><span class="se">\"</span><span class="s2">:</span><span class="se">\"</span><span class="s2">2016</span><span class="se">\"</span><span class="s2">}"</span>
</code></pre>

<pre class="highlight javascript"><code>  <span class="kd">var</span> <span class="nx">data</span> <span class="o">=</span> <span class="p">{</span>
    <span class="na">title</span> <span class="p">:</span> <span class="s2">"Hello World"</span><span class="p">,</span>
    <span class="na">year</span> <span class="p">:</span> <span class="mi">2016</span>
  <span class="p">}</span>

  <span class="nx">Stamplay</span><span class="p">.</span><span class="nb">Object</span><span class="p">(</span><span class="s2">"movie"</span><span class="p">).</span><span class="nx">save</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">res</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// success</span>
    <span class="p">},</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// error</span>
    <span class="p">})</span>

</code></pre>

<pre class="highlight nodejs"><code>  <span class="kd">var</span> <span class="nx">data</span> <span class="o">=</span> <span class="p">{</span>
    <span class="na">title</span> <span class="p">:</span> <span class="s2">"Hello World"</span><span class="p">,</span>
    <span class="na">year</span> <span class="p">:</span> <span class="mi">2016</span>
  <span class="p">}</span>

  <span class="nx">Stamplay</span><span class="p">.</span><span class="nb">Object</span><span class="p">(</span><span class="s2">"movie"</span><span class="p">).</span><span class="nx">save</span><span class="p">(</span><span class="nx">data</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">res</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// response</span>
  <span class="p">})</span>
</code></pre>

<blockquote>
  <p>The JSON response looks like this.</p>
</blockquote>

<pre class="highlight json"><code><span class="w">
</span><span class="p">{</span><span class="w">
   </span><span class="nt">"__v"</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="w">
   </span><span class="nt">"title"</span><span class="p">:</span><span class="s2">"Hello World"</span><span class="p">,</span><span class="w">
   </span><span class="nt">"year"</span><span class="p">:</span><span class="mi">2016</span><span class="p">,</span><span class="w">
   </span><span class="nt">"appId"</span><span class="p">:</span><span class="s2">"stamplay-docs"</span><span class="p">,</span><span class="w">
   </span><span class="nt">"cobjectId"</span><span class="p">:</span><span class="s2">"movie"</span><span class="p">,</span><span class="w">
   </span><span class="nt">"_id"</span><span class="p">:</span><span class="s2">"570edb76fc24091627e82086"</span><span class="p">,</span><span class="w">
   </span><span class="nt">"actions"</span><span class="p">:{</span><span class="w">
      </span><span class="nt">"comments"</span><span class="p">:[],</span><span class="w">
      </span><span class="nt">"ratings"</span><span class="p">:{</span><span class="w">
         </span><span class="nt">"users"</span><span class="p">:[],</span><span class="w">
         </span><span class="nt">"avg"</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="w">
         </span><span class="nt">"total"</span><span class="p">:</span><span class="mi">0</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="nt">"votes"</span><span class="p">:{</span><span class="w">
         </span><span class="nt">"users_downvote"</span><span class="p">:[],</span><span class="w">
         </span><span class="nt">"users_upvote"</span><span class="p">:[],</span><span class="w">
         </span><span class="nt">"users"</span><span class="p">:[],</span><span class="w">
         </span><span class="nt">"total"</span><span class="p">:</span><span class="mi">0</span><span class="w">
      </span><span class="p">}</span><span class="w">
   </span><span class="p">},</span><span class="w">
   </span><span class="nt">"dt_update"</span><span class="p">:</span><span class="s2">"2016-04-13T23:51:18.170Z"</span><span class="p">,</span><span class="w">
   </span><span class="nt">"dt_create"</span><span class="p">:</span><span class="s2">"2016-04-13T23:51:18.170Z"</span><span class="p">,</span><span class="w">
   </span><span class="nt">"id"</span><span class="p">:</span><span class="s2">"570edb76fc24091627e82086"</span><span class="w">
</span><span class="p">}</span><span class="w">

</span></code></pre>

<p>To create new object data for a particular model, send the data in the body of a<code>POST</code> request to the Object resource, specifying the object type in the URI.</p>

<aside class="notice">
  <p>The data sent in the request body must validate against the schema defined for the particular object resource being saved.</p>
</aside>

<h2 id="fetch-objects">Fetch Objects</h2>

<p>Retrieve an individual object, all objects, or any matching specific criteria of a particular model type.</p>

<h3 id="fetch-object-by-id">Fetch Object By Id</h3>

<pre class="highlight shell"><code>  curl -X <span class="s2">"GET"</span> <span class="s2">"https://APP-ID.stamplayapp.com/api/cobject/v1/movie/:object_id"</span>
</code></pre>

<pre class="highlight javascript"><code>  <span class="nx">Stamplay</span><span class="p">.</span><span class="nb">Object</span><span class="p">(</span><span class="s2">"movie"</span><span class="p">).</span><span class="nx">get</span><span class="p">({</span> <span class="na">_id</span> <span class="p">:</span> <span class="s2">"object_id"</span><span class="p">})</span>
    <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">res</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// success</span>
    <span class="p">},</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// error</span>
    <span class="p">})</span>
</code></pre>

<pre class="highlight nodejs"><code>  <span class="nx">Stamplay</span><span class="p">.</span><span class="nb">Object</span><span class="p">(</span><span class="s2">"movie"</span><span class="p">).</span><span class="nx">get</span><span class="p">({</span> <span class="na">_id</span> <span class="p">:</span> <span class="s2">"object_id"</span><span class="p">},</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">res</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// response</span>
  <span class="p">})</span>
</code></pre>

<blockquote>
  <p>The JSON response looks like this.</p>
</blockquote>

<pre class="highlight json"><code><span class="w">
</span><span class="p">{</span><span class="w">
   </span><span class="nt">"data"</span><span class="p">:[</span><span class="w">
      </span><span class="p">{</span><span class="w">
         </span><span class="nt">"_id"</span><span class="p">:</span><span class="s2">"570edb76fc24091627e82086"</span><span class="p">,</span><span class="w">
         </span><span class="nt">"title"</span><span class="p">:</span><span class="s2">"Hello World"</span><span class="p">,</span><span class="w">
         </span><span class="nt">"year"</span><span class="p">:</span><span class="mi">2016</span><span class="p">,</span><span class="w">
         </span><span class="nt">"appId"</span><span class="p">:</span><span class="s2">"stamplay-docs"</span><span class="p">,</span><span class="w">
         </span><span class="nt">"cobjectId"</span><span class="p">:</span><span class="s2">"movie"</span><span class="p">,</span><span class="w">
         </span><span class="nt">"actions"</span><span class="p">:{</span><span class="w">
            </span><span class="nt">"comments"</span><span class="p">:[],</span><span class="w">
            </span><span class="nt">"ratings"</span><span class="p">:{</span><span class="w">
               </span><span class="nt">"users"</span><span class="p">:[],</span><span class="w">
               </span><span class="nt">"avg"</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="w">
               </span><span class="nt">"total"</span><span class="p">:</span><span class="mi">0</span><span class="w">
            </span><span class="p">},</span><span class="w">
            </span><span class="nt">"votes"</span><span class="p">:{</span><span class="w">
               </span><span class="nt">"users_downvote"</span><span class="p">:[],</span><span class="w">
               </span><span class="nt">"users_upvote"</span><span class="p">:[],</span><span class="w">
               </span><span class="nt">"users"</span><span class="p">:[],</span><span class="w">
               </span><span class="nt">"total"</span><span class="p">:</span><span class="mi">0</span><span class="w">
            </span><span class="p">}</span><span class="w">
         </span><span class="p">},</span><span class="w">
         </span><span class="nt">"dt_update"</span><span class="p">:</span><span class="s2">"2016-04-13T23:51:18.170Z"</span><span class="p">,</span><span class="w">
         </span><span class="nt">"dt_create"</span><span class="p">:</span><span class="s2">"2016-04-13T23:51:18.170Z"</span><span class="p">,</span><span class="w">
         </span><span class="nt">"__v"</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="w">
         </span><span class="nt">"id"</span><span class="p">:</span><span class="s2">"570edb76fc24091627e82086"</span><span class="w">
      </span><span class="p">}</span><span class="w">
   </span><span class="p">],</span><span class="w">
   </span><span class="nt">"pagination"</span><span class="p">:{</span><span class="w">
      </span><span class="nt">"page"</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="w">
      </span><span class="nt">"per_page"</span><span class="p">:</span><span class="mi">20</span><span class="p">,</span><span class="w">
      </span><span class="nt">"total_pages"</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="w">
      </span><span class="nt">"total_elements"</span><span class="p">:</span><span class="mi">1</span><span class="w">
   </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">

</span></code></pre>

<p>To fetch a single object, send a <code>GET</code> request to the Object resource with the object's <code>_id</code> in the URI.</p>

<p>The object type for the example is <code>movie</code>.</p>

<table>
  <thead>
    <tr>
      <th>Attribute</th>
      <th> </th>
      <th style="text-align: center">Optional</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>object_id</code></td>
      <td>the Stamplay <code>_id</code> of the object to retrieve</td>
      <td style="text-align: center"><i class="unchecked"></i></td>
    </tr>
  </tbody>
</table>

<h3 id="all-objects">All Objects</h3>

<pre class="highlight shell"><code>  curl -X <span class="s2">"GET"</span> <span class="s2">"https://APP-ID.stamplayapp.com/api/cobject/v1/movie"</span>
</code></pre>

<pre class="highlight javascript"><code>  <span class="nx">Stamplay</span><span class="p">.</span><span class="nb">Object</span><span class="p">(</span><span class="s2">"movie"</span><span class="p">).</span><span class="nx">get</span><span class="p">({})</span>
    <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">res</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// success</span>
    <span class="p">},</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// error</span>
    <span class="p">})</span>
</code></pre>

<pre class="highlight nodejs"><code>  <span class="nx">Stamplay</span><span class="p">.</span><span class="nb">Object</span><span class="p">(</span><span class="s2">"movie"</span><span class="p">).</span><span class="nx">get</span><span class="p">({},</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">res</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// response</span>
  <span class="p">})</span>
</code></pre>

<blockquote>
  <p>The JSON response looks like this.</p>
</blockquote>

<pre class="highlight json"><code><span class="w">
</span><span class="p">{</span><span class="w">  
   </span><span class="nt">"data"</span><span class="p">:[</span><span class="w">  
      </span><span class="p">{</span><span class="w">  
         </span><span class="nt">"_id"</span><span class="p">:</span><span class="s2">"570edb76fc24091627e82086"</span><span class="p">,</span><span class="w">
         </span><span class="nt">"title"</span><span class="p">:</span><span class="s2">"Hello World"</span><span class="p">,</span><span class="w">
         </span><span class="nt">"year"</span><span class="p">:</span><span class="mi">2016</span><span class="p">,</span><span class="w">
         </span><span class="nt">"appId"</span><span class="p">:</span><span class="s2">"stamplay-docs"</span><span class="p">,</span><span class="w">
         </span><span class="nt">"cobjectId"</span><span class="p">:</span><span class="s2">"movie"</span><span class="p">,</span><span class="w">
         </span><span class="nt">"actions"</span><span class="p">:{</span><span class="w"> </span><span class="err">...</span><span class="w"> </span><span class="p">},</span><span class="w">
         </span><span class="nt">"dt_update"</span><span class="p">:</span><span class="s2">"2016-04-13T23:51:18.170Z"</span><span class="p">,</span><span class="w">
         </span><span class="nt">"dt_create"</span><span class="p">:</span><span class="s2">"2016-04-13T23:51:18.170Z"</span><span class="p">,</span><span class="w">
         </span><span class="nt">"__v"</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="w">
         </span><span class="nt">"id"</span><span class="p">:</span><span class="s2">"570edb76fc24091627e82086"</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="p">{</span><span class="w">  
         </span><span class="nt">"_id"</span><span class="p">:</span><span class="s2">"570edcc7fc24091627e82087"</span><span class="p">,</span><span class="w">
         </span><span class="nt">"title"</span><span class="p">:</span><span class="s2">"Goodbye World"</span><span class="p">,</span><span class="w">
         </span><span class="nt">"year"</span><span class="p">:</span><span class="mi">2014</span><span class="p">,</span><span class="w">
         </span><span class="nt">"appId"</span><span class="p">:</span><span class="s2">"stamplay-docs"</span><span class="p">,</span><span class="w">
         </span><span class="nt">"cobjectId"</span><span class="p">:</span><span class="s2">"movie"</span><span class="p">,</span><span class="w">
         </span><span class="nt">"actions"</span><span class="p">:{</span><span class="w"> </span><span class="err">...</span><span class="w"> </span><span class="p">},</span><span class="w">
         </span><span class="nt">"dt_update"</span><span class="p">:</span><span class="s2">"2016-04-13T23:56:55.060Z"</span><span class="p">,</span><span class="w">
         </span><span class="nt">"dt_create"</span><span class="p">:</span><span class="s2">"2016-04-13T23:56:55.060Z"</span><span class="p">,</span><span class="w">
         </span><span class="nt">"__v"</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="w">
         </span><span class="nt">"id"</span><span class="p">:</span><span class="s2">"570edcc7fc24091627e82087"</span><span class="w">
      </span><span class="p">}</span><span class="w">
      </span><span class="err">...</span><span class="w">
      </span><span class="err">...</span><span class="mi">12</span><span class="w"> </span><span class="err">more</span><span class="w">
      </span><span class="err">...</span><span class="w">
   </span><span class="p">],</span><span class="w">
   </span><span class="nt">"pagination"</span><span class="p">:{</span><span class="w">  
      </span><span class="nt">"page"</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="w">
      </span><span class="nt">"per_page"</span><span class="p">:</span><span class="mi">20</span><span class="p">,</span><span class="w">
      </span><span class="nt">"total_pages"</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="w">
      </span><span class="nt">"total_elements"</span><span class="p">:</span><span class="mi">14</span><span class="w">
   </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">

</span></code></pre>

<p>To fetch all objects, send a <code>GET</code> request to the Object resource.</p>

<p>The object type for the example is <code>movie</code>.</p>

<h3 id="query-objects">Query Objects</h3>

<pre class="highlight shell"><code>  curl -X <span class="s2">"GET"</span> <span class="s2">"https://APP-ID.stamplayapp.com/api/cobject/v1/movie?year=1998"</span>
</code></pre>

<pre class="highlight javascript"><code>  <span class="kd">var</span> <span class="nx">query</span> <span class="o">=</span> <span class="p">{</span>
    <span class="na">year</span> <span class="p">:</span> <span class="mi">1998</span>
  <span class="p">}</span>

  <span class="nx">Stamplay</span><span class="p">.</span><span class="nb">Object</span><span class="p">(</span><span class="s2">"movie"</span><span class="p">).</span><span class="nx">get</span><span class="p">(</span><span class="nx">query</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">res</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// success</span>
    <span class="p">},</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// error</span>
    <span class="p">})</span>
</code></pre>

<pre class="highlight nodejs"><code>  <span class="kd">var</span> <span class="nx">query</span> <span class="o">=</span> <span class="p">{</span>
    <span class="na">year</span> <span class="p">:</span> <span class="mi">1998</span>
  <span class="p">}</span>

  <span class="nx">Stamplay</span><span class="p">.</span><span class="nb">Object</span><span class="p">(</span><span class="s2">"movie"</span><span class="p">).</span><span class="nx">get</span><span class="p">(</span><span class="nx">query</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">res</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// response</span>
  <span class="p">})</span>
</code></pre>

<blockquote>
  <p>The JSON response looks like this.</p>
</blockquote>

<pre class="highlight json"><code><span class="w">
</span><span class="p">{</span><span class="w">  
   </span><span class="nt">"data"</span><span class="p">:[</span><span class="w">  
      </span><span class="p">{</span><span class="w">  
         </span><span class="nt">"_id"</span><span class="p">:</span><span class="s2">"570edb76fc24091627e82086"</span><span class="p">,</span><span class="w">
         </span><span class="nt">"title"</span><span class="p">:</span><span class="s2">"Goodbye 90's"</span><span class="p">,</span><span class="w">
         </span><span class="nt">"year"</span><span class="p">:</span><span class="mi">1998</span><span class="p">,</span><span class="w">
         </span><span class="nt">"appId"</span><span class="p">:</span><span class="s2">"stamplay-docs"</span><span class="p">,</span><span class="w">
         </span><span class="nt">"cobjectId"</span><span class="p">:</span><span class="s2">"movie"</span><span class="p">,</span><span class="w">
         </span><span class="nt">"actions"</span><span class="p">:{</span><span class="w"> </span><span class="err">...</span><span class="w"> </span><span class="p">},</span><span class="w">
         </span><span class="nt">"dt_update"</span><span class="p">:</span><span class="s2">"2016-04-13T23:51:18.170Z"</span><span class="p">,</span><span class="w">
         </span><span class="nt">"dt_create"</span><span class="p">:</span><span class="s2">"2016-04-13T23:51:18.170Z"</span><span class="p">,</span><span class="w">
         </span><span class="nt">"__v"</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="w">
         </span><span class="nt">"id"</span><span class="p">:</span><span class="s2">"570edb76fc24091627e82086"</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="p">{</span><span class="w">  
         </span><span class="nt">"_id"</span><span class="p">:</span><span class="s2">"570edcc7fc24091627e82087"</span><span class="p">,</span><span class="w">
         </span><span class="nt">"title"</span><span class="p">:</span><span class="s2">"Again not again."</span><span class="p">,</span><span class="w">
         </span><span class="nt">"year"</span><span class="p">:</span><span class="mi">1998</span><span class="p">,</span><span class="w">
         </span><span class="nt">"appId"</span><span class="p">:</span><span class="s2">"stamplay-docs"</span><span class="p">,</span><span class="w">
         </span><span class="nt">"cobjectId"</span><span class="p">:</span><span class="s2">"movie"</span><span class="p">,</span><span class="w">
         </span><span class="nt">"actions"</span><span class="p">:{</span><span class="w"> </span><span class="err">...</span><span class="w"> </span><span class="p">},</span><span class="w">
         </span><span class="nt">"dt_update"</span><span class="p">:</span><span class="s2">"2016-04-13T23:56:55.060Z"</span><span class="p">,</span><span class="w">
         </span><span class="nt">"dt_create"</span><span class="p">:</span><span class="s2">"2016-04-13T23:56:55.060Z"</span><span class="p">,</span><span class="w">
         </span><span class="nt">"__v"</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="w">
         </span><span class="nt">"id"</span><span class="p">:</span><span class="s2">"570edcc7fc24091627e82087"</span><span class="w">
      </span><span class="p">}</span><span class="w">
   </span><span class="p">],</span><span class="w">
   </span><span class="nt">"pagination"</span><span class="p">:{</span><span class="w">  
      </span><span class="nt">"page"</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="w">
      </span><span class="nt">"per_page"</span><span class="p">:</span><span class="mi">20</span><span class="p">,</span><span class="w">
      </span><span class="nt">"total_pages"</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="w">
      </span><span class="nt">"total_elements"</span><span class="p">:</span><span class="mi">2</span><span class="w">
   </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">

</span></code></pre>

<p>To fetch all objects that match a certain parameters, send a <code>GET</code> request to the Object resource with any parameters to match in the request body.</p>

<p>For more advanced queries, visit the <a href="#advanced-queries">Advanced Queries</a> section for more information.</p>

<p>The object type for the example is <code>movie</code>.</p>

<h3 id="find-by-current-user">Find By Current User</h3>

<pre class="highlight shell"><code>  curl -X <span class="s2">"GET"</span> <span class="s2">"https://APP-ID.stamplayapp.com/api/cobject/v1/movie/find/director"</span>
</code></pre>

<pre class="highlight javascript"><code>
  <span class="c1">// default attribute is owner is no arguments are passed to method</span>

  <span class="nx">Stamplay</span><span class="p">.</span><span class="nb">Object</span><span class="p">(</span><span class="s2">"movie"</span><span class="p">).</span><span class="nx">findByCurrentUser</span><span class="p">(</span><span class="s1">'director'</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">res</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// Success</span>
    <span class="p">},</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// Error</span>
    <span class="p">}))</span>
</code></pre>

<pre class="highlight nodejs"><code>  <span class="c1">// no method</span>
</code></pre>

<blockquote>
  <p>The JSON response looks like this.</p>
</blockquote>

<pre class="highlight json"><code><span class="w">
</span><span class="p">{</span><span class="w">  
   </span><span class="nt">"data"</span><span class="p">:[</span><span class="w">  
      </span><span class="p">{</span><span class="w">  
         </span><span class="nt">"_id"</span><span class="p">:</span><span class="s2">"570edb76fc24091627e82086"</span><span class="p">,</span><span class="w">
         </span><span class="nt">"title"</span><span class="p">:</span><span class="s2">"Hello World"</span><span class="p">,</span><span class="w">
         </span><span class="nt">"year"</span><span class="p">:</span><span class="mi">2016</span><span class="p">,</span><span class="w">
         </span><span class="nt">"director"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"5503de76fc24091627e82568"</span><span class="p">,</span><span class="w">
         </span><span class="nt">"appId"</span><span class="p">:</span><span class="s2">"stamplay-docs"</span><span class="p">,</span><span class="w">
         </span><span class="nt">"cobjectId"</span><span class="p">:</span><span class="s2">"movie"</span><span class="p">,</span><span class="w">
         </span><span class="nt">"actions"</span><span class="p">:{</span><span class="w"> </span><span class="err">...</span><span class="w"> </span><span class="p">},</span><span class="w">
         </span><span class="nt">"dt_update"</span><span class="p">:</span><span class="s2">"2016-04-13T23:51:18.170Z"</span><span class="p">,</span><span class="w">
         </span><span class="nt">"dt_create"</span><span class="p">:</span><span class="s2">"2016-04-13T23:51:18.170Z"</span><span class="p">,</span><span class="w">
         </span><span class="nt">"__v"</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="w">
         </span><span class="nt">"id"</span><span class="p">:</span><span class="s2">"570edb76fc24091627e82086"</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="p">{</span><span class="w">  
         </span><span class="nt">"_id"</span><span class="p">:</span><span class="s2">"570edcc7fc24091627e82087"</span><span class="p">,</span><span class="w">
         </span><span class="nt">"title"</span><span class="p">:</span><span class="s2">"Goodbye World"</span><span class="p">,</span><span class="w">
         </span><span class="nt">"year"</span><span class="p">:</span><span class="mi">2014</span><span class="p">,</span><span class="w">
         </span><span class="nt">"director"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"5503de76fc24091627e82568"</span><span class="p">,</span><span class="w">
         </span><span class="nt">"appId"</span><span class="p">:</span><span class="s2">"stamplay-docs"</span><span class="p">,</span><span class="w">
         </span><span class="nt">"cobjectId"</span><span class="p">:</span><span class="s2">"movie"</span><span class="p">,</span><span class="w">
         </span><span class="nt">"actions"</span><span class="p">:{</span><span class="w"> </span><span class="err">...</span><span class="w"> </span><span class="p">},</span><span class="w">
         </span><span class="nt">"dt_update"</span><span class="p">:</span><span class="s2">"2016-04-13T23:56:55.060Z"</span><span class="p">,</span><span class="w">
         </span><span class="nt">"dt_create"</span><span class="p">:</span><span class="s2">"2016-04-13T23:56:55.060Z"</span><span class="p">,</span><span class="w">
         </span><span class="nt">"__v"</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="w">
         </span><span class="nt">"id"</span><span class="p">:</span><span class="s2">"570edcc7fc24091627e82087"</span><span class="w">
      </span><span class="p">}</span><span class="w">
   </span><span class="p">],</span><span class="w">
   </span><span class="nt">"pagination"</span><span class="p">:{</span><span class="w">  
      </span><span class="nt">"page"</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="w">
      </span><span class="nt">"per_page"</span><span class="p">:</span><span class="mi">20</span><span class="p">,</span><span class="w">
      </span><span class="nt">"total_pages"</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="w">
      </span><span class="nt">"total_elements"</span><span class="p">:</span><span class="mi">2</span><span class="w">
   </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">

</span></code></pre>

<p>To find any records whose field value is equal to the current user's <code>_id</code>, you can use the find by owner resource to simplify querying through different fields.</p>

<p>Make a <code>GET</code> request to the Object resource for the object model. Specifying the attribute in the resource URI.</p>

<p>The object type for the example is <code>movie</code>.</p>

<h2 id="update-objects">Update Objects</h2>

<p>To update an object record partially, or completely overwrite the existing record.</p>

<h3 id="partial-update">Partial Update</h3>

<pre class="highlight shell"><code>  curl -X <span class="s2">"PATCH"</span> <span class="s2">"https://APP-ID.stamplayapp.com/api/cobject/v1/movie/:object_id"</span> <span class="se">\</span>
    -H <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
    -d <span class="s2">"{</span><span class="se">\"</span><span class="s2">title</span><span class="se">\"</span><span class="s2">:</span><span class="se">\"</span><span class="s2">Goodbye World</span><span class="se">\"</span><span class="s2">}"</span>
</code></pre>

<pre class="highlight javascript"><code>  <span class="kd">var</span> <span class="nx">data</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">"title"</span> <span class="p">:</span> <span class="s2">"Goodbye World"</span>
  <span class="p">}</span>

  <span class="nx">Stamplay</span><span class="p">.</span><span class="nb">Object</span><span class="p">(</span><span class="s2">"movie"</span><span class="p">).</span><span class="nx">patch</span><span class="p">(</span><span class="s2">"object_id"</span><span class="p">,</span> <span class="nx">data</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">res</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// success</span>
    <span class="p">},</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// error</span>
    <span class="p">})</span>
</code></pre>

<pre class="highlight nodejs"><code>  <span class="kd">var</span> <span class="nx">data</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">"title"</span> <span class="p">:</span> <span class="s2">"Goodbye World"</span>
  <span class="p">}</span>

  <span class="nx">Stamplay</span><span class="p">.</span><span class="nb">Object</span><span class="p">(</span><span class="s2">"movie"</span><span class="p">).</span><span class="nx">patch</span><span class="p">(</span><span class="s2">"object_id"</span><span class="p">,</span> <span class="nx">data</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">res</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// response</span>
  <span class="p">})</span>
</code></pre>

<blockquote>
  <p>The JSON response looks like this.</p>
</blockquote>

<pre class="highlight json"><code><span class="w">
</span><span class="p">{</span><span class="w">  
   </span><span class="nt">"_id"</span><span class="p">:</span><span class="s2">"570edb76fc24091627e82086"</span><span class="p">,</span><span class="w">
   </span><span class="nt">"title"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Goodbye World"</span><span class="p">,</span><span class="w">
   </span><span class="nt">"year"</span><span class="p">:</span><span class="mi">2016</span><span class="p">,</span><span class="w">
   </span><span class="nt">"director"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"5503de76fc24091627e82568"</span><span class="p">,</span><span class="w">
   </span><span class="nt">"appId"</span><span class="p">:</span><span class="s2">"stamplay-docs"</span><span class="p">,</span><span class="w">
   </span><span class="nt">"cobjectId"</span><span class="p">:</span><span class="s2">"movie"</span><span class="p">,</span><span class="w">
   </span><span class="nt">"actions"</span><span class="p">:{</span><span class="w"> </span><span class="err">...</span><span class="w"> </span><span class="p">},</span><span class="w">
   </span><span class="nt">"dt_update"</span><span class="p">:</span><span class="s2">"2016-04-13T23:51:18.170Z"</span><span class="p">,</span><span class="w">
   </span><span class="nt">"dt_create"</span><span class="p">:</span><span class="s2">"2016-04-13T23:51:18.170Z"</span><span class="p">,</span><span class="w">
   </span><span class="nt">"__v"</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="w">
   </span><span class="nt">"id"</span><span class="p">:</span><span class="s2">"570edb76fc24091627e82086"</span><span class="w">
</span><span class="p">}</span><span class="w">
      
</span></code></pre>

<p>To make a partial update to an object record, perform a <code>PATCH</code> request to the Object API resource with any fields to update on the stored record in the request body.</p>

<table>
  <thead>
    <tr>
      <th>Attribute</th>
      <th> </th>
      <th style="text-align: center">Optional</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>object_id</code></td>
      <td>the Stamplay <code>_id</code> of the object to update</td>
      <td style="text-align: center"><i class="unchecked"></i></td>
    </tr>
  </tbody>
</table>

<p>The object type for the example is <code>movie</code>.</p>

<h3 id="complete-update">Complete Update</h3>

<pre class="highlight shell"><code>  curl -X <span class="s2">"PUT"</span> <span class="s2">"https://APP-ID.stamplayapp.com/api/cobject/v1/movie/:object_id"</span> <span class="se">\</span>
    -H <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
    -d <span class="s2">"{</span><span class="se">\"</span><span class="s2">title</span><span class="se">\"</span><span class="s2">:</span><span class="se">\"</span><span class="s2">Goodbye World</span><span class="se">\"</span><span class="s2">,</span><span class="se">\"</span><span class="s2">year</span><span class="se">\"</span><span class="s2">:</span><span class="se">\"</span><span class="s2">2001</span><span class="se">\"</span><span class="s2">}"</span>
</code></pre>

<pre class="highlight javascript"><code>  <span class="kd">var</span> <span class="nx">data</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">"title"</span> <span class="p">:</span> <span class="s2">"Goodbye World"</span>
  <span class="p">}</span>

  <span class="nx">Stamplay</span><span class="p">.</span><span class="nb">Object</span><span class="p">(</span><span class="s2">"movie"</span><span class="p">).</span><span class="nx">update</span><span class="p">(</span><span class="s2">"object_id"</span><span class="p">,</span> <span class="nx">data</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">res</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// success</span>
    <span class="p">},</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// error</span>
    <span class="p">})</span>
</code></pre>

<pre class="highlight nodejs"><code>  <span class="kd">var</span> <span class="nx">data</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">"title"</span> <span class="p">:</span> <span class="s2">"Goodbye World"</span>
  <span class="p">}</span>

  <span class="nx">Stamplay</span><span class="p">.</span><span class="nb">Object</span><span class="p">(</span><span class="s2">"movie"</span><span class="p">).</span><span class="nx">update</span><span class="p">(</span><span class="s2">"object_id"</span><span class="p">,</span> <span class="nx">data</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">res</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// response</span>
  <span class="p">})</span>
</code></pre>

<blockquote>
  <p>The JSON response looks like this.</p>
</blockquote>

<pre class="highlight json"><code><span class="w">
</span><span class="p">{</span><span class="w">  
   </span><span class="nt">"_id"</span><span class="p">:</span><span class="s2">"570edb76fc24091627e82086"</span><span class="p">,</span><span class="w">
   </span><span class="nt">"title"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Goodbye World"</span><span class="p">,</span><span class="w">
   </span><span class="nt">"year"</span><span class="p">:</span><span class="mi">2016</span><span class="p">,</span><span class="w">
   </span><span class="nt">"director"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"5503de76fc24091627e82568"</span><span class="p">,</span><span class="w">
   </span><span class="nt">"appId"</span><span class="p">:</span><span class="s2">"stamplay-docs"</span><span class="p">,</span><span class="w">
   </span><span class="nt">"cobjectId"</span><span class="p">:</span><span class="s2">"movie"</span><span class="p">,</span><span class="w">
   </span><span class="nt">"actions"</span><span class="p">:{</span><span class="w"> </span><span class="err">...</span><span class="w"> </span><span class="p">},</span><span class="w">
   </span><span class="nt">"dt_update"</span><span class="p">:</span><span class="s2">"2016-04-13T23:51:18.170Z"</span><span class="p">,</span><span class="w">
   </span><span class="nt">"dt_create"</span><span class="p">:</span><span class="s2">"2016-04-13T23:51:18.170Z"</span><span class="p">,</span><span class="w">
   </span><span class="nt">"__v"</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="w">
   </span><span class="nt">"id"</span><span class="p">:</span><span class="s2">"570edb76fc24091627e82086"</span><span class="w">
</span><span class="p">}</span><span class="w">
      
</span></code></pre>

<p>To overwrite an object record, perform a <code>PUT</code> request to the Object API resource with a complete represenation to write over the stored record in the request body.</p>

<table>
  <thead>
    <tr>
      <th>Attribute</th>
      <th> </th>
      <th style="text-align: center">Optional</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>object_id</code></td>
      <td>the Stamplay <code>_id</code> of the object to update</td>
      <td style="text-align: center"><i class="unchecked"></i></td>
    </tr>
  </tbody>
</table>

<h2 id="remove-objects">Remove Objects</h2>

<p>To remove an object record, send a <code>DELETE</code> request with the <code>_id</code> of the record to remove in the Object API resource URI.</p>

<pre class="highlight shell"><code>  curl -X <span class="s2">"DELETE"</span> <span class="s2">"https://APP-ID.stamplayapp.com/api/cobject/v1/movie/:object_id"</span>
</code></pre>

<pre class="highlight javascript"><code>  <span class="nx">Stamplay</span><span class="p">.</span><span class="nb">Object</span><span class="p">(</span><span class="s2">"movie"</span><span class="p">).</span><span class="nx">remove</span><span class="p">(</span><span class="s2">"object_id"</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">res</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// success</span>
    <span class="p">},</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// error</span>
    <span class="p">})</span>
</code></pre>

<pre class="highlight nodejs"><code>  <span class="nx">Stamplay</span><span class="p">.</span><span class="nb">Object</span><span class="p">(</span><span class="s2">"movie"</span><span class="p">).</span><span class="nx">remove</span><span class="p">(</span><span class="s2">"object_id"</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">res</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// response</span>
  <span class="p">})</span>
</code></pre>

<blockquote>
  <p>The JSON response will look like this.</p>
</blockquote>

<pre class="highlight json"><code><span class="w">
</span><span class="p">{</span><span class="w">
   </span><span class="nt">"_id"</span><span class="p">:</span><span class="s2">"570edb76fc24091627e82086"</span><span class="p">,</span><span class="w">
   </span><span class="nt">"title"</span><span class="p">:</span><span class="s2">"Hello World"</span><span class="p">,</span><span class="w">
   </span><span class="nt">"year"</span><span class="p">:</span><span class="mi">2016</span><span class="p">,</span><span class="w">
   </span><span class="nt">"appId"</span><span class="p">:</span><span class="s2">"stamplay-docs"</span><span class="p">,</span><span class="w">
   </span><span class="nt">"cobjectId"</span><span class="p">:</span><span class="s2">"movie"</span><span class="p">,</span><span class="w">
   </span><span class="nt">"__v"</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="w">
   </span><span class="nt">"actions"</span><span class="p">:{</span><span class="w">
      </span><span class="err">...</span><span class="w">
   </span><span class="p">},</span><span class="w">
   </span><span class="nt">"dt_update"</span><span class="p">:</span><span class="s2">"2016-04-13T23:51:18.170Z"</span><span class="p">,</span><span class="w">
   </span><span class="nt">"dt_create"</span><span class="p">:</span><span class="s2">"2016-04-13T23:51:18.170Z"</span><span class="p">,</span><span class="w">
   </span><span class="nt">"id"</span><span class="p">:</span><span class="s2">"570edb76fc24091627e82086"</span><span class="w">
</span><span class="p">}</span><span class="w">

</span></code></pre>

<table>
  <thead>
    <tr>
      <th>Attribute</th>
      <th> </th>
      <th style="text-align: center">Optional</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>object_id</code></td>
      <td>the Stamplay <code>_id</code> of the object to remove</td>
      <td style="text-align: center"><i class="unchecked"></i></td>
    </tr>
  </tbody>
</table>

<h2 id="relationships">Relationships</h2>

<p>Data relationships are pointers from one record to another.</p>

<h3 id="user-relationship">User Relationship</h3>

<pre class="highlight shell"><code>  curl -X <span class="s2">"PATCH"</span> <span class="s2">"https://APP-ID.stamplayapp.com/api/cobject/v1/movie/:object_id"</span> <span class="se">\</span>
    -H <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
    -d <span class="s2">"{</span><span class="se">\"</span><span class="s2">director</span><span class="se">\"</span><span class="s2">:</span><span class="se">\"</span><span class="s2">56cf08e362641ca813b1ae6c</span><span class="se">\"</span><span class="s2">}"</span>
</code></pre>

<pre class="highlight javascript"><code>  <span class="nx">Stamplay</span><span class="p">.</span><span class="nb">Object</span><span class="p">(</span><span class="s2">"movie"</span><span class="p">).</span><span class="nx">patch</span><span class="p">(</span><span class="s2">"object_id"</span><span class="p">,</span> <span class="p">{</span> <span class="na">director</span><span class="p">:</span> <span class="s2">"56cf08e362641ca813b1ae6c"</span> <span class="p">})</span>
    <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">res</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// success</span>
    <span class="p">},</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// error</span>
    <span class="p">})</span>
</code></pre>

<pre class="highlight nodejs"><code>  <span class="nx">Stamplay</span><span class="p">.</span><span class="nb">Object</span><span class="p">(</span><span class="s2">"movie"</span><span class="p">).</span><span class="nx">patch</span><span class="p">(</span><span class="s2">"object_id"</span><span class="p">,</span> <span class="p">{</span> <span class="na">director</span><span class="p">:</span> <span class="s2">"56cf08e362641ca813b1ae6c"</span> <span class="p">},</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">res</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// response</span>
  <span class="p">})</span>
</code></pre>

<p>A <strong>User</strong> relationship is a pointer to a user record. This field type is to be set only as an <code>_id</code> of a user record.</p>

<p>This is so it may be populated with the parent object, eliminating the need for a subsequent request to fetch the relationship data. To populate the <code>owner</code> field, include the query parameter <code>populate_owner</code> as <code>true</code> in your request.</p>

<p>The <code>owner</code> property is a default User relationship field on an Object record.</p>

<p>When using the SDK, this field is set if a current user session is in progress, otherwise it is left blank. To add owner's to your Object records when using the REST API or Node.js SDK, set this field as the owner of the record.</p>

<p>To manage these relationships, just update this field to the "_id" of the User to reference in the relationship.</p>

<table>
  <thead>
    <tr>
      <th>Attribute</th>
      <th> </th>
      <th style="text-align: center">Optional</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>object_id</code></td>
      <td>the Stamplay <code>_id</code> of the object to update</td>
      <td style="text-align: center"><i class="unchecked"></i></td>
    </tr>
  </tbody>
</table>

<p>In this example, <code>movie</code> is the object type, and the <code>director</code> field is a User Relationship field.</p>

<h3 id="object-relationships">Object Relationships</h3>

<pre class="highlight shell"><code>  curl -X <span class="s2">"PATCH"</span> <span class="s2">"https://APP-ID.stamplayapp.com/api/cobject/v1/movie/:object_id"</span> <span class="se">\</span>
    -H <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
    -d <span class="s2">"{</span><span class="se">\"</span><span class="s2">characters</span><span class="se">\"</span><span class="s2">:[</span><span class="se">\"</span><span class="s2">57cf08e362641ca813b1ae6c</span><span class="se">\"</span><span class="s2">,</span><span class="se">\"</span><span class="s2">56cf09e362641sa813b1ae6d</span><span class="se">\"</span><span class="s2">,</span><span class="se">\"</span><span class="s2">54cfdae662641ca813b1ae6c</span><span class="se">\"</span><span class="s2">]}"</span>
</code></pre>

<pre class="highlight javascript"><code>  <span class="nx">Stamplay</span><span class="p">.</span><span class="nb">Object</span><span class="p">(</span><span class="s2">"movie"</span><span class="p">).</span><span class="nx">push</span><span class="p">(</span><span class="s2">"object_id"</span><span class="p">,</span> <span class="s2">"characters"</span><span class="p">,</span> <span class="s2">"57cf08e362641ca813b1ae6c"</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">res</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// success</span>
    <span class="p">},</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// error</span>
    <span class="p">})</span>
</code></pre>

<pre class="highlight nodejs"><code>  <span class="kd">var</span> <span class="nx">movieChars</span> <span class="o">=</span> <span class="p">[</span><span class="s2">"57cf08e362641ca813b1ae6c"</span><span class="p">,</span> <span class="s2">"56cf09e362641sa813b1ae6d"</span><span class="p">,</span> <span class="s2">"54cfdae662641ca813b1ae6c"</span><span class="p">]</span>
  <span class="nx">Stamplay</span><span class="p">.</span><span class="nb">Object</span><span class="p">(</span><span class="s2">"movie"</span><span class="p">).</span><span class="nx">patch</span><span class="p">(</span><span class="s2">"object_id"</span><span class="p">,</span> <span class="nx">movieChars</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">res</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// response</span>
  <span class="p">})</span>
</code></pre>
<p>An <strong>Object</strong> relationship is a pointer to another record; specifically a certain type of record as specified when defining the schema.</p>

<p>This field type is to contain only an array of the property <code>_id</code> of a each related record of the relationship type.</p>

<p>This is so it may be populated with the parent object, eliminating the need for a subsequent request to fetch the relationship data. To populate these fields, add the query parameter <code>populate</code> as <code>true</code> to your request.</p>

<p>To manage this relationship field, update the field to represent the collection of object references to store.</p>

<p>The <strong>JavaScript SDK</strong> has a <code>push</code> method to allow an easier method for pushing new relationships onto the array field. See the example in the <code>JavaScript</code> tab, otherwise you will need to manage this manually by sending a complete copy of the field in the request.</p>

<table>
  <thead>
    <tr>
      <th>Attribute</th>
      <th> </th>
      <th style="text-align: center">Optional</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>object_id</code></td>
      <td>the Stamplay <code>_id</code> of the object to add a relationship to</td>
      <td style="text-align: center"><i class="unchecked"></i></td>
    </tr>
  </tbody>
</table>

<p>In this example, <code>movie</code> is the object type, and the <code>characters</code> field is a <strong>Object Relationship</strong> field.</p>

<h3 id="retrieving-related-records">Retrieving Related Records</h3>

<p>To retrieve related records, use the <code>populate</code> parameter in any <code>GET</code> request, and any populable fields will be filled with their respective objects in place of their <code>_id</code>.</p>

<pre class="highlight shell"><code>  curl -X <span class="s2">"GET"</span> <span class="s2">"https://APP-ID.stamplayapp.com/api/cobject/v1/movie?populate=true"</span>
</code></pre>

<pre class="highlight javascript"><code>  <span class="nx">Stamplay</span><span class="p">.</span><span class="nb">Object</span><span class="p">(</span><span class="s2">"movie"</span><span class="p">).</span><span class="nx">get</span><span class="p">({</span> <span class="na">populate</span> <span class="p">:</span> <span class="kc">true</span> <span class="p">})</span>
    <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">res</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// success</span>
    <span class="p">},</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// error</span>
    <span class="p">})</span>
</code></pre>

<pre class="highlight nodejs"><code>  <span class="nx">Stamplay</span><span class="p">.</span><span class="nb">Object</span><span class="p">(</span><span class="s2">"movie"</span><span class="p">).</span><span class="nx">get</span><span class="p">({</span> <span class="na">populate</span> <span class="p">:</span> <span class="kc">true</span> <span class="p">},</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">res</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// response</span>
  <span class="p">})</span>
</code></pre>

<h2 id="advanced-queries">Advanced Queries</h2>

<p>In some cases, retrieving objects by an <code>_id</code> or by simple filter methods aren't powerful enough to specify which objects you want to retrieve from the back-end.</p>

<p>Queries offer a different way to retrieve a list of objects, or users.</p>

<h3 id="introduction">Introduction</h3>

<div class="lang-content shell">
  <p>Advanced query methods use a <code>where</code> parameter set to a JSON query string.</p>
</div>

<div class="lang-content javascript nodejs">
  <p>The <code>Stamplay.Query</code> class uses use a <code>where</code> url parameter set to a JSON query string under the hood.</p>

</div>

<pre class="highlight shell"><code>  ?where<span class="o">={</span> field : <span class="o">{</span> <span class="nv">$query_operator</span> : field_value <span class="o">}</span>
</code></pre>

<pre class="highlight javascript"><code><span class="c1">// Querying Users</span>
  <span class="err">`</span><span class="nx">Stamplay</span><span class="p">.</span><span class="nx">Query</span><span class="p">(</span><span class="s2">"user"</span><span class="p">,</span> <span class="s2">"users"</span><span class="p">).</span><span class="nx">someQueryMethod</span><span class="p">()</span><span class="err">`</span>

<span class="c1">// Querying Objects</span>
  <span class="err">`</span><span class="nx">Stamplay</span><span class="p">.</span><span class="nx">Query</span><span class="p">(</span><span class="s2">"object"</span><span class="p">,</span> <span class="s2">"cobject_id"</span><span class="p">).</span><span class="nx">someQueryMethod</span><span class="p">()</span><span class="err">`</span>

</code></pre>

<pre class="highlight nodejs"><code><span class="c1">// Querying Users</span>
  <span class="err">`</span><span class="nx">Stamplay</span><span class="p">.</span><span class="nx">Query</span><span class="p">(</span><span class="s2">"user"</span><span class="p">,</span> <span class="s2">"users"</span><span class="p">).</span><span class="nx">someQueryMethod</span><span class="p">()</span><span class="err">`</span>

<span class="c1">// Querying Objects</span>
  <span class="err">`</span><span class="nx">Stamplay</span><span class="p">.</span><span class="nx">Query</span><span class="p">(</span><span class="s2">"object"</span><span class="p">,</span> <span class="s2">"cobject_id"</span><span class="p">).</span><span class="nx">someQueryMethod</span><span class="p">()</span><span class="err">`</span>

</code></pre>

<p>The advanced filter methods used are just MongoDB query operators, that Stamplay allow's to be set inside query string on the client side.</p>

<p>The exhaustive list of MongoDB operators available can be found in the API Overview Section under <a href="#advanced-queries">Advanced Queries</a>.</p>

<h3 id="comparing-values">Comparing Values</h3>

<p>When filtering through certain field types, we often need the ability to check if a value falls within a certain range, versus strictly matching.</p>

<p>This often applies to integer value type fields where one might want to return all records where a value is greater than one value but less than or equal to another.</p>

<p>Another scenario, within date fields. We can use the same comparator expressions to see if a date value if before or after, or on another.</p>

<p>When querying a date field, pass in an data <code>ISO</code> string as the value to compare against, or unix timestamp.</p>

<div class="lang-content javascript nodejs">

  <p>The following methods are useful for doing such comparisons within a query:</p>

  <table>
    <thead>
      <tr>
        <th>Method</th>
        <th> </th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><code>greaterThan</code></td>
        <td>check if a value is greater than a given value</td>
      </tr>
      <tr>
        <td><code>greaterThanOrEqual</code></td>
        <td>check if a value is less than a given value</td>
      </tr>
      <tr>
        <td><code>lessThan</code></td>
        <td>check if a value is greater than a given value or equal to</td>
      </tr>
      <tr>
        <td><code>lessThanOrEqual</code></td>
        <td>check if a value is less than a given value or equal to</td>
      </tr>
    </tbody>
  </table>

</div>

<div class="lang-content shell">

  <p>The following operators are useful for doing such comparisons within a query:</p>

  <table>
    <thead>
      <tr>
        <th>Operator</th>
        <th> </th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><code>$gt</code></td>
        <td>check if a value is greater than a given value</td>
      </tr>
      <tr>
        <td><code>$gte</code></td>
        <td>check if a value is less than a given value</td>
      </tr>
      <tr>
        <td><code>$lt</code></td>
        <td>check if a value is greater than a given value or equal to</td>
      </tr>
      <tr>
        <td><code>$lte</code></td>
        <td>check if a value is less than a given value or equal to</td>
      </tr>
    </tbody>
  </table>

</div>

<h4 id="greater-than">Greater Than</h4>

<div class="lang-content shell">
  <p>To retrieve all records where an integer specified is <strong>greater than</strong> another, or where a date is <strong>after</strong> another date, use the <code>$gt</code> mongo operator.</p>
</div>

<div class="lang-content javascript nodejs">
  <p>To retrieve all records where an integer specified is <strong>greater than</strong> another, or where a date is <strong>after</strong> another date, use the <code>greaterThan</code> SDK method.</p>
</div>

<pre class="highlight shell"><code>// returns records where the rating is greater than 4
curl -X <span class="s2">"GET"</span> <span class="s1">'https://APP-ID.stamplayapp.com/api/cobject/v1/movie?where=\{"actions.ratings.total":\{"$gt":4\}\}'</span>

// returns records that were created after January 15, 2015
curl -X <span class="s2">"GET"</span> <span class="s1">'https://APP-ID.stamplayapp.com/api/cobject/v1/movie?where=\{"dt_create":\{"$gt":"2015-01-15T08:00:00.000Z"\}\}'</span>
</code></pre>

<pre class="highlight javascript"><code>  
  <span class="c1">// returns records where the rating is greater than 4</span>
  <span class="nx">Stamplay</span><span class="p">.</span><span class="nx">Query</span><span class="p">(</span><span class="s1">'object'</span><span class="p">,</span><span class="s1">'movie'</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">greaterThan</span><span class="p">(</span><span class="s1">'actions.ratings.total'</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">exec</span><span class="p">()</span>
    <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
      <span class="c1">// success</span>
    <span class="p">},</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// error</span>
    <span class="p">})</span>

  <span class="c1">// returns records that were created after January 15, 2015</span>
  <span class="nx">Stamplay</span><span class="p">.</span><span class="nx">Query</span><span class="p">(</span><span class="s1">'object'</span><span class="p">,</span><span class="s1">'movie'</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">greaterThan</span><span class="p">(</span><span class="s1">'dt_create'</span><span class="p">,</span> <span class="s2">"2015-01-15T08:00:00.000Z"</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">exec</span><span class="p">()</span>
    <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
      <span class="c1">// success</span>
    <span class="p">},</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// error</span>
    <span class="p">})</span>
</code></pre>

<pre class="highlight nodejs"><code>  
  <span class="c1">// returns records where the rating is greater than 4</span>
  <span class="nx">Stamplay</span><span class="p">.</span><span class="nx">Query</span><span class="p">(</span><span class="s1">'object'</span><span class="p">,</span><span class="s1">'movie'</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">greaterThan</span><span class="p">(</span><span class="s1">'actions.ratings.total'</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">exec</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">res</span><span class="p">){</span>
      <span class="c1">// response</span>
    <span class="p">})</span>

  <span class="c1">// returns records that were created after January 15, 2015</span>
  <span class="nx">Stamplay</span><span class="p">.</span><span class="nx">Query</span><span class="p">(</span><span class="s1">'object'</span><span class="p">,</span><span class="s1">'movie'</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">greaterThan</span><span class="p">(</span><span class="s1">'dt_create'</span><span class="p">,</span> <span class="s2">"2015-01-15T08:00:00.000Z"</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">exec</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">res</span><span class="p">){</span>
      <span class="c1">// response</span>
    <span class="p">})</span>

</code></pre>

<h4 id="greater-than-or-equal-to">Greater Than Or Equal To</h4>

<div class="lang-content shell">
  <p>To retrieve all records where an integer specified is <strong>greater than or equal</strong> to another, or where a date is <strong>on or after</strong> another date, use the <code>$gte</code> mongo operator.</p>
</div>

<div class="lang-content javascript nodejs">
  <p>To retrieve all records where an integer specified is <strong>greater than or equal to</strong> another, or where a date is <strong>on or after</strong> another date, use the <code>greaterThanOrEqual</code> SDK method.</p>
</div>

<pre class="highlight shell"><code>  // returns records with a rating of 4 or greater
curl -X <span class="s2">"GET"</span> <span class="s1">'https://APP-ID.stamplayapp.com/api/cobject/v1/movie?where=\{"actions.ratings.total":\{"$gte":4\}\}'</span>

// returns records that were last updated on or after April 11, 2012
curl -X <span class="s2">"GET"</span> <span class="s1">'https://APP-ID.stamplayapp.com/api/cobject/v1/movie?where=\{"dt_update":\{"$gte":"2012-04-11T07:00:00.000Z"\}\}'</span>

</code></pre>

<pre class="highlight javascript"><code>  <span class="c1">// returns records with a rating of 4 or greater</span>
  <span class="nx">Stamplay</span><span class="p">.</span><span class="nx">Query</span><span class="p">(</span><span class="s1">'object'</span><span class="p">,</span><span class="s1">'movie'</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">greaterThanOrEqual</span><span class="p">(</span><span class="s1">'actions.ratings.total'</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">exec</span><span class="p">()</span>
    <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
      <span class="c1">// success</span>
    <span class="p">},</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// error</span>
    <span class="p">})</span>

  <span class="c1">// returns records that were last updated on or after April 11, 2012</span>
  <span class="nx">Stamplay</span><span class="p">.</span><span class="nx">Query</span><span class="p">(</span><span class="s1">'object'</span><span class="p">,</span><span class="s1">'movie'</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">greaterThanOrEqual</span><span class="p">(</span><span class="s1">'dt_update'</span><span class="p">,</span> <span class="s2">"2012-04-11T07:00:00.000Z"</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">exec</span><span class="p">()</span>
    <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
      <span class="c1">// success</span>
    <span class="p">},</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// error</span>
    <span class="p">})</span>

</code></pre>

<pre class="highlight nodejs"><code>
  <span class="c1">// returns records with a rating of 4 or greater</span>
  <span class="nx">Stamplay</span><span class="p">.</span><span class="nx">Query</span><span class="p">(</span><span class="s1">'object'</span><span class="p">,</span><span class="s1">'movie'</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">greaterThanOrEqual</span><span class="p">(</span><span class="s1">'actions.ratings.total'</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">exec</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">res</span><span class="p">){</span>
      <span class="c1">// response</span>
    <span class="p">})</span>

  <span class="c1">// returns records that were last updated on or after April 11, 2012</span>
  <span class="nx">Stamplay</span><span class="p">.</span><span class="nx">Query</span><span class="p">(</span><span class="s1">'object'</span><span class="p">,</span><span class="s1">'movie'</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">greaterThanOrEqual</span><span class="p">(</span><span class="s1">'dt_update'</span><span class="p">,</span> <span class="s2">"2012-04-11T07:00:00.000Z"</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">exec</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">res</span><span class="p">){</span>
      <span class="c1">// response</span>
    <span class="p">})</span>

</code></pre>

<h4 id="less-than">Less Than</h4>

<div class="lang-content shell">
  <p>To retrieve all records where an integer specified is <strong>less</strong> than another, or where a date is <strong>before</strong> another date, use the <code>$lt</code> mongo operator.</p>
</div>

<div class="lang-content javascript nodejs">
  <p>To retrieve all records where an integer specified is <strong>less than</strong> another, or where a date is <strong>before</strong> another date, use the <code>lessThan</code> SDK method.</p>
</div>

<pre class="highlight shell"><code>
  // returns records with a rating of less than 4
  curl -X <span class="s2">"GET"</span> <span class="s1">'https://APP-ID.stamplayapp.com/api/cobject/v1/movie?where=\{"actions.ratings.total":\{"$lt":4\}\}'</span>
  
  // returns records that were created before January 15, 2015
  curl -X <span class="s2">"GET"</span> <span class="s1">'https://APP-ID.stamplayapp.com/api/cobject/v1/movie?where=\{"dt_create":\{"$lt":"2015-01-15T08:00:00.000Z\}\}'</span>

</code></pre>

<pre class="highlight javascript"><code>
  <span class="c1">// returns records with a rating of less than 4</span>
  <span class="nx">Stamplay</span><span class="p">.</span><span class="nx">Query</span><span class="p">(</span><span class="s1">'object'</span><span class="p">,</span><span class="s1">'movie'</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">lessThan</span><span class="p">(</span><span class="s1">'actions.ratings.total'</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">exec</span><span class="p">()</span>
    <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
      <span class="c1">// success</span>
    <span class="p">},</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// error</span>
    <span class="p">})</span>

  <span class="c1">// returns records that were created before January 15, 2015</span>
  <span class="nx">Stamplay</span><span class="p">.</span><span class="nx">Query</span><span class="p">(</span><span class="s1">'object'</span><span class="p">,</span><span class="s1">'movie'</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">lessThan</span><span class="p">(</span><span class="s1">'actions.ratings.total'</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">exec</span><span class="p">()</span>
    <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
      <span class="c1">// success</span>
    <span class="p">},</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// error</span>
    <span class="p">})</span>

</code></pre>

<pre class="highlight nodejs"><code>
  <span class="c1">// returns records with a rating of less than 4</span>
  <span class="nx">Stamplay</span><span class="p">.</span><span class="nx">Query</span><span class="p">(</span><span class="s1">'object'</span><span class="p">,</span><span class="s1">'movie'</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">lessThan</span><span class="p">(</span><span class="s1">'actions.ratings.total'</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">exec</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">res</span><span class="p">){</span>
      <span class="c1">// response</span>
    <span class="p">})</span>

  <span class="c1">// returns records that were created before January 15, 2015</span>
  <span class="nx">Stamplay</span><span class="p">.</span><span class="nx">Query</span><span class="p">(</span><span class="s1">'object'</span><span class="p">,</span><span class="s1">'movie'</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">lessThan</span><span class="p">(</span><span class="s1">'actions.ratings.total'</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">exec</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">res</span><span class="p">){</span>
      <span class="c1">// response</span>
    <span class="p">})</span>

</code></pre>

<h4 id="less-than-or-equal-to">Less Than Or Equal To</h4>

<div class="lang-content shell">
  <p>To retrieve all records where an integer specified is <strong>less than or equal to</strong> another, or where a date is <strong>on or before</strong> another date, use the <code>$lte</code> mongo operator.</p>
</div>

<div class="lang-content javascript nodejs">
  <p>To retrieve all records where an integer specified is <strong>less than or equal to</strong> another, or where a date is <strong>on or before</strong> another date, use the <code>lessThanOrEqual</code> SDK method.</p>
</div>

<pre class="highlight shell"><code>
  // returns records with a rating of 4 or less
  curl -X <span class="s2">"GET"</span> <span class="s1">'https://APP-ID.stamplayapp.com/api/cobject/v1/movie?where=\{"actions.ratings.total":\{"$lte":4\}\}'</span>

  // returns records that were last updated on or before April 11, 2012
  curl -X <span class="s2">"GET"</span> <span class="s1">'https://APP-ID.stamplayapp.com/api/cobject/v1/movie?where=\{"dt_update":\{"$lte":"2012-04-11T07:00:00.000Z"\}\}'</span>

</code></pre>

<pre class="highlight javascript"><code>
  <span class="c1">// returns records with a rating of 4 or less</span>
  <span class="nx">Stamplay</span><span class="p">.</span><span class="nx">Query</span><span class="p">(</span><span class="s1">'object'</span><span class="p">,</span><span class="s1">'movie'</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">lessThanOrEqual</span><span class="p">(</span><span class="s1">'actions.ratings.total'</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">exec</span><span class="p">()</span>
    <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
      <span class="c1">// success</span>
    <span class="p">},</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// error</span>
    <span class="p">})</span>

  <span class="c1">// returns records that were last updated on or before April 11, 2012</span>
  <span class="nx">Stamplay</span><span class="p">.</span><span class="nx">Query</span><span class="p">(</span><span class="s1">'object'</span><span class="p">,</span><span class="s1">'movie'</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">lessThanOrEqual</span><span class="p">(</span><span class="s1">'dt_update'</span><span class="p">,</span> <span class="s2">"2012-04-11T07:00:00.000Z"</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">exec</span><span class="p">()</span>
    <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
      <span class="c1">// success</span>
    <span class="p">},</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// error</span>
    <span class="p">})</span>
</code></pre>

<pre class="highlight nodejs"><code>  
  <span class="c1">// returns records with a rating of 4 or les</span>
  <span class="nx">Stamplay</span><span class="p">.</span><span class="nx">Query</span><span class="p">(</span><span class="s1">'object'</span><span class="p">,</span><span class="s1">'movie'</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">lessThanOrEqual</span><span class="p">(</span><span class="s1">'actions.ratings.total'</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">exec</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">res</span><span class="p">){</span>
      <span class="c1">// response</span>
    <span class="p">})</span>

  <span class="c1">// returns records that were last updated on or before April 11, 2012</span>
  <span class="nx">Stamplay</span><span class="p">.</span><span class="nx">Query</span><span class="p">(</span><span class="s1">'object'</span><span class="p">,</span><span class="s1">'movie'</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">lessThanOrEqual</span><span class="p">(</span><span class="s1">'dt_update'</span><span class="p">,</span> <span class="s2">"2012-04-11T07:00:00.000Z"</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">exec</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">res</span><span class="p">){</span>
      <span class="c1">// response</span>
    <span class="p">})</span>

</code></pre>

<h3 id="selection-and-sorting">Selection and Sorting</h3>

<p>Stamplay provides an easy to use interface for selecing what data from an object is returned, and in what order the records are returned.</p>

<h4 id="selecting-return-fields">Selecting Return Fields</h4>

<pre class="highlight shell"><code>  curl -X <span class="s2">"GET"</span> <span class="s1">'https://APP-ID.stamplayapp.com/api/cobject/v1/movie?select=title,actions.ratings.total'</span>
</code></pre>

<pre class="highlight javascript"><code>
  <span class="nx">Stamplay</span><span class="p">.</span><span class="nx">Query</span><span class="p">(</span><span class="s2">"object"</span><span class="p">,</span> <span class="s2">"cobject_id"</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">select</span><span class="p">(</span><span class="s2">"title"</span><span class="p">,</span> <span class="s2">"actions.ratings.total"</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">exec</span><span class="p">()</span>
    <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
      <span class="c1">// success</span>
    <span class="p">},</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// error</span>
    <span class="p">})</span>

</code></pre>

<pre class="highlight nodejs"><code>
  <span class="nx">Stamplay</span><span class="p">.</span><span class="nx">Query</span><span class="p">(</span><span class="s2">"object"</span><span class="p">,</span> <span class="s2">"cobject_id"</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">select</span><span class="p">(</span><span class="s2">"title"</span><span class="p">,</span> <span class="s2">"actions.ratings.total"</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">exec</span><span class="p">()</span>
    <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
      <span class="c1">// success</span>
    <span class="p">},</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// error</span>
    <span class="p">})</span>

</code></pre>

<div class="lang-content shell">
  <p>To select fields of return for query, add the <code>select</code> query parameter the request URI, and add the attributes to return as a comma delimited list assigned to <code>select</code>.</p>

  <p>To return only certain properties of a field, set them as a dot notated attribute in the comma delimited list. In the example <code>actions.ratings.total</code>, is set a return field.</p>

  <p>The object structure is maintained, however any other properties not specified will not be returned.</p>

</div>

<div class="lang-content javascript nodejs">
  <p>To select fields of return for query, use the <code>select</code> query method on the <code>Stamplay.Query</code>, and add the attributes to return as method arguments.</p>

  <p>To return only certain properties of a field, pass them in as a dot notated attribute as seen in the example with <code>actions.ratings.total</code>.</p>
</div>

<h4 id="sorting-query-results">Sorting Query Results</h4>

<pre class="highlight shell"><code>  // sort by title - ascending order
  curl -X <span class="s2">"GET"</span> <span class="s1">'https://APP-ID.stamplayapp.com/api/cobject/v1/movie?sort=title'</span>

  // sort by title by descending order <span class="o">(</span>note the hyphen preceding the sort param value<span class="o">)</span>
  curl -X <span class="s2">"GET"</span> <span class="s1">'https://APP-ID.stamplayapp.com/api/cobject/v1/movie?sort=-title'</span>
</code></pre>

<pre class="highlight javascript"><code>
  <span class="c1">// sort by title in ascending order</span>
  <span class="nx">Stamplay</span><span class="p">.</span><span class="nx">Query</span><span class="p">(</span><span class="s2">"object"</span><span class="p">,</span> <span class="s2">"cobject_id"</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">sortAscending</span><span class="p">(</span><span class="s2">"title"</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">exec</span><span class="p">()</span>
    <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
      <span class="c1">// success</span>
    <span class="p">},</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// error</span>
    <span class="p">})</span>

  <span class="c1">// sort by title in descending order</span>
  <span class="nx">Stamplay</span><span class="p">.</span><span class="nx">Query</span><span class="p">(</span><span class="s2">"object"</span><span class="p">,</span> <span class="s2">"cobject_id"</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">sortDescending</span><span class="p">(</span><span class="s2">"title"</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">exec</span><span class="p">()</span>
    <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
      <span class="c1">// success</span>
    <span class="p">},</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// error</span>
    <span class="p">})</span>

</code></pre>

<pre class="highlight nodejs"><code>
  <span class="c1">// sort by title in ascending order</span>
  <span class="nx">Stamplay</span><span class="p">.</span><span class="nx">Query</span><span class="p">(</span><span class="s2">"object"</span><span class="p">,</span> <span class="s2">"cobject_id"</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">sortAscending</span><span class="p">(</span><span class="s2">"title"</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">exec</span><span class="p">()</span>
    <span class="p">.</span><span class="nx">exec</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">res</span><span class="p">){</span>
      <span class="k">if</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="k">return</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">err</span><span class="p">);</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">res</span><span class="p">);</span>
    <span class="p">})</span>

  <span class="c1">// sort by title in descending order</span>
  <span class="nx">Stamplay</span><span class="p">.</span><span class="nx">Query</span><span class="p">(</span><span class="s2">"object"</span><span class="p">,</span> <span class="s2">"cobject_id"</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">sortDescending</span><span class="p">(</span><span class="s2">"title"</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">exec</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">res</span><span class="p">){</span>
      <span class="k">if</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="k">return</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">err</span><span class="p">);</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">res</span><span class="p">);</span>
    <span class="p">})</span>

</code></pre>

<p>By default, Stamplay returns results in ascending order of the <code>dt_create</code> property, or the date created.</p>

<div class="lang-content shell">
  <p>To change the order in which the records are sorted in the response, pass in a <code>sort</code> parameter and set the value as the attribute to sort by. An attribute preceded by an <code>-</code>(hyphen) is sorted in descending order.</p>
</div>

<div class="lang-content javascript nodejs">
  <p>To change the order in which the records are sorted in the response, call the <code>sortAscending</code> or <code>sortDescending</code> method on your query, and pass in the attribute to sort by.</p>
</div>

<h3 id="regular-expressions">Regular Expressions</h3>

<pre class="highlight shell"><code>  curl -X <span class="s2">"GET"</span> <span class="s1">'https://APP-ID.stamplayapp.com/api/cobject/v1/movie?where=\{"title":\{"$regex":"^Star","$options":"i"\}\}'</span>
</code></pre>

<pre class="highlight javascript"><code>  <span class="nx">Stamplay</span><span class="p">.</span><span class="nx">Query</span><span class="p">(</span><span class="s1">'object'</span><span class="p">,</span><span class="s1">'question'</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">regex</span><span class="p">(</span><span class="s1">'title'</span><span class="p">,</span><span class="s1">'^Star'</span><span class="p">,</span> <span class="s1">'i'</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">exec</span><span class="p">()</span>
    <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">res</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// success</span>
    <span class="p">},</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// error</span>
    <span class="p">})</span>
</code></pre>

<pre class="highlight nodejs"><code>  <span class="nx">Stamplay</span><span class="p">.</span><span class="nx">Query</span><span class="p">(</span><span class="s1">'object'</span><span class="p">,</span><span class="s1">'question'</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">regex</span><span class="p">(</span><span class="s1">'title'</span><span class="p">,</span><span class="s1">'^Star'</span><span class="p">,</span> <span class="s1">'i'</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">exec</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">res</span><span class="p">){</span>
      <span class="c1">// response</span>
    <span class="p">})</span>
</code></pre>

<p>Regular Expressions allow pattern matching for strings in queries. For a full list of options available, and more on pattern matching see the <a href="https://docs.mongodb.org/manual/reference/operator/query/regex/">MongoDB Documentation on $regex</a>.</p>

<p>The example returns records where the <code>title</code> starts with <code>Star</code>, with option <code>i</code> (disables case sensitivity).</p>

<h3 id="compound-queries">Compound Queries</h3>

<pre class="highlight shell"><code>  curl -X <span class="s2">"GET"</span> <span class="s1">'https://stamplaykb.stamplayapp.com/api/cobject/v1/question?where=\{"$or":\[\{"actions.rating.total":\{"$gt":4\}\},\{"title":"Star Wars"\}\]\}'</span>
</code></pre>

<pre class="highlight javascript"><code>  <span class="kd">var</span> <span class="nx">ratedFourOrMore</span> <span class="o">=</span> <span class="nx">Stamplay</span><span class="p">.</span><span class="nx">Query</span><span class="p">(</span><span class="s2">"object"</span><span class="p">,</span> <span class="s2">"movie"</span><span class="p">);</span>
  <span class="kd">var</span> <span class="nx">titleIsStarWars</span> <span class="o">=</span> <span class="nx">Stamplay</span><span class="p">.</span><span class="nx">Query</span><span class="p">(</span><span class="s2">"object"</span><span class="p">,</span> <span class="s2">"movie"</span><span class="p">);</span>

  <span class="nx">ratedFourOrMore</span><span class="p">.</span><span class="nx">greaterThanOrEqual</span><span class="p">(</span><span class="s2">"actions.ratings.total"</span><span class="p">,</span> <span class="mi">4</span><span class="p">);</span>
  <span class="nx">titleIsStarWars</span><span class="p">.</span><span class="nx">equalTo</span><span class="p">(</span><span class="s2">"title"</span><span class="p">,</span> <span class="s2">"Star Wars"</span><span class="p">);</span>

  <span class="kd">var</span> <span class="nx">combinedQuery</span> <span class="o">=</span> <span class="nx">Stamplay</span><span class="p">.</span><span class="nx">Query</span><span class="p">.</span><span class="nx">or</span><span class="p">(</span><span class="nx">ratedFourOrMore</span><span class="p">,</span> <span class="nx">titleIsStarWars</span><span class="p">)</span>

  <span class="nx">combinedQuery</span><span class="p">.</span><span class="nx">exec</span><span class="p">()</span>
    <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">res</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// success</span>
    <span class="p">},</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// error</span>
    <span class="p">})</span>
</code></pre>

<pre class="highlight nodejs"><code>  <span class="kd">var</span> <span class="nx">ratedFourOrMore</span> <span class="o">=</span> <span class="nx">Stamplay</span><span class="p">.</span><span class="nx">Query</span><span class="p">(</span><span class="s2">"object"</span><span class="p">,</span> <span class="s2">"movie"</span><span class="p">);</span>
  <span class="kd">var</span> <span class="nx">titleIsStarWars</span> <span class="o">=</span> <span class="nx">Stamplay</span><span class="p">.</span><span class="nx">Query</span><span class="p">(</span><span class="s2">"object"</span><span class="p">,</span> <span class="s2">"movie"</span><span class="p">);</span>

  <span class="nx">ratedFourOrMore</span><span class="p">.</span><span class="nx">greaterThanOrEqual</span><span class="p">(</span><span class="s2">"actions.ratings.total"</span><span class="p">,</span> <span class="mi">4</span><span class="p">);</span>
  <span class="nx">titleIsStarWars</span><span class="p">.</span><span class="nx">equalTo</span><span class="p">(</span><span class="s2">"title"</span><span class="p">,</span> <span class="err">“</span><span class="nx">Star</span> <span class="nx">Wars</span><span class="err">”</span><span class="p">);</span>

  <span class="kd">var</span> <span class="nx">combinedQuery</span> <span class="o">=</span> <span class="nx">Stamplay</span><span class="p">.</span><span class="nx">Query</span><span class="p">.</span><span class="nx">or</span><span class="p">(</span><span class="nx">ratedFourOrMore</span><span class="p">,</span> <span class="nx">titleIsStarWars</span><span class="p">)</span>

  <span class="nx">combinedQuery</span><span class="p">.</span><span class="nx">exec</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">res</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// response</span>
  <span class="p">})</span>
</code></pre>

<p>When performing a query, you might want to find records that match one of two or more sets of criteria, instead of a strict match for each attribute.</p>

<p>Being able to make compound queries eliminates making several requests, simplifying application development.</p>

<div class="lang-content shell">

  <p>To build a compound query, use the <code>$or</code> operator, and set an array of regular query objects. Any records matching at least one of the criteria objects will be returned.</p>

</div>

<div class="lang-content javascript nodejs">

  <p>To build a compound query, use the <code>or()</code> method, and pass in the query objects are arguments. Any records matching at least one of the criteria objects will be returned.</p>

</div>

<h3 id="geolocation-queries">Geolocation Queries</h3>

<p>Geolocation queries allow you to find records whose geo data match a set of geo parameters specified in the query.</p>

<div class="lang-content shell">

  <p>Stamplay supports the follow MongoDB operators for querying geolocation data:</p>

  <table>
    <thead>
      <tr>
        <th>Operator</th>
        <th> </th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><code>$geoWithin</code></td>
        <td>Returns records within the bounds GeoJSON geometry.</td>
      </tr>
      <tr>
        <td><code>$geoIntersects</code></td>
        <td>Returns records that intersect with a GeoJSON geometry</td>
      </tr>
      <tr>
        <td><code>$near</code></td>
        <td>Return records within a specified proximity to a point</td>
      </tr>
      <tr>
        <td><code>$nearSphere</code></td>
        <td>Return records within a specified proximity to a point on a sphere</td>
      </tr>
    </tbody>
  </table>

</div>

<div class="lang-content javascript nodejs">

  <p>The following SDK methods are available for querying geolocation data:</p>

  <table>
    <thead>
      <tr>
        <th>Method</th>
        <th> </th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><code>geoWithinGeometry</code></td>
        <td>Returns records within a geometric boundary.</td>
      </tr>
      <tr>
        <td><code>geoIntersects</code></td>
        <td>Returns records that intersect with a GeoJSON geometry</td>
      </tr>
      <tr>
        <td><code>near</code></td>
        <td>Return records within a specified proximity to a point</td>
      </tr>
      <tr>
        <td><code>nearSphere</code></td>
        <td>Return records within a specified proximity to a point on a sphere</td>
      </tr>
    </tbody>
  </table>

</div>

<h4 id="within-a-geometric-boundary">Within a Geometric Boundary</h4>

<pre class="highlight shell"><code>  curl -X <span class="s2">"GET"</span> <span class="s1">'https://APP-ID.stamplayapp.com/api/cobject/v1/movie?where=\{"_geolocation":\{"$geoWithin":\{"$geometry":\{"type":"Polygon","coordinates":\[\[\[-70,40\],\[-72,40\],\[-72,50\],\[-70,50\],\[-70,40\]\]\]\}\}\}\}'</span>
</code></pre>

<pre class="highlight javascript"><code> <span class="nx">Stamplay</span><span class="p">.</span><span class="nx">Query</span><span class="p">(</span><span class="s2">"object"</span><span class="p">,</span> <span class="s2">"movie"</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">geoWithinGeometry</span><span class="p">(</span><span class="s1">'Polygon'</span><span class="p">,</span>  
  <span class="p">[</span>
    <span class="p">[</span> <span class="p">[</span><span class="o">-</span><span class="mi">70</span><span class="p">,</span><span class="mi">40</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">72</span><span class="p">,</span><span class="mi">40</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">72</span><span class="p">,</span><span class="mi">50</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">70</span><span class="p">,</span> <span class="mi">50</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">70</span><span class="p">,</span> <span class="mi">40</span><span class="p">]</span> <span class="p">]</span>
  <span class="p">]).</span><span class="nx">exec</span><span class="p">()</span>
  <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">res</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// success</span>
  <span class="p">},</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// error</span>
  <span class="p">})</span>
</code></pre>

<pre class="highlight nodejs"><code>
 <span class="nx">Stamplay</span><span class="p">.</span><span class="nx">Query</span><span class="p">(</span><span class="s2">"object"</span><span class="p">,</span> <span class="s2">"movie"</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">geoWithinGeometry</span><span class="p">(</span><span class="s1">'Polygon'</span><span class="p">,</span>  
  <span class="p">[</span>
    <span class="p">[</span> <span class="p">[</span><span class="o">-</span><span class="mi">70</span><span class="p">,</span><span class="mi">40</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">72</span><span class="p">,</span><span class="mi">40</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">72</span><span class="p">,</span><span class="mi">50</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">70</span><span class="p">,</span> <span class="mi">50</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">70</span><span class="p">,</span> <span class="mi">40</span><span class="p">]</span> <span class="p">]</span>
  <span class="p">]).</span><span class="nx">exec</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span><span class="nx">res</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// response</span>
  <span class="p">})</span>
</code></pre>

<p>Find and return records that are within a specified polygon.</p>

<div class="lang-content shell">
  <p>The <code>$geoWithin</code> MongoDB operator accepts a GeoJSON <a href="https://docs.mongodb.org/manual/reference/geojson/#geojson-polygon">Polygon</a> or a <a href="https://docs.mongodb.org/manual/reference/geojson/#geojson-multipolygon">MultiPolygon</a>.</p>
</div>

<div class="lang-content javascript nodejs">
  <p>The <code>geoWithinGeometry</code> SDK method accepts a GeoJSON <a href="https://docs.mongodb.org/manual/reference/geojson/#geojson-polygon">Polygon</a> or a <a href="https://docs.mongodb.org/manual/reference/geojson/#geojson-multipolygon">MultiPolygon</a>.</p>
</div>

<p>For more information about finding records within a geometric boundray, see the MongoDB documention for <a href="https://docs.mongodb.org/manual/reference/operator/query/geoWithin/#op._S_geoWithin">$geoWithin</a>.</p>

<h4 id="intersects-a-geometric-boundary">Intersects a Geometric Boundary</h4>

<pre class="highlight shell"><code>  curl -X <span class="s2">"GET"</span> <span class="s1">'https://stamplaykb.stamplayapp.com/api/cobject/v1/question?where=\{"_geolocation":\{"$geoIntersects":\{"$geometry":\{"type":"Point","coordinates":\[74.0059,40.7127\]\}\}\}\}'</span>
</code></pre>

<pre class="highlight javascript"><code>  <span class="nx">Stamplay</span><span class="p">.</span><span class="nx">Query</span><span class="p">(</span><span class="s2">"object"</span><span class="p">,</span> <span class="s2">"movie"</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">geoIntersects</span><span class="p">(</span><span class="s1">'Point'</span><span class="p">,</span>  <span class="p">[</span> <span class="mf">74.0059</span><span class="p">,</span> <span class="mf">40.7127</span> <span class="p">])</span>
    <span class="p">.</span><span class="nx">exec</span><span class="p">()</span>
    <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">res</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// success</span>
    <span class="p">},</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// error</span>
    <span class="p">})</span>
</code></pre>

<pre class="highlight nodejs"><code>  <span class="nx">Stamplay</span><span class="p">.</span><span class="nx">Query</span><span class="p">(</span><span class="s2">"object"</span><span class="p">,</span> <span class="s2">"movie"</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">geoIntersects</span><span class="p">(</span><span class="s1">'Point'</span><span class="p">,</span>  <span class="p">[</span> <span class="mf">74.0059</span><span class="p">,</span> <span class="mf">40.7127</span> <span class="p">])</span>
    <span class="p">.</span><span class="nx">exec</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span><span class="nx">res</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// response</span>
    <span class="p">})</span>
</code></pre>

<p>Find and return records that intersect on the specified coordinates.</p>

<div class="lang-content shell">
  <p>The <code>$geoIntersects</code> MongoDB operator accepts a <a href="https://docs.mongodb.org/manual/reference/geojson/#geospatial-indexes-store-geojson">GeoJSON object</a>.</p>
</div>

<div class="lang-content javascript nodejs">
  <p>The <code>geoIntersects</code> SDK method accepts a <a href="https://docs.mongodb.org/manual/reference/geojson/#geospatial-indexes-store-geojson">GeoJSON object</a>.</p>
</div>

<p>For more information about finding records within a geometric boundray, see the MongoDB documention for <a href="https://docs.mongodb.org/manual/reference/operator/query/geoIntersects/#op._S_geoIntersects">$geoIntersects</a>.</p>

<h4 id="within-proximity-to-a-point">Within Proximity To A Point</h4>

<pre class="highlight shell"><code> curl -X <span class="s2">"GET"</span> <span class="s1">'https://stamplaykb.stamplayapp.com/api/cobject/v1/question?where=\{"_geolocation":\{"$near":\{"$geometry":\{"type":"Point","coordinates":\[74.0059,40.7127\]\}\}\}\}'</span>
</code></pre>

<pre class="highlight javascript"><code>  <span class="nx">Stamplay</span><span class="p">.</span><span class="nx">Query</span><span class="p">(</span><span class="s2">"object"</span><span class="p">,</span> <span class="s2">"dinners"</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">near</span><span class="p">(</span><span class="s1">'Point'</span><span class="p">,</span>  <span class="p">[</span> <span class="mf">74.0059</span><span class="p">,</span> <span class="mf">40.7127</span> <span class="p">],</span> <span class="mi">500</span> <span class="p">)</span>
  <span class="p">.</span><span class="nx">exec</span><span class="p">()</span>
  <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">res</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// success</span>
  <span class="p">},</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// error</span>
  <span class="p">})</span>
</code></pre>

<pre class="highlight nodejs"><code>  <span class="nx">Stamplay</span><span class="p">.</span><span class="nx">Query</span><span class="p">(</span><span class="s2">"object"</span><span class="p">,</span> <span class="s2">"dinners"</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">near</span><span class="p">(</span><span class="s1">'Point'</span><span class="p">,</span>  <span class="p">[</span> <span class="mf">81.0039</span><span class="p">,</span> <span class="mf">70.4127</span> <span class="p">],</span> <span class="mi">500</span><span class="p">,</span> <span class="mi">100</span> <span class="p">)</span>
  <span class="p">.</span><span class="nx">exec</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span><span class="nx">res</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// response</span>
  <span class="p">})</span>
</code></pre>

<p>Find records within proximity to a geographic point.</p>

<div class="lang-content shell">
  <p>The <code>$near</code> MongoDB operator accepts a <a href="https://docs.mongodb.org/manual/reference/geojson/#point">GeoJSON Point</a>.</p>
</div>

<div class="lang-content javascript nodejs">
  <p>The <code>near</code> SDK method accepts a <a href="https://docs.mongodb.org/manual/reference/geojson/#point">GeoJSON Point</a>.</p>
</div>

<p>More details about <a href="https://docs.mongodb.org/manual/reference/operator/query/near/">$near on MongoDB docs</a>.</p>

<h4 id="within-proximity-to-a-point-near-sphere">Within Proximity To A Point (Near Sphere)</h4>

<pre class="highlight shell"><code> curl -X <span class="s2">"GET"</span> <span class="s1">'https://stamplaykb.stamplayapp.com/api/cobject/v1/question?where=\{"_geolocation":\{"$near":\{"$geometry":\{"type":"Point","coordinates":\[74.0059,40.7127\]\}\}\}\}'</span>
</code></pre>

<pre class="highlight javascript"><code>  <span class="nx">Stamplay</span><span class="p">.</span><span class="nx">Query</span><span class="p">(</span><span class="s2">"object"</span><span class="p">,</span> <span class="s2">"dinners"</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">nearSphere</span><span class="p">(</span><span class="s1">'Point'</span><span class="p">,</span>  <span class="p">[</span> <span class="mf">74.0059</span><span class="p">,</span> <span class="mf">40.7127</span> <span class="p">],</span> <span class="mi">1000</span> <span class="p">)</span>
  <span class="p">.</span><span class="nx">exec</span><span class="p">()</span>
  <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">res</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// success</span>
  <span class="p">},</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// error</span>
  <span class="p">})</span>
</code></pre>

<pre class="highlight nodejs"><code>  <span class="nx">Stamplay</span><span class="p">.</span><span class="nx">Query</span><span class="p">(</span><span class="s2">"object"</span><span class="p">,</span> <span class="s2">"dinners"</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">nearSphere</span><span class="p">(</span><span class="s1">'Point'</span><span class="p">,</span>  <span class="p">[</span> <span class="mf">74.0059</span><span class="p">,</span> <span class="mf">40.7127</span> <span class="p">],</span> <span class="mi">500</span> <span class="p">)</span>
  <span class="p">.</span><span class="nx">exec</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span><span class="nx">res</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// response</span>
  <span class="p">})</span>
</code></pre>

<p>Find records within proximity to a geographic point, calculating distances using spherical geometry.</p>

<div class="lang-content shell">
  <p>The <code>$nearSphere</code> MongoDB operator accepts a <a href="https://docs.mongodb.org/manual/reference/geojson/#point">GeoJSON Point</a>.</p>
</div>

<div class="lang-content javascript nodejs">
  <p>The <code>nearSphere</code> SDK method accepts a <a href="https://docs.mongodb.org/manual/reference/geojson/#point">GeoJSON Point</a>.</p>
</div>

<p>More details about <a href="https://docs.mongodb.org/manual/reference/operator/query/nearSphere/">$nearSphere on MongoDB docs</a>.</p>

<h2 id="voting">Voting</h2>

<p>The Stamplay API provides a voting mechansim for managing a vote system, tracking users who have voted, how they have voted, and the total vote count.</p>

<p>Each Stamplay Object is able to be voted upon, out of the box without any additional setup.</p>

<p>The data for voting is stored on a <code>actions</code> object on each Object.</p>

<blockquote>
  <p>The following data is stored for votes.</p>
</blockquote>

<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"actions"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"votes"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nt">"users_downvote"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"user_id"</span><span class="p">],</span><span class="w">
      </span><span class="nt">"users_upvote"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"another_user_id"</span><span class="p">],</span><span class="w">
      </span><span class="nt">"users"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"user_id"</span><span class="p">,</span><span class="w"> </span><span class="s2">"another_user_id"</span><span class="p">],</span><span class="w">
      </span><span class="nt">"total"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<h3 id="downvoting">Downvoting</h3>

<pre class="highlight shell"><code>  curl -X <span class="s2">"PUT"</span> <span class="s2">"https://APP-ID.stamplayapp.com/api/cobject/v1/movie/:object_id/vote"</span> <span class="se">\</span>
    -H <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
    -d <span class="s2">"{</span><span class="se">\"</span><span class="s2">type</span><span class="se">\"</span><span class="s2">:</span><span class="se">\"</span><span class="s2">downvote</span><span class="se">\"</span><span class="s2">}"</span>
</code></pre>

<pre class="highlight javascript"><code>  <span class="nx">Stamplay</span><span class="p">.</span><span class="nb">Object</span><span class="p">(</span><span class="s2">"movie"</span><span class="p">).</span><span class="nx">downVote</span><span class="p">(</span><span class="s2">"object_id"</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">res</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// success</span>
    <span class="p">},</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// error</span>
    <span class="p">})</span>
</code></pre>

<pre class="highlight nodejs"><code>  <span class="c1">// no method</span>
</code></pre>

<p>To downvote an object send a <code>PUT</code> request to the Object resource with the object <code>_id</code> in the URI, and a <code>type</code> property in the body specifying <code>downvote</code>.</p>

<table>
  <thead>
    <tr>
      <th>Attribute</th>
      <th> </th>
      <th style="text-align: center">Optional</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>object_id</code></td>
      <td>the Stamplay <code>_id</code> of the object to downvote</td>
      <td style="text-align: center"><i class="unchecked"></i></td>
    </tr>
    <tr>
      <td><code>type</code></td>
      <td><code>"upvote"</code> or <code>"downvote"</code></td>
      <td style="text-align: center"><i class="unchecked"></i></td>
    </tr>
  </tbody>
</table>

<h3 id="upvoting">Upvoting</h3>

<pre class="highlight shell"><code>  curl -X <span class="s2">"PUT"</span> <span class="s2">"https://APP-ID.stamplayapp.com/api/cobject/v1/movie/:object_id/vote"</span> <span class="se">\</span>
    -H <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
    -d <span class="s2">"{</span><span class="se">\"</span><span class="s2">type</span><span class="se">\"</span><span class="s2">:</span><span class="se">\"</span><span class="s2">upvote</span><span class="se">\"</span><span class="s2">}"</span>
</code></pre>

<pre class="highlight javascript"><code>  <span class="nx">Stamplay</span><span class="p">.</span><span class="nb">Object</span><span class="p">(</span><span class="s2">"movie"</span><span class="p">).</span><span class="nx">upVote</span><span class="p">(</span><span class="s2">"object_id"</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">res</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// success</span>
    <span class="p">},</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// error</span>
    <span class="p">})</span>
</code></pre>

<pre class="highlight nodejs"><code>  <span class="c1">// no method</span>
</code></pre>

<p>To upvote an object send a <code>PUT</code> request to the Object resource with the object <code>_id</code> in the URI, and a <code>type</code> property in the body specifying <code>upvote</code>.</p>

<table>
  <thead>
    <tr>
      <th>Attribute</th>
      <th> </th>
      <th style="text-align: center">Optional</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>object_id</code></td>
      <td>the Stamplay <code>_id</code> of the object to downvote</td>
      <td style="text-align: center"><i class="unchecked"></i></td>
    </tr>
    <tr>
      <td><code>type</code></td>
      <td><code>"upvote"</code> or <code>"downvote"</code></td>
      <td style="text-align: center"><i class="unchecked"></i></td>
    </tr>
  </tbody>
</table>

<h2 id="commenting">Commenting</h2>

<pre class="highlight shell"><code>  curl -X <span class="s2">"PUT"</span> <span class="s2">"https://APP-ID.stamplayapp.com/api/cobject/v1/movie/:object_id/comment"</span> <span class="se">\</span>
    -H <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
    -d <span class="s2">"{</span><span class="se">\"</span><span class="s2">text</span><span class="se">\"</span><span class="s2">:</span><span class="se">\"</span><span class="s2">comment text goes here</span><span class="se">\"</span><span class="s2">}"</span>
</code></pre>

<pre class="highlight javascript"><code>  <span class="kd">var</span> <span class="nx">txt</span> <span class="o">=</span> <span class="s2">"comment text goes here"</span><span class="p">;</span>

  <span class="nx">Stamplay</span><span class="p">.</span><span class="nb">Object</span><span class="p">(</span><span class="s2">"movie"</span><span class="p">).</span><span class="nx">comment</span><span class="p">(</span><span class="s2">"object_id"</span><span class="p">,</span> <span class="nx">txt</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">res</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// success</span>
    <span class="p">},</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// error</span>
    <span class="p">})</span>
</code></pre>

<pre class="highlight nodejs"><code>  <span class="c1">// no method</span>
</code></pre>

<p>The Stamplay API provides a comment mechansim for managing a comment system.</p>

<p>Each Stamplay Object is able to be commented upon, out of the box without any additional setup.</p>

<p>To comment on an object send a <code>PUT</code> request to the Object resource with the object <code>_id</code> in the URI, and a <code>text</code> property in the body specifying the comment text.</p>

<table>
  <thead>
    <tr>
      <th>Attribute</th>
      <th> </th>
      <th style="text-align: center">Optional</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>object_id</code></td>
      <td>the Stamplay <code>_id</code> of the object to add a comment to</td>
      <td style="text-align: center"><i class="unchecked"></i></td>
    </tr>
    <tr>
      <td><code>texd</code></td>
      <td>the content of the comment</td>
      <td style="text-align: center"><i class="unchecked"></i></td>
    </tr>
  </tbody>
</table>

<p>The data for comments is stored on a <code>actions</code> object on each Object.</p>

<p>For each comment, a comment object is stored in the <code>comments</code> array.</p>

<blockquote>
  <p>The following data is stored for comments.</p>
</blockquote>

<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"actions"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"comments"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
      </span><span class="p">{</span><span class="w">
        </span><span class="nt">"picture"</span><span class="p">:</span><span class="w"> </span><span class="s2">"user_image_url"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"displayName"</span><span class="p">:</span><span class="w"> </span><span class="s2">"user_displayName"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"userId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"user_id"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"text"</span><span class="p">:</span><span class="w"> </span><span class="s2">"comment text"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"comment_id"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"dt_create"</span><span class="p">:</span><span class="w"> </span><span class="s2">"date commented"</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">]</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<h2 id="rating">Rating</h2>

<pre class="highlight shell"><code>  curl -X <span class="s2">"PUT"</span> <span class="s2">"https://APP-ID.stamplayapp.com/api/cobject/v1/movie/:object_id/rate"</span> <span class="se">\</span>
    -H <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
    -d <span class="s2">"{</span><span class="se">\"</span><span class="s2">rate</span><span class="se">\"</span><span class="s2">: 5}"</span>
</code></pre>

<pre class="highlight javascript"><code>
  <span class="nx">Stamplay</span><span class="p">.</span><span class="nb">Object</span><span class="p">(</span><span class="s2">"movie"</span><span class="p">).</span><span class="nx">rate</span><span class="p">(</span><span class="s2">"object_id"</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">res</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// success</span>
    <span class="p">},</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// error</span>
    <span class="p">})</span>
</code></pre>

<pre class="highlight nodejs"><code>  <span class="c1">// no method</span>
</code></pre>

<p>The Stamplay API provides a rate mechansim for managing a rating system.</p>

<p>Each Stamplay Object is able to be be rated, out of the box without any additional setup.</p>

<p>To rate an object send a <code>PUT</code> request to the Object resource with the object <code>_id</code> in the URI, and a <code>rate</code> property in the body specifying the rating as an integer.</p>

<table>
  <thead>
    <tr>
      <th>Attribute</th>
      <th> </th>
      <th style="text-align: center">Optional</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>object_id</code></td>
      <td>the Stamplay <code>_id</code> of the object to rate</td>
      <td style="text-align: center"><i class="unchecked"></i></td>
    </tr>
    <tr>
      <td><code>rate</code></td>
      <td>an integer rating</td>
      <td style="text-align: center"><i class="unchecked"></i></td>
    </tr>
  </tbody>
</table>

<p>The data for <code>ratings</code> is stored on a <code>actions</code> object on each Object.</p>

<blockquote>
  <p>The following data is stored for ratings.</p>
</blockquote>

<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"actions"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"ratings"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nt">"users"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"user_id"</span><span class="p">,</span><span class="w"> </span><span class="s2">"another_user_id"</span><span class="p">,</span><span class="w"> </span><span class="s2">"third_user"</span><span class="p">],</span><span class="w">
      </span><span class="nt">"avg"</span><span class="p">:</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w">
      </span><span class="nt">"total"</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

          <h1 id="code-blocks">Code Blocks</h1>
<p>When it comes to handle complex logic application, Flows may not be enough, and the need for a bit of custom logic becomes greater.</p>

<p>Code Blocks make this possible. With Code Blocks, you can add custom NodeJS server side logic when necessary, and let us do the heavily lifting when it's not.</p>

<h2 id="setup">Setup</h2>

<p>To create a Code Block:</p>

<ul>
  <li>Open the <strong>Code Blocks</strong> section and click on <strong>+Add</strong>;</li>
  <li>Insert a name for your code and press <strong>Enter</strong>.</li>
</ul>

<p><a href="images/codeblock_new.png"><img alt="New Code Block" src="images/codeblock_new.png" /></a></p>

<p>Stamplay generates a RESTful endpoint, whenever you create a Code Block.</p>

<p><a href="images/codeblock_landing.png"><img alt="New Code Block" src="images/codeblock_landing.png" /></a></p>

<h2 id="programming-models">Programming Models</h2>

<p>There are three ways of writing custom server side code based on your needs:</p>

<ul>
  <li>
    <p><a href="#simple-model">Simple</a> : when you do not need any external parameters, or the use of the incoming request body..</p>
  </li>
  <li>
    <p><a href="#contextual-model">Contextual</a>: when you need to access request body, query parameters and/or secrets.</p>
  </li>
  <li>
    <p><a href="#full-control-model">Full Control</a>: when you need access to the raw request and response.</p>
  </li>
</ul>

<aside class="warning">
  <p>All your code <strong>MUST</strong> be inside the main function, everything written outside will break your Code Block.</p>
</aside>

<h3 id="simple-model">Simple Model</h3>

<pre class="highlight nodejs-always"><code>  <span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">cb</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">cb</span><span class="p">(</span><span class="kc">null</span><span class="p">,</span> <span class="p">{</span> <span class="na">i_am</span><span class="p">:</span> <span class="s1">'done'</span><span class="p">});</span>
  <span class="p">}</span>
</code></pre>

<p>Within the <strong>Simple</strong> programming model, you must provide JavaScript code that returns a function which accepts a single argument: a callback.</p>

<p>To indicate completion, the function must call the callback with two arguments: an error, and the result.</p>

<p>The result, or the second argument in the callback, will be the response to the originating request, or the destination <em>(i.e. Execution of a Task after a Code Block executes.)</em> request body.</p>

<p>When the callback is invoked, the result value or an error will be serialized as JSON and sent back to the caller as <code>application/json</code> content type.</p>

<h3 id="contextual-model">Contextual Model</h3>

<pre class="highlight nodejs-always"><code>  <span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">context</span><span class="p">,</span> <span class="nx">cb</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">cb</span><span class="p">(</span><span class="kc">null</span><span class="p">,</span> <span class="p">{</span> <span class="na">hello</span><span class="p">:</span> <span class="nx">context</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">name</span> <span class="p">});</span>
  <span class="p">}</span>
</code></pre>
<p>A more advanced version of the programming model allows you to return a function that accepts two arguments: a <code>context</code> and a <code>callback</code>.</p>

<p>The <code>context</code> parameter is a JavaScript object with data and optionally body properties.
The <code>context.data</code> is a JavaScript object that combines parameters passed to the code using one of several mechanisms:</p>

<ul>
  <li>The <a href="#app-secrets">secrets</a> that you've defined in the Stamplay Editor.</li>
  <li>The URL query parameters of the request.</li>
  <li>The key value pairs passed in the request body.</li>
</ul>

<p>The request can be parsed correctly only if <code>application/json</code> or <code>application/x-www-form-urlencoded</code> is used as <code>content-type</code>.</p>

<h3 id="full-control-model">Full Control Model</h3>

<pre class="highlight nodejs-always"><code>  <span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">context</span><span class="p">,</span> <span class="nx">req</span><span class="p">,</span> <span class="nx">res</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">res</span><span class="p">.</span><span class="nx">writeHead</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="p">{</span> <span class="s1">'Content-Type'</span><span class="p">:</span> <span class="s1">'application/json'</span><span class="p">});</span>
    <span class="kd">var</span> <span class="nx">result</span> <span class="o">=</span> <span class="p">{</span> <span class="s2">"hello"</span> <span class="p">:</span> <span class="nx">context</span><span class="p">.</span><span class="nx">body</span> <span class="p">};</span>
    <span class="nx">res</span><span class="p">.</span><span class="nx">end</span><span class="p">(</span><span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">result</span><span class="p">));</span>
  <span class="p">};</span>
</code></pre>

<p>The most flexible programming model allows you to take full control over the HTTP <code>request</code> and <code>response</code>.</p>

<p>The <code>context</code> argument behaves the same way as in the two simpler programming models.</p>

<p>Note that this programming model does not have a concept of a callback. <a href="https://nodejs.org/api/http.html">Ending the HTTP response</a> indicates completion.</p>

<h2 id="executing-code-blocks">Executing Code Blocks</h2>

<p>Code Blocks can be used to implement custom logic and have it available as an API endpoint, for this reason they support any HTTP method. In a nutshell you can execute custom Node.js code with a HTTP call.</p>

<p>To execute a Code Block all you need to do is to send a HTTP request to the Code Block API endpoint that you can see in the Snippets.</p>

<p>Depending from the HTTP method, you can pass data to the Code block within the body of the request or via query params (see below).</p>

<pre class="highlight shell"><code>  curl -X <span class="s2">"POST"</span> <span class="s2">"https://APPID.stamplayapp.com/api/codeblock/v1/run/{codeblock_name}?name=Stamplay&amp;bar=foo"</span> <span class="se">\</span>
  -H <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
  -d <span class="s2">"{</span><span class="se">\"</span><span class="s2">message</span><span class="se">\"</span><span class="s2">:</span><span class="se">\"</span><span class="s2">Hello</span><span class="se">\"</span><span class="s2">}"</span>
</code></pre>

<pre class="highlight javascript"><code>  <span class="kd">var</span> <span class="nx">data</span> <span class="o">=</span> <span class="p">{</span> <span class="na">message</span> <span class="p">:</span> <span class="s2">"Hello"</span><span class="p">}</span>
  <span class="kd">var</span> <span class="nx">params</span> <span class="o">=</span> <span class="p">{</span> <span class="na">name</span> <span class="p">:</span> <span class="s2">"Stamplay"</span><span class="p">,</span> <span class="na">bar</span> <span class="p">:</span> <span class="s2">"foo"</span><span class="p">}</span>

  <span class="c1">//Stamplay.Codeblock("codeblock_name").run() sends a POST request by default</span>

  <span class="nx">Stamplay</span><span class="p">.</span><span class="nx">Codeblock</span><span class="p">(</span><span class="s2">"codeblock_name"</span><span class="p">).</span><span class="nx">run</span><span class="p">(</span><span class="nx">data</span><span class="p">,</span> <span class="nx">params</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// success</span>
  <span class="p">},</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// error</span>
  <span class="p">})</span>
</code></pre>

<pre class="highlight nodejs"><code>  <span class="kd">var</span> <span class="nx">data</span> <span class="o">=</span> <span class="p">{</span> <span class="na">message</span> <span class="p">:</span> <span class="s2">"Hello"</span><span class="p">}</span>
  <span class="kd">var</span> <span class="nx">params</span> <span class="o">=</span> <span class="p">{</span> <span class="na">name</span> <span class="p">:</span> <span class="s2">"Stamplay"</span><span class="p">}</span>

  <span class="c1">//Stamplay.Codeblock("codeblock_name").run() sends a POST request by default</span>

  <span class="nx">Stamplay</span><span class="p">.</span><span class="nx">Codeblock</span><span class="p">(</span><span class="s2">"codeblock_name"</span><span class="p">).</span><span class="nx">run</span><span class="p">(</span><span class="nx">data</span><span class="p">,</span> <span class="nx">params</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">res</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// manage the response and the error</span>
  <span class="p">})</span>
</code></pre>

<h3 id="passing-query-parameters-to-code-blocks">Passing query parameters to Code Blocks</h3>

<p>You can pass paramaters to the Code Block using URL query string of the Code Block request. All URL query parameters except the reserved ones (e.g. <code>user</code>) will be propagated to the code when it runs. To take advantage of this feature, define your JavaScript function such that it accepts two arguments instead of one: the <code>context</code> and the callback <code>cb</code>.</p>

<p>All allowed URL query parameters of the Code Block request will be provided to the Code Block code in the form of <code>context.data</code> JavaScript object.</p>

<pre class="highlight shell"><code>Switch to Javascript or NodeJS view to see the Code Block sample
</code></pre>

<pre class="highlight javascript"><code><span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">context</span><span class="p">,</span> <span class="nx">cb</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">cb</span><span class="p">(</span><span class="kc">null</span><span class="p">,</span> <span class="s2">"Hello, "</span> <span class="o">+</span> <span class="nx">context</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">name</span><span class="p">);</span>
<span class="p">}</span>
</code></pre>

<pre class="highlight nodejs"><code><span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">context</span><span class="p">,</span> <span class="nx">cb</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">cb</span><span class="p">(</span><span class="kc">null</span><span class="p">,</span> <span class="s2">"Hello, "</span> <span class="o">+</span> <span class="nx">context</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">name</span><span class="p">);</span>
<span class="p">}</span>
</code></pre>

<h4 id="try-it-out">Try it out</h4>

<p>You can try it out with <code>curl</code> or with our SDKs. Usually query parameters are passed when using <code>GET</code> requests so the examples show how to execute a Code Block with a GET request:</p>

<pre class="highlight shell"><code>curl -X <span class="s2">"GET"</span> <span class="s2">"https://APPID.stamplayapp.com/api/codeblock/v1/run/{codeblock_name}?name=Stamplay"</span> <span class="se">\</span>
  -H <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
</code></pre>

<pre class="highlight javascript"><code>  <span class="kd">var</span> <span class="nx">params</span> <span class="o">=</span> <span class="p">{</span> <span class="na">name</span> <span class="p">:</span> <span class="s2">"Stamplay"</span><span class="p">}</span>
  <span class="c1">//GET</span>
  <span class="nx">Stamplay</span><span class="p">.</span><span class="nx">Codeblock</span><span class="p">(</span><span class="s2">"codeblock_name"</span><span class="p">).</span><span class="nx">get</span><span class="p">(</span><span class="nx">params</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">res</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// manage the response and the error</span>
  <span class="p">})</span>
</code></pre>

<pre class="highlight nodejs"><code>  <span class="c1">//GET</span>
  <span class="kd">var</span> <span class="nx">params</span> <span class="o">=</span> <span class="p">{</span> <span class="na">name</span> <span class="p">:</span> <span class="s2">"Stamplay"</span><span class="p">}</span>
  <span class="nx">Stamplay</span><span class="p">.</span><span class="nx">Codeblock</span><span class="p">(</span><span class="s2">"codeblock_name"</span><span class="p">).</span><span class="nx">get</span><span class="p">(</span><span class="nx">params</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">res</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// manage the response and the error</span>
  <span class="p">})</span>
</code></pre>

<h3 id="passing-body-parameters-to-code-blocks">Passing body parameters to Code Blocks</h3>

<p>Parameters can be passed the Code Block also using <code>body</code> parameters of a <code>POST</code>, <code>PATCH</code> or <code>PUT</code> request. All the request<code>body</code> except the reserved ones (e.g. <code>user</code>) will be propagated to the code when it runs. To take advantage of this feature, define your JavaScript function such that it accepts two arguments instead of one: the <code>context</code> and the callback <code>cb</code>.</p>

<p>All allowed URL query parameters of the Code Block request will be provided to the Code Block code in the form of <code>context.data</code> JavaScript object.</p>

<pre class="highlight shell"><code>Switch to Javascript or NodeJS view to see the Code Block sample
</code></pre>

<pre class="highlight javascript"><code><span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">context</span><span class="p">,</span> <span class="nx">cb</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">cb</span><span class="p">(</span><span class="kc">null</span><span class="p">,</span> <span class="s2">"Just received this, "</span> <span class="o">+</span> <span class="nx">context</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">bodyparam</span><span class="p">);</span>
<span class="p">}</span>
</code></pre>

<pre class="highlight nodejs"><code><span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">context</span><span class="p">,</span> <span class="nx">cb</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">cb</span><span class="p">(</span><span class="kc">null</span><span class="p">,</span> <span class="s2">"Just received this, "</span> <span class="o">+</span> <span class="nx">context</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">bodyparam</span><span class="p">);</span>
<span class="p">}</span>
</code></pre>

<h4 id="try-it-out-1">Try it out</h4>

<p>You can try it out with <code>curl</code> or with our SDKs. Usually query parameters are passed when using <code>GET</code> requests so the examples show how to execute a Code Block with a <code>POST</code>, <code>PATCH</code> or <code>PUT</code> request:</p>

<pre class="highlight shell"><code>  curl -X <span class="s2">"POST"</span> <span class="s2">"https://APPID.stamplayapp.com/api/codeblock/v1/run/{codeblock_name}"</span> <span class="se">\</span>
  -H <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
  -d <span class="s2">"{</span><span class="se">\"</span><span class="s2">bodyparam</span><span class="se">\"</span><span class="s2">:</span><span class="se">\"</span><span class="s2">Stamplay</span><span class="se">\"</span><span class="s2">}"</span>

  curl -X <span class="s2">"PATCH"</span> <span class="s2">"https://APPID.stamplayapp.com/api/codeblock/v1/run/{codeblock_name}"</span> <span class="se">\</span>
  -H <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
  -d <span class="s2">"{</span><span class="se">\"</span><span class="s2">bodyparam</span><span class="se">\"</span><span class="s2">:</span><span class="se">\"</span><span class="s2">Stamplay</span><span class="se">\"</span><span class="s2">}"</span>

  curl -X <span class="s2">"PUT"</span> <span class="s2">"https://APPID.stamplayapp.com/api/codeblock/v1/run/{codeblock_name}"</span> <span class="se">\</span>
  -H <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
  -d <span class="s2">"{</span><span class="se">\"</span><span class="s2">bodyparam</span><span class="se">\"</span><span class="s2">:</span><span class="se">\"</span><span class="s2">Stamplay</span><span class="se">\"</span><span class="s2">}"</span>
</code></pre>

<pre class="highlight javascript"><code>  <span class="c1">//POST</span>
  <span class="kd">var</span> <span class="nx">data</span> <span class="o">=</span> <span class="p">{</span> <span class="na">bodyparam</span> <span class="p">:</span> <span class="s2">"Stamplay"</span><span class="p">}</span>

  <span class="nx">Stamplay</span><span class="p">.</span><span class="nx">Codeblock</span><span class="p">(</span><span class="s2">"codeblock_name"</span><span class="p">).</span><span class="nx">post</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// success</span>
  <span class="p">},</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// error</span>
  <span class="p">})</span>
  
  <span class="c1">//PUT</span>
  <span class="nx">Stamplay</span><span class="p">.</span><span class="nx">Codeblock</span><span class="p">(</span><span class="s2">"codeblock_name"</span><span class="p">).</span><span class="nx">put</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// success</span>
  <span class="p">},</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// error</span>
  <span class="p">})</span>

  <span class="c1">//PATCH</span>
  <span class="nx">Stamplay</span><span class="p">.</span><span class="nx">Codeblock</span><span class="p">(</span><span class="s2">"codeblock_name"</span><span class="p">).</span><span class="nx">patch</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// success</span>
  <span class="p">},</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// error</span>
  <span class="p">})</span>
</code></pre>

<pre class="highlight nodejs"><code>  <span class="kd">var</span> <span class="nx">data</span> <span class="o">=</span> <span class="p">{</span> <span class="na">bodyparam</span> <span class="p">:</span> <span class="s2">"Stamplay"</span><span class="p">}</span>
  
  <span class="c1">//POST</span>
  <span class="nx">Stamplay</span><span class="p">.</span><span class="nx">Codeblock</span><span class="p">(</span><span class="s2">"codeblock_name"</span><span class="p">).</span><span class="nx">post</span><span class="p">(</span><span class="nx">data</span><span class="p">,</span> <span class="kc">null</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">res</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// manage the response and the error</span>
  <span class="p">})</span>

  <span class="c1">//PUT</span>
  <span class="nx">Stamplay</span><span class="p">.</span><span class="nx">Codeblock</span><span class="p">(</span><span class="s2">"codeblock_name"</span><span class="p">).</span><span class="nx">put</span><span class="p">(</span><span class="nx">data</span><span class="p">,</span> <span class="kc">null</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">res</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// manage the response and the error</span>
  <span class="p">})</span>
  
  <span class="c1">//PATCH</span>
  <span class="nx">Stamplay</span><span class="p">.</span><span class="nx">Codeblock</span><span class="p">(</span><span class="s2">"codeblock_name"</span><span class="p">).</span><span class="nx">patch</span><span class="p">(</span><span class="nx">data</span><span class="p">,</span> <span class="kc">null</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">res</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// manage the response and the error</span>
  <span class="p">})</span>
</code></pre>

<h3 id="user-context-data">User Context Data</h3>

<p>When executing a Code Block, you are able to pass in data, which is set to the <code>context.data</code> property. If an active user session is in place from the origininating request, the user of the current session will be placed inside <code>context</code> on <code>context.data.user</code>.</p>

<pre class="highlight javascript"><code><span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">context</span><span class="p">,</span> <span class="nx">cb</span><span class="p">)</span> <span class="p">{</span><span class="err"> </span>
  <span class="c1">//context.data contain the request body parameters </span>
  <span class="kd">var</span> <span class="nx">greet</span> <span class="o">=</span> <span class="s2">"Hello, "</span><span class="p">;</span><span class="err"> </span> <span class="err"> </span>
  <span class="c1">//Show data about logged user </span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">"User with Id"</span> <span class="o">+</span> <span class="nx">context</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">user</span><span class="p">.</span><span class="nx">_id</span> <span class="o">+</span> <span class="s2">" is logged"</span><span class="p">);</span><span class="err"> </span>
  <span class="c1">//Return a JSON response that includes logged User attribute </span>
  <span class="nx">cb</span><span class="p">(</span><span class="kc">null</span><span class="p">,</span> <span class="p">{</span> <span class="na">message</span> <span class="p">:</span> <span class="nx">greet</span> <span class="o">+</span> <span class="s2">" "</span> <span class="o">+</span> <span class="nx">context</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">user</span><span class="p">.</span><span class="nx">displayName</span> <span class="o">+</span> <span class="s2">"!"</span>  <span class="p">});</span>
<span class="p">};</span>
</code></pre>
<pre class="highlight shell"><code>// switch to javascript or nodejs to <span class="nb">read </span>Code Block sample
</code></pre>
<pre class="highlight nodejs"><code><span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">context</span><span class="p">,</span> <span class="nx">cb</span><span class="p">)</span> <span class="p">{</span><span class="err"> </span>
  <span class="c1">//context.data contain the request body parameters </span>
  <span class="kd">var</span> <span class="nx">greet</span> <span class="o">=</span> <span class="s2">"Hello, "</span><span class="p">;</span><span class="err"> </span> <span class="err"> </span>
  <span class="c1">//Show data about logged user </span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">"User with Id"</span> <span class="o">+</span> <span class="nx">context</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">user</span><span class="p">.</span><span class="nx">_id</span> <span class="o">+</span> <span class="s2">" is logged"</span><span class="p">);</span><span class="err"> </span>
  <span class="c1">//Return a JSON response that includes logged User attribute </span>
  <span class="nx">cb</span><span class="p">(</span><span class="kc">null</span><span class="p">,</span> <span class="p">{</span> <span class="na">message</span> <span class="p">:</span> <span class="nx">greet</span> <span class="o">+</span> <span class="s2">" "</span> <span class="o">+</span> <span class="nx">context</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">user</span><span class="p">.</span><span class="nx">displayName</span> <span class="o">+</span> <span class="s2">"!"</span>  <span class="p">});</span>
<span class="p">};</span>
</code></pre>

<h2 id="managing-secret-parameters">Managing Secret Parameters</h2>

<p>You can create a Code Block that includes public or secret parameters. These parameters are made available to the Code Block code when it runs. This mechanism provides a convenient way to equip your Code Block with secret credentials necessary to communicate with external systems while preventing disclosure of these credentials to third parties.</p>

<p>For example, you could write a Code Block that sends an HTTP request to your private API and you need to use a secret token to authorize this request. The secret token to call your API can then be stored encrypted in the Code Block as a <code>secret</code>, only to be decrypted and provided to your Code Block code when it runs.</p>

<p>Code Blocks allow you to securely store these parameters within the Secrets area.</p>

<h3 id="adding-secrets">Adding Secrets</h3>

<p>Four steps are required in order to save a secret value:</p>

<ul>
  <li>
    <ol>
      <li>Navigate to the <strong>Secrets</strong> area, under the <strong>Properties</strong> tab.</li>
    </ol>
  </li>
</ul>

<p><a href="images/cb_sec_save_1.png"><img alt="Navigate To Secrets Area" src="images/cb_sec_save_1.png" /></a></p>

<ul>
  <li>
    <ol>
      <li>Add a <code>name</code> key and a key <code>value</code>.</li>
    </ol>
  </li>
</ul>

<p><a href="images/cb_sec_save_2.png"><img alt="Enter A New Secret" src="images/cb_sec_save_2.png" /></a></p>

<ul>
  <li>
    <ol>
      <li>Click the <strong>Add</strong> Button.</li>
    </ol>
  </li>
</ul>

<p><a href="images/cb_sec_save_3.png"><img alt="Enter A New Secret" src="images/cb_sec_save_3.png" /></a></p>

<p>Now your secret has been added and is ready for use with the Code Block.</p>

<p><a href="images/cb_sec_save_4.png"><img alt="Enter A New Secret" src="images/cb_sec_save_4.png" /></a></p>

<h3 id="accessing-secrets">Accessing Secrets</h3>

<pre class="highlight nodejs-always"><code>  <span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">context</span><span class="p">,</span> <span class="nx">cb</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">cb</span><span class="p">(</span><span class="kc">null</span><span class="p">,</span> <span class="p">{</span> <span class="na">pass_this_secret</span> <span class="p">:</span> <span class="nx">context</span><span class="p">.</span><span class="nx">secrets</span><span class="p">.</span><span class="nx">name</span> <span class="p">});</span>
  <span class="p">}</span>
</code></pre>

<p>In order to access secrets you need to use the <a href="#contextual-model">Contextual</a> or the <a href="#full-control-model">Full Control</a> programming model.</p>

<p>You'll find your secrets in the <code>context.secrets</code>, or the <code>context.data</code> object in the key that you specified from the Stamplay Editor.</p>

<p>Example shown uses the <strong>Contextual</strong> programming model.</p>

<h2 id="npm-modules">NPM Modules</h2>

<pre class="highlight nodejs-always"><code><span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">context</span><span class="p">,</span> <span class="nx">cb</span><span class="p">)</span> <span class="p">{</span>

  <span class="kd">var</span> <span class="nx">Stamplay</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s2">"stamplay"</span><span class="p">);</span>
  <span class="kd">var</span> <span class="nx">stamplay</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Stamplay</span><span class="p">(</span><span class="s2">"APPID"</span><span class="p">,</span> <span class="s2">"APIKEY"</span><span class="p">);</span>
  <span class="kd">var</span> <span class="nx">request</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s2">"request"</span><span class="p">);</span>
  <span class="kd">var</span>  <span class="nx">_</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s2">"underscore"</span><span class="p">);</span>

  <span class="nx">request</span><span class="p">(</span><span class="s2">"req_url"</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">req</span><span class="p">,</span> <span class="nx">res</span><span class="p">,</span> <span class="nx">body</span><span class="p">)</span> <span class="p">{</span>

    <span class="kd">var</span> <span class="nx">result</span> <span class="o">=</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">body</span><span class="p">);</span>

    <span class="kd">var</span> <span class="nx">movieFound</span> <span class="o">=</span> <span class="nx">_</span><span class="p">.</span><span class="nx">where</span><span class="p">(</span><span class="nx">result</span><span class="p">,</span> <span class="p">{</span> <span class="na">director</span> <span class="p">:</span> <span class="s2">"John Doe"</span> <span class="p">})</span>

    <span class="nx">Stamplay</span><span class="p">.</span><span class="nb">Object</span><span class="p">(</span><span class="s2">"movie"</span><span class="p">).</span><span class="nx">save</span><span class="p">(</span><span class="nx">movieFound</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">res</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">cb</span><span class="p">(</span><span class="kc">null</span><span class="p">,</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">res</span><span class="p">).</span><span class="nx">data</span><span class="p">);</span>
    <span class="p">})</span>

  <span class="p">})</span>

<span class="p">}</span>
</code></pre>

<p>When using Code Blocks you can rely on over 800 of the most popular Node.js modules available on NPM. You can use any of them in your Code Block code by simply requiring them.</p>

<p>You can browse available modules at <a href="https://canirequire.stamplayapp.com">https://canirequire.stamplayapp.com</a>.</p>

<p>If there is a module that is not list on the directory that you need, let us know at <a href="&#109;&#097;&#105;&#108;&#116;&#111;:&#115;&#117;&#112;&#112;&#111;&#114;&#116;&#064;&#115;&#116;&#097;&#109;&#112;&#108;&#097;&#121;&#046;&#099;&#111;&#109;">&#115;&#117;&#112;&#112;&#111;&#114;&#116;&#064;&#115;&#116;&#097;&#109;&#112;&#108;&#097;&#121;&#046;&#099;&#111;&#109;</a> and we can have the requested module live within 24hrs or less typically.</p>

<p>To use the <code>require</code> method, simply pass the name of the desired NPM module to <code>require</code> to include inside your Code Block as you normally may in a Node.js enviornment.</p>

<p>The example <code>require</code>s the <a href="http://underscorejs.org/">underscore</a>, <a href="https://github.com/request/request">request</a>, and <a href="https://github.com/Stamplay/stamplay-nodejs-sdk">Stamplay Node.js SDK</a>.</p>

<h2 id="common-errors">Common Errors</h2>

<p>These are some of the most common errors that you may encounter when writing Code Blocks:</p>

<h4 id="writing-code-outside-the-method-signature">Writing code outside the method signature.</h4>

<p>No code outside the main <code>module.export</code>, please. It's a tradeoff for using Code Blocks .</p>

<h4 id="async-code-not-handled-properly">Async code not handled properly.</h4>

<p>If you're writing code in Node.js, async code is the way to go. If you're having problems syncronizing your code please consider the use of libraries such as q or async which are available in our modules.</p>

<h4 id="ive-configured-a-task-that-says-on-code-block-run-then--but-its-not-working">I’ve configured a Task that says “On Code Block run then …” but it’s not working.</h4>

<p>There are several reason why the Task may not be triggered:</p>

<p>Tasks work only if the output has as <strong>Content-Type</strong> <code>application/json</code>: if you’re using the <strong>Simple</strong> or <strong>Context</strong> way to write a Code Block you can just pass null as the first argument (which is the error) and an object to the final callback, and Tasks will be triggered in the right way.</p>

<p>If you’re using the <strong>Full Control</strong> programming model, make sure to return <code>application/json</code> as Content-Type.</p>

<p>A task is triggered only if the Code Block returns a <code>200</code> status code.</p>

<p>A Code Block is currently only executed only using <code>POST</code> request, ensure that you're using the right HTTP verb.</p>

<h2 id="logs">Logs</h2>

<p>If you need to debug your Code Block to see how it behaves, check the <strong>Logs</strong> tab and you'll be able to see the <code>console.log</code> output, and the output of your Code Block from the callback, or the stack trace.</p>

<h2 id="lost-logs">Lost Logs</h2>

<p>Logs are automatically deleted after two weeks. If you have different needs, please <a href="&#109;&#097;&#105;&#108;&#116;&#111;:&#115;&#117;&#112;&#112;&#111;&#114;&#116;&#064;&#115;&#116;&#097;&#109;&#112;&#108;&#097;&#121;&#046;&#099;&#111;&#109;&#063;&#115;&#117;&#098;&#106;&#101;&#099;&#116;&#061;&#076;&#111;&#103;&#115;&#043;&#069;&#120;&#112;&#105;&#114;&#097;&#116;&#105;&#111;&#110;">let us know</a>.</p>

          <h1 id="webhooks">Webhooks</h1>
<p>Webhooks are "user defined HTTP callbacks".</p>

<p>With Stamplay, Webhooks can be used as custom event triggers for 3rd-Party Integrations, Code Blocks, or Core Services.</p>

<h2 id="creating-webhooks">Creating Webhooks</h2>

<p>To create a webhook, visit the Stamplay Editor for the application you would like to add a webhook for.</p>

<p>Navigate to the <strong>Webhooks</strong> section, enter a name for your Webhook and <strong>Create</strong>.</p>

<p>!(Web Hook Create)[images/webhook.create.png]</p>

<p>Any Webhook created is is available at:</p>

<ul>
  <li><a href="https://APP-ID.stamplayapp.com/api/webhook/v1/:webhookId/catch">https://APP-ID.stamplayapp.com/api/webhook/v1/:webhookId/catch</a></li>
</ul>

<h2 id="using-webhooks">Using Webhooks</h2>

<p>Webhooks can be used to capture events and used to pass data along to that event.</p>

<div class="lang-content shell">
  <p>To post data to a Webhook, make a <code>POST</code> request to a webhook url you have made in the Stamplay editor, including any data to pass into the Webhook as the request body.</p>
</div>

<div class="lang-content javascript">
  <p>To post data to a Webhook, use the <code>post</code> method on <code>Stamplay.Webhook("webhook_id")</code>, include any data to pass into the Webhook as the first method argument.</p>
</div>

<pre class="highlight shell"><code>  curl -X <span class="s2">"POST"</span> <span class="s2">"https://APP-ID.stamplayapp.com/api/webhook/v1/:webhook_id/catch"</span> <span class="se">\</span>
    -H <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
    -d <span class="s2">"{</span><span class="se">\"</span><span class="s2">name</span><span class="se">\"</span><span class="s2">:</span><span class="se">\"</span><span class="s2">John</span><span class="se">\"</span><span class="s2">}"</span>
</code></pre>

<pre class="highlight javascript"><code>  <span class="nx">Stamplay</span><span class="p">.</span><span class="nx">Webhook</span><span class="p">(</span><span class="s2">"webhook_id"</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">post</span><span class="p">({</span> <span class="na">name</span> <span class="p">:</span> <span class="s2">"Johne"</span> <span class="p">})</span>
    <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">res</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// success</span>
    <span class="p">},</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// error</span>
    <span class="p">})</span>

</code></pre>

<pre class="highlight nodejs"><code>  <span class="c1">// no method</span>
</code></pre>

          <h1 id="stripe">Stripe</h1>

<p>A first class API layer for integrating Stripe into a Stamplay application.</p>

<h2 id="customers">Customers</h2>

<p>Stripe customers allow you to perform recurring charges and track multiple charges that are associated with the same customer.</p>

<h3 id="add-customer">Add Customer</h3>

<pre class="highlight shell"><code>  curl -X <span class="s2">"POST"</span> <span class="s2">"https://APP-ID.stamplayapp.com/api/stripe/v1/customers"</span> <span class="se">\</span>
    -H <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
    -d <span class="s2">"{</span><span class="se">\"</span><span class="s2">userId</span><span class="se">\"</span><span class="s2">:</span><span class="se">\"</span><span class="s2">546dc9f188104fee05000006</span><span class="se">\"</span><span class="s2">}"</span>
</code></pre>

<pre class="highlight javascript"><code>  <span class="nx">Stamplay</span><span class="p">.</span><span class="nx">Stripe</span><span class="p">.</span><span class="nx">createCustomer</span><span class="p">(</span><span class="s2">"userId"</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">res</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// success</span>
    <span class="p">},</span>
       <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// error</span>
    <span class="p">})</span>
</code></pre>

<pre class="highlight nodejs"><code>  <span class="c1">// no method</span>
</code></pre>

<blockquote>
  <p>The JSON response looks like this.</p>
</blockquote>

<pre class="highlight json"><code><span class="w">
</span><span class="p">{</span><span class="w">
  </span><span class="nt">"__v"</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="w">
  </span><span class="nt">"livemode"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
  </span><span class="nt">"customer_id"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"cus_8GrAxVnGSGHKxv"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"userId"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"571021095743954537b8c0cd"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"appId"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"APP-ID"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"_id"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"57102131da5d4db251c71c76"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"dt_create"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"2016-04-14T23:01:05.995Z"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"subscriptions"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w">
  </span><span class="nt">"billingHistory"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w">
  </span><span class="nt">"id"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"57102131da5d4db251c71c76"</span><span class="w">
</span><span class="p">}</span><span class="w">

</span></code></pre>

<p>Add a new customer on Stripe.</p>

<table>
  <thead>
    <tr>
      <th>Attribute</th>
      <th> </th>
      <th style="text-align: center">Optional</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>userId</code></td>
      <td>the Stamplay <code>_id</code> of the  user to add as a Stripe Customer</td>
      <td style="text-align: center"><i class="unchecked"></i></td>
    </tr>
  </tbody>
</table>

<h2 id="subscriptions">Subscriptions</h2>

<p>Subscriptions allow you to charge a customer's card on a recurring basis. A subscription ties a customer to a particular plan you've created.</p>

<h3 id="fetch-user-subscription">Fetch User Subscription</h3>

<pre class="highlight shell"><code>  curl -X <span class="s2">"GET"</span> <span class="s2">"https://stripe-docs.stamplayapp.com/api/stripe/v1/customers/:userId/subscriptions/:subscriptionId"</span>
</code></pre>

<pre class="highlight javascript"><code>  <span class="nx">Stamplay</span><span class="p">.</span><span class="nx">Stripe</span><span class="p">.</span><span class="nx">getSubscription</span><span class="p">(</span><span class="s2">"userId"</span><span class="p">,</span>
     <span class="s2">"subscriptionId"</span><span class="p">)</span>
      <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">res</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// success</span>
      <span class="p">},</span>
         <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">){</span>
        <span class="c1">// error</span>
      <span class="p">})</span>
</code></pre>

<pre class="highlight nodejs"><code>  <span class="c1">// no method</span>
</code></pre>

<blockquote>
  <p>The JSON response looks like this.</p>
</blockquote>

<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"id"</span><span class="p">:</span><span class="s2">"sub_8GrYtVQuzArBMy"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"object"</span><span class="p">:</span><span class="s2">"subscription"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"application_fee_percent"</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"cancel_at_period_end"</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="w">
  </span><span class="nt">"canceled_at"</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"current_period_end"</span><span class="p">:</span><span class="mi">1463268296</span><span class="p">,</span><span class="w">
  </span><span class="nt">"current_period_start"</span><span class="p">:</span><span class="mi">1460676296</span><span class="p">,</span><span class="w">
  </span><span class="nt">"customer"</span><span class="p">:</span><span class="s2">"cus_8GrAxVnGSGHKxv"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"discount"</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"ended_at"</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"metadata"</span><span class="p">:{},</span><span class="w">
  </span><span class="nt">"plan"</span><span class="p">:{</span><span class="w">
    </span><span class="nt">"id"</span><span class="p">:</span><span class="s2">"subscription_one"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"object"</span><span class="p">:</span><span class="s2">"plan"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"amount"</span><span class="p">:</span><span class="mi">999</span><span class="p">,</span><span class="w">
    </span><span class="nt">"created"</span><span class="p">:</span><span class="mi">1460675091</span><span class="p">,</span><span class="w">
    </span><span class="nt">"currency"</span><span class="p">:</span><span class="s2">"usd"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"interval"</span><span class="p">:</span><span class="s2">"month"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"interval_count"</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="w">
    </span><span class="nt">"livemode"</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="w">
    </span><span class="nt">"metadata"</span><span class="p">:{},</span><span class="w">
    </span><span class="nt">"name"</span><span class="p">:</span><span class="s2">"Subscription One"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"statement_descriptor"</span><span class="p">:</span><span class="s2">"Sub One"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"trial_period_days"</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"statement_description"</span><span class="p">:</span><span class="s2">"Sub One"</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="nt">"quantity"</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="w">
  </span><span class="nt">"start"</span><span class="p">:</span><span class="mi">1460676296</span><span class="p">,</span><span class="w">
  </span><span class="nt">"status"</span><span class="p">:</span><span class="s2">"active"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"tax_percent"</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"trial_end"</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"trial_start"</span><span class="p">:</span><span class="kc">null</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p>Retrieve a user subscription by a subscription ID.</p>

<table>
  <thead>
    <tr>
      <th>Attribute</th>
      <th> </th>
      <th style="text-align: center">Optional</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>userId</code></td>
      <td>the Stamplay <code>_id</code> of a user with a subscription</td>
      <td style="text-align: center"><i class="unchecked"></i></td>
    </tr>
    <tr>
      <td><code>subscriptionId</code></td>
      <td>the Stripe identifier of the subscription to fetch</td>
      <td style="text-align: center"><i class="unchecked"></i></td>
    </tr>
  </tbody>
</table>

<h3 id="fetch-users-subscriptions">Fetch User's Subscriptions</h3>

<pre class="highlight shell"><code>  curl -X <span class="s2">"GET"</span> <span class="s2">"https://APP-ID.stamplayapp.com/api/stripe/v1/customers/:userId/subscriptions"</span>
</code></pre>

<pre class="highlight javascript"><code>  <span class="nx">Stamplay</span><span class="p">.</span><span class="nx">Stripe</span><span class="p">.</span><span class="nx">getSubscriptions</span><span class="p">(</span><span class="s2">"userId"</span><span class="p">,</span>
     <span class="nx">options</span><span class="p">)</span>
      <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">res</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// success</span>
      <span class="p">},</span>
         <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">){</span>
        <span class="c1">// error</span>
      <span class="p">})</span>
</code></pre>

<pre class="highlight nodejs"><code>  <span class="c1">// no method</span>
</code></pre>

<blockquote>
  <p>The JSON response looks like this.</p>
</blockquote>

<pre class="highlight json"><code><span class="w">
</span><span class="p">{</span><span class="w">
  </span><span class="nt">"object"</span><span class="p">:</span><span class="s2">"list"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"data"</span><span class="p">:[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nt">"id"</span><span class="p">:</span><span class="s2">"sub_8GrYtVQuzArBMy"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"object"</span><span class="p">:</span><span class="s2">"subscription"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"application_fee_percent"</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="w">
      </span><span class="nt">"cancel_at_period_end"</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="w">
      </span><span class="nt">"canceled_at"</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="w">
      </span><span class="nt">"current_period_end"</span><span class="p">:</span><span class="mi">1463268296</span><span class="p">,</span><span class="w">
      </span><span class="nt">"current_period_start"</span><span class="p">:</span><span class="mi">1460676296</span><span class="p">,</span><span class="w">
      </span><span class="nt">"customer"</span><span class="p">:</span><span class="s2">"cus_8GrAxVnGSGHKxv"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"discount"</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="w">
      </span><span class="nt">"ended_at"</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="w">
      </span><span class="nt">"metadata"</span><span class="p">:{},</span><span class="w">
      </span><span class="nt">"plan"</span><span class="p">:{</span><span class="w">
        </span><span class="nt">"id"</span><span class="p">:</span><span class="s2">"subscription_one"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"object"</span><span class="p">:</span><span class="s2">"plan"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"amount"</span><span class="p">:</span><span class="mi">999</span><span class="p">,</span><span class="w">
        </span><span class="nt">"created"</span><span class="p">:</span><span class="mi">1460675091</span><span class="p">,</span><span class="w">
        </span><span class="nt">"currency"</span><span class="p">:</span><span class="s2">"usd"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"interval"</span><span class="p">:</span><span class="s2">"month"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"interval_count"</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="w">
        </span><span class="nt">"livemode"</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="w">
        </span><span class="nt">"metadata"</span><span class="p">:{},</span><span class="w">
        </span><span class="nt">"name"</span><span class="p">:</span><span class="s2">"Subscription One"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"statement_descriptor"</span><span class="p">:</span><span class="s2">"Sub One"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"trial_period_days"</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="w">
        </span><span class="nt">"statement_description"</span><span class="p">:</span><span class="s2">"Sub One"</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="nt">"quantity"</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="w">
      </span><span class="nt">"start"</span><span class="p">:</span><span class="mi">1460676296</span><span class="p">,</span><span class="w">
      </span><span class="nt">"status"</span><span class="p">:</span><span class="s2">"active"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"tax_percent"</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="w">
      </span><span class="nt">"trial_end"</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="w">
      </span><span class="nt">"trial_start"</span><span class="p">:</span><span class="kc">null</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">],</span><span class="w">
  </span><span class="nt">"has_more"</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="w">
  </span><span class="nt">"url"</span><span class="p">:</span><span class="s2">"/v1/customers/cus_8GrAxVnGSGHKxv/subscriptions"</span><span class="w">
</span><span class="p">}</span><span class="w">

</span></code></pre>

<p>Retrieve a user's subscriptions.</p>

<table>
  <thead>
    <tr>
      <th>Attribute</th>
      <th> </th>
      <th style="text-align: center">Optional</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>userId</code></td>
      <td>the Stamplay <code>_id</code> of the user to fetch subscriptions for</td>
      <td style="text-align: center"><i class="unchecked"></i></td>
    </tr>
  </tbody>
</table>

<h3 id="add-a-subscription">Add A Subscription</h3>

<p>Add a new subscription to a Stripe customer.</p>

<pre class="highlight shell"><code>  curl -X <span class="s2">"POST"</span> <span class="s2">"https://APP-ID.stamplayapp.com/api/stripe/v1/customers/:userId/subscriptions"</span> <span class="se">\</span>
    -H <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
    -d <span class="s2">"{</span><span class="se">\"</span><span class="s2">planId</span><span class="se">\"</span><span class="s2">:</span><span class="se">\"</span><span class="s2">stripePlanId</span><span class="se">\"</span><span class="s2">}"</span>
</code></pre>

<pre class="highlight javascript"><code>  <span class="nx">Stamplay</span><span class="p">.</span><span class="nx">Stripe</span><span class="p">.</span><span class="nx">createSubscription</span><span class="p">(</span><span class="s2">"userId"</span><span class="p">,</span>
     <span class="s2">"planId"</span><span class="p">)</span>
      <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">res</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// success</span>
      <span class="p">},</span>
         <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">){</span>
        <span class="c1">// error</span>
      <span class="p">})</span>
</code></pre>

<pre class="highlight nodejs"><code>  <span class="c1">// no method</span>
</code></pre>

<blockquote>
  <p>The JSON response looks like this.</p>
</blockquote>

<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"id"</span><span class="p">:</span><span class="s2">"sub_8GrYtVQuzArBMy"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"object"</span><span class="p">:</span><span class="s2">"subscription"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"application_fee_percent"</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"cancel_at_period_end"</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="w">
  </span><span class="nt">"canceled_at"</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"current_period_end"</span><span class="p">:</span><span class="mi">1463268296</span><span class="p">,</span><span class="w">
  </span><span class="nt">"current_period_start"</span><span class="p">:</span><span class="mi">1460676296</span><span class="p">,</span><span class="w">
  </span><span class="nt">"customer"</span><span class="p">:</span><span class="s2">"cus_8GrAxVnGSGHKxv"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"discount"</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"ended_at"</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"metadata"</span><span class="p">:{},</span><span class="w">
  </span><span class="nt">"plan"</span><span class="p">:{</span><span class="w">
    </span><span class="nt">"id"</span><span class="p">:</span><span class="s2">"subscription_one"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"object"</span><span class="p">:</span><span class="s2">"plan"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"amount"</span><span class="p">:</span><span class="mi">999</span><span class="p">,</span><span class="w">
    </span><span class="nt">"created"</span><span class="p">:</span><span class="mi">1460675091</span><span class="p">,</span><span class="w">
    </span><span class="nt">"currency"</span><span class="p">:</span><span class="s2">"usd"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"interval"</span><span class="p">:</span><span class="s2">"month"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"interval_count"</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="w">
    </span><span class="nt">"livemode"</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="w">
    </span><span class="nt">"metadata"</span><span class="p">:{},</span><span class="w">
    </span><span class="nt">"name"</span><span class="p">:</span><span class="s2">"Subscription One"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"statement_descriptor"</span><span class="p">:</span><span class="s2">"Sub One"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"trial_period_days"</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"statement_description"</span><span class="p">:</span><span class="s2">"Sub One"</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="nt">"quantity"</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="w">
  </span><span class="nt">"start"</span><span class="p">:</span><span class="mi">1460676296</span><span class="p">,</span><span class="w">
  </span><span class="nt">"status"</span><span class="p">:</span><span class="s2">"active"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"tax_percent"</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"trial_end"</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"trial_start"</span><span class="p">:</span><span class="kc">null</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<table>
  <thead>
    <tr>
      <th>Attribute</th>
      <th> </th>
      <th style="text-align: center">Optional</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>userId</code></td>
      <td>the Stamplay <code>_id</code> of the user to add a subscriptions for</td>
      <td style="text-align: center"><i class="unchecked"></i></td>
    </tr>
    <tr>
      <td><code>planId</code></td>
      <td>the Stripe identifier of the subscription to add</td>
      <td style="text-align: center"><i class="unchecked"></i></td>
    </tr>
  </tbody>
</table>

<h3 id="update-subscription">Update Subscription</h3>

<p>Update a subscription for a Stripe customer.</p>

<pre class="highlight shell"><code>  curl -X <span class="s2">"PUT"</span> <span class="s2">"https://APP-ID.stamplayapp.com/api/stripe/v1/customers/:userId/subscriptions/:subscriptionId"</span> <span class="se">\</span>
    -H <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
    -d <span class="s2">"{</span><span class="se">\"</span><span class="s2">options</span><span class="se">\"</span><span class="s2">:</span><span class="se">\"</span><span class="s2">{ </span><span class="se">\"</span><span class="s2">plan</span><span class="se">\"</span><span class="s2"> : </span><span class="se">\"</span><span class="s2">subscription_one</span><span class="se">\"</span><span class="s2">}</span><span class="se">\"</span><span class="s2">}"</span>
</code></pre>

<pre class="highlight javascript"><code>  <span class="nx">Stamplay</span><span class="p">.</span><span class="nx">Stripe</span><span class="p">.</span><span class="nx">updateSubscription</span><span class="p">(</span><span class="s2">"userId"</span><span class="p">,</span> <span class="s2">"planId"</span><span class="p">,</span>
     <span class="p">{</span> <span class="s2">"plan : subscription_one"</span> <span class="p">})</span>
      <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">res</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// success</span>
      <span class="p">},</span>
         <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">){</span>
        <span class="c1">// error</span>
      <span class="p">})</span>
</code></pre>

<pre class="highlight nodejs"><code>  <span class="c1">// no method</span>
</code></pre>

<blockquote>
  <p>The JSON response looks like this.</p>
</blockquote>

<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"id"</span><span class="p">:</span><span class="s2">"sub_8GrYtVQuzArBMy"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"object"</span><span class="p">:</span><span class="s2">"subscription"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"application_fee_percent"</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"cancel_at_period_end"</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="w">
  </span><span class="nt">"canceled_at"</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"current_period_end"</span><span class="p">:</span><span class="mi">1463268296</span><span class="p">,</span><span class="w">
  </span><span class="nt">"current_period_start"</span><span class="p">:</span><span class="mi">1460676296</span><span class="p">,</span><span class="w">
  </span><span class="nt">"customer"</span><span class="p">:</span><span class="s2">"cus_8GrAxVnGSGHKxv"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"discount"</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"ended_at"</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"metadata"</span><span class="p">:{},</span><span class="w">
  </span><span class="nt">"plan"</span><span class="p">:{</span><span class="w">
    </span><span class="nt">"id"</span><span class="p">:</span><span class="s2">"subscription_two"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"object"</span><span class="p">:</span><span class="s2">"plan"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"amount"</span><span class="p">:</span><span class="mi">1999</span><span class="p">,</span><span class="w">
    </span><span class="nt">"created"</span><span class="p">:</span><span class="mi">1460676804</span><span class="p">,</span><span class="w">
    </span><span class="nt">"currency"</span><span class="p">:</span><span class="s2">"usd"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"interval"</span><span class="p">:</span><span class="s2">"month"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"interval_count"</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="w">
    </span><span class="nt">"livemode"</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="w">
    </span><span class="nt">"metadata"</span><span class="p">:{},</span><span class="w">
    </span><span class="nt">"name"</span><span class="p">:</span><span class="s2">"Subscription Two"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"statement_descriptor"</span><span class="p">:</span><span class="s2">"Sub Two"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"trial_period_days"</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"statement_description"</span><span class="p">:</span><span class="s2">"Sub Two"</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="nt">"quantity"</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="w">
  </span><span class="nt">"start"</span><span class="p">:</span><span class="mi">1460695662</span><span class="p">,</span><span class="w">
  </span><span class="nt">"status"</span><span class="p">:</span><span class="s2">"active"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"tax_percent"</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"trial_end"</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"trial_start"</span><span class="p">:</span><span class="kc">null</span><span class="w">
</span><span class="p">}</span><span class="w">

</span></code></pre>

<table>
  <thead>
    <tr>
      <th>Attribute</th>
      <th> </th>
      <th style="text-align: center">Optional</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>userId</code></td>
      <td>the Stamplay <code>_id</code> of the user to update a subscriptions for</td>
      <td style="text-align: center"><i class="unchecked"></i></td>
    </tr>
    <tr>
      <td><code>subscriptionId</code></td>
      <td>the Stripe <code>_id</code> of the subscription to update</td>
      <td style="text-align: center"><i class="unchecked"></i></td>
    </tr>
    <tr>
      <td><code>options</code></td>
      <td>a set of options for updating a subscription, see <a href="https://stripe.com/docs/api/node#update_subscription">Stripe Documentation</a> for details</td>
      <td style="text-align: center"><i class="unchecked"></i></td>
    </tr>
  </tbody>
</table>

<h3 id="remove-subscription">Remove Subscription</h3>

<p>Remove a subscription from a Stripe customer.</p>

<pre class="highlight shell"><code>  curl -X <span class="s2">"DELETE"</span> <span class="s2">"https://APP-ID.stamplayapp.com/api/stripe/v1/customers/:userId/subscriptions"</span> <span class="se">\</span>
    -H <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
    -d <span class="s2">"{</span><span class="se">\"</span><span class="s2">options</span><span class="se">\"</span><span class="s2">:</span><span class="se">\"</span><span class="s2">{}</span><span class="se">\"</span><span class="s2">}"</span>
</code></pre>

<pre class="highlight javascript"><code>  <span class="nx">Stamplay</span><span class="p">.</span><span class="nx">Stripe</span><span class="p">.</span><span class="nx">deleteSubscription</span><span class="p">(</span><span class="s2">"userId"</span><span class="p">,</span>
     <span class="s2">"planId"</span><span class="p">)</span>
      <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">res</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// success</span>
      <span class="p">},</span>
         <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">){</span>
        <span class="c1">// error</span>
      <span class="p">})</span>
</code></pre>

<pre class="highlight nodejs"><code>  <span class="c1">// no method</span>
</code></pre>

<blockquote>
  <p>The JSON response looks like this.</p>
</blockquote>

<pre class="highlight json"><code><span class="w">
</span><span class="p">{</span><span class="w">
  </span><span class="nt">"id"</span><span class="p">:</span><span class="s2">"sub_8GrYtVQuzArBMy"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"object"</span><span class="p">:</span><span class="s2">"subscription"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"application_fee_percent"</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"cancel_at_period_end"</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="w">
  </span><span class="nt">"canceled_at"</span><span class="p">:</span><span class="mi">1460695945</span><span class="p">,</span><span class="w">
  </span><span class="nt">"current_period_end"</span><span class="p">:</span><span class="mi">1463268296</span><span class="p">,</span><span class="w">
  </span><span class="nt">"current_period_start"</span><span class="p">:</span><span class="mi">1460676296</span><span class="p">,</span><span class="w">
  </span><span class="nt">"customer"</span><span class="p">:</span><span class="s2">"cus_8GrAxVnGSGHKxv"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"discount"</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"ended_at"</span><span class="p">:</span><span class="mi">1460695945</span><span class="p">,</span><span class="w">
  </span><span class="nt">"metadata"</span><span class="p">:{},</span><span class="w">
  </span><span class="nt">"plan"</span><span class="p">:{</span><span class="w">
    </span><span class="nt">"id"</span><span class="p">:</span><span class="s2">"subscription_two"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"object"</span><span class="p">:</span><span class="s2">"plan"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"amount"</span><span class="p">:</span><span class="mi">1999</span><span class="p">,</span><span class="w">
    </span><span class="nt">"created"</span><span class="p">:</span><span class="mi">1460676804</span><span class="p">,</span><span class="w">
    </span><span class="nt">"currency"</span><span class="p">:</span><span class="s2">"usd"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"interval"</span><span class="p">:</span><span class="s2">"month"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"interval_count"</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="w">
    </span><span class="nt">"livemode"</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="w">
    </span><span class="nt">"metadata"</span><span class="p">:{},</span><span class="w">
    </span><span class="nt">"name"</span><span class="p">:</span><span class="s2">"Subscription Two"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"statement_descriptor"</span><span class="p">:</span><span class="s2">"Sub Two"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"trial_period_days"</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"statement_description"</span><span class="p">:</span><span class="s2">"Sub Two"</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="nt">"quantity"</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="w">
  </span><span class="nt">"start"</span><span class="p">:</span><span class="mi">1460695662</span><span class="p">,</span><span class="w">
  </span><span class="nt">"status"</span><span class="p">:</span><span class="s2">"canceled"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"tax_percent"</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"trial_end"</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"trial_start"</span><span class="p">:</span><span class="kc">null</span><span class="w">
</span><span class="p">}</span><span class="w">

</span></code></pre>

<table>
  <thead>
    <tr>
      <th>Attribute</th>
      <th> </th>
      <th style="text-align: center">Optional</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>userId</code></td>
      <td>the Stamplay <code>_id</code> of the user to remove a subscriptions for</td>
      <td style="text-align: center"><i class="unchecked"></i></td>
    </tr>
  </tbody>
</table>

<h2 id="cards">Cards</h2>

<p>You can store multiple cards on a customer in order to charge the customer later.</p>

<h3 id="fetch-a-users-card">Fetch A User's Card</h3>

<p>Retrieve a Stripe customer's card.</p>

<pre class="highlight shell"><code>  curl -X <span class="s2">"GET"</span> <span class="s2">"https://APP-ID.stamplayapp.com/api/stripe/v1/customers/:userId/cards"</span>
</code></pre>

<pre class="highlight javascript"><code>  <span class="nx">Stamplay</span><span class="p">.</span><span class="nx">Stripe</span><span class="p">.</span><span class="nx">getCreditCard</span><span class="p">(</span><span class="s2">"userId"</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">res</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// success</span>
    <span class="p">},</span>
       <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">){</span>
      <span class="c1">// error</span>
    <span class="p">})</span>
</code></pre>

<pre class="highlight nodejs"><code>  <span class="c1">// no method</span>
</code></pre>

<blockquote>
  <p>The JSON response looks like this.</p>
</blockquote>

<pre class="highlight json"><code><span class="w">
</span><span class="p">{</span><span class="w">
  </span><span class="nt">"last4"</span><span class="p">:</span><span class="s2">"4242"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"fingerprint"</span><span class="p">:</span><span class="s2">"0YBm29b7kpk2tbQe"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"exp_year"</span><span class="p">:</span><span class="s2">"2017"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"exp_month"</span><span class="p">:</span><span class="s2">"12"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"cvc_check"</span><span class="p">:</span><span class="s2">"pass"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"country"</span><span class="p">:</span><span class="s2">"US"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"card_id"</span><span class="p">:</span><span class="s2">"card_180Jb6JGp443qx8tOrIZ89PM"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"brand"</span><span class="p">:</span><span class="s2">"Visa"</span><span class="w">
</span><span class="p">}</span><span class="w">

</span></code></pre>

<table>
  <thead>
    <tr>
      <th>Attribute</th>
      <th> </th>
      <th style="text-align: center">Optional</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>userId</code></td>
      <td>the Stamplay <code>_id</code> of the user to fetch cards for</td>
      <td style="text-align: center"><i class="unchecked"></i></td>
    </tr>
  </tbody>
</table>

<h3 id="add-a-card">Add A Card</h3>

<p>Add a new card to a Stripe customer.</p>

<p>Obtain a token using <a href="https://stripe.com/docs/stripe.js?#card-createToken">Stripe.js</a>.</p>

<pre class="highlight shell"><code>  curl -X <span class="s2">"POST"</span> <span class="s2">"https://APP-ID.stamplayapp.com/api/stripe/v1/customers/:userId/cards"</span> <span class="se">\</span>
    -H <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
    -d <span class="s2">"{</span><span class="se">\"</span><span class="s2">token</span><span class="se">\"</span><span class="s2">:</span><span class="se">\"</span><span class="s2">card_token</span><span class="se">\"</span><span class="s2">}"</span>
</code></pre>

<pre class="highlight javascript"><code>  <span class="nx">Stamplay</span><span class="p">.</span><span class="nx">Stripe</span><span class="p">.</span><span class="nx">createCreditCard</span><span class="p">(</span><span class="s2">"userId"</span><span class="p">,</span>
     <span class="s2">"token"</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">res</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// success</span>
    <span class="p">},</span>
       <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">){</span>
      <span class="c1">// error</span>
    <span class="p">})</span>
</code></pre>

<pre class="highlight nodejs"><code>  <span class="c1">// no method</span>
</code></pre>

<blockquote>
  <p>The JSON response looks like this.</p>
</blockquote>

<pre class="highlight json"><code><span class="w">
</span><span class="p">{</span><span class="w">
  </span><span class="nt">"card_id"</span><span class="p">:</span><span class="s2">"card_180Jb6JGp443qx8tOrIZ89PM"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"last4"</span><span class="p">:</span><span class="s2">"4242"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"brand"</span><span class="p">:</span><span class="s2">"Visa"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"exp_month"</span><span class="p">:</span><span class="s2">"12"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"exp_year"</span><span class="p">:</span><span class="s2">"2017"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"fingerprint"</span><span class="p">:</span><span class="s2">"0YBm29b7kpk2tbQe"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"country"</span><span class="p">:</span><span class="s2">"US"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"cvc_check"</span><span class="p">:</span><span class="s2">"pass"</span><span class="w">
</span><span class="p">}</span><span class="w">

</span></code></pre>

<table>
  <thead>
    <tr>
      <th>Attribute</th>
      <th> </th>
      <th style="text-align: center">Optional</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>userId</code></td>
      <td>the Stamplay <code>_id</code> of the user to add a new card for</td>
      <td style="text-align: center"><i class="unchecked"></i></td>
    </tr>
    <tr>
      <td><code>token</code></td>
      <td>a token obtained from <a href="https://stripe.com/docs/stripe.js?#card-createToken">Stripe.js</a></td>
      <td style="text-align: center"><i class="unchecked"></i></td>
    </tr>
  </tbody>
</table>

<h3 id="update-a-card">Update A Card</h3>

<p>Update a card for a Stripe customer.</p>

<p>Obtain a token using <a href="https://stripe.com/docs/stripe.js?#card-createToken">Stripe.js</a>.</p>

<pre class="highlight shell"><code>  curl -X <span class="s2">"PUT"</span> <span class="s2">"https://APP-ID.stamplayapp.com/api/stripe/v1/customers/:userId/cards"</span> <span class="se">\</span>
    -H <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
    -d <span class="s2">"{</span><span class="se">\"</span><span class="s2">token</span><span class="se">\"</span><span class="s2">:</span><span class="se">\"</span><span class="s2">card_token</span><span class="se">\"</span><span class="s2">}"</span>
</code></pre>

<pre class="highlight javascript"><code>  <span class="nx">Stamplay</span><span class="p">.</span><span class="nx">Stripe</span><span class="p">.</span><span class="nx">updateCreditCard</span><span class="p">(</span><span class="s2">"userId"</span><span class="p">,</span>
     <span class="s2">"token"</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">res</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// success</span>
    <span class="p">},</span>
       <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">){</span>
      <span class="c1">// error</span>
    <span class="p">})</span>
</code></pre>

<pre class="highlight nodejs"><code>  <span class="c1">// no method</span>
</code></pre>

<blockquote>
  <p>The JSON response looks like this.</p>
</blockquote>

<pre class="highlight json"><code><span class="w">
</span><span class="p">{</span><span class="w">
  </span><span class="nt">"last4"</span><span class="p">:</span><span class="s2">"4242"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"fingerprint"</span><span class="p">:</span><span class="s2">"0YBm29b7kpk2tbQe"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"exp_year"</span><span class="p">:</span><span class="s2">"2017"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"exp_month"</span><span class="p">:</span><span class="s2">"12"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"cvc_check"</span><span class="p">:</span><span class="s2">"pass"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"country"</span><span class="p">:</span><span class="s2">"US"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"card_id"</span><span class="p">:</span><span class="s2">"card_180Jb6JGp443qx8tOrIZ89PM"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"brand"</span><span class="p">:</span><span class="s2">"Visa"</span><span class="w">
</span><span class="p">}</span><span class="w">

</span></code></pre>

<table>
  <thead>
    <tr>
      <th>Attribute</th>
      <th> </th>
      <th style="text-align: center">Optional</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>userId</code></td>
      <td>the Stamplay <code>_id</code> of the user to update a card for</td>
      <td style="text-align: center"><i class="unchecked"></i></td>
    </tr>
    <tr>
      <td><code>token</code></td>
      <td>a token obtained from <a href="https://stripe.com/docs/stripe.js?#card-createToken">Stripe.js</a></td>
      <td style="text-align: center"><i class="unchecked"></i></td>
    </tr>
  </tbody>
</table>

<h2 id="charges">Charges</h2>

<h3 id="create-charge">Create Charge</h3>

<p>Charge a Stripe customer's card.</p>

<pre class="highlight shell"><code>  curl -X <span class="s2">"POST"</span> <span class="s2">"https://APP-ID.stamplayapp.com/api/stripe/v1/charges"</span> <span class="se">\</span>
    -H <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
    -d <span class="s2">"{</span><span class="se">\"</span><span class="s2">userId</span><span class="se">\"</span><span class="s2">:</span><span class="se">\"</span><span class="s2">51e554184d88a4452c002233</span><span class="se">\"</span><span class="s2">,
      </span><span class="se">\"</span><span class="s2">token</span><span class="se">\"</span><span class="s2">:</span><span class="se">\"</span><span class="s2">card_id</span><span class="se">\"</span><span class="s2">,
      </span><span class="se">\"</span><span class="s2">amount</span><span class="se">\"</span><span class="s2">:500,
      </span><span class="se">\"</span><span class="s2">currency</span><span class="se">\"</span><span class="s2">:</span><span class="se">\"</span><span class="s2">USD</span><span class="se">\"</span><span class="s2">}"</span>
</code></pre>

<pre class="highlight javascript"><code>  <span class="nx">Stamplay</span><span class="p">.</span><span class="nx">Stripe</span><span class="p">.</span><span class="nx">charge</span><span class="p">(</span><span class="s2">"userId"</span><span class="p">,</span>
     <span class="s2">"token"</span><span class="p">,</span>
     <span class="s2">"amount"</span><span class="p">,</span>
     <span class="s2">"currency"</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">res</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// Success</span>
    <span class="p">},</span>
       <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">){</span>
      <span class="c1">// Handle Error</span>
    <span class="p">});</span>
      
</code></pre>

<pre class="highlight nodejs"><code>  <span class="c1">// no method</span>
</code></pre>

<blockquote>
  <p>The JSON response looks like this.</p>
</blockquote>

<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"id"</span><span class="p">:</span><span class="s2">"ch_180P6uJGp443qx8tho9DlZ5c"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"object"</span><span class="p">:</span><span class="s2">"charge"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"amount"</span><span class="p">:</span><span class="mi">1699</span><span class="p">,</span><span class="w">
  </span><span class="nt">"amount_refunded"</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="w">
  </span><span class="nt">"application_fee"</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"balance_transaction"</span><span class="p">:</span><span class="s2">"txn_180P6vJGp443qx8twAGVDTIl"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"captured"</span><span class="p">:</span><span class="kc">true</span><span class="p">,</span><span class="w">
  </span><span class="nt">"card"</span><span class="p">:{</span><span class="w">
    </span><span class="nt">"id"</span><span class="p">:</span><span class="s2">"card_180Jb6JGp443qx8tOrIZ89PM"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"object"</span><span class="p">:</span><span class="s2">"card"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"address_city"</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"address_country"</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"address_line1"</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"address_line1_check"</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"address_line2"</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"address_state"</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"address_zip"</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"address_zip_check"</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"brand"</span><span class="p">:</span><span class="s2">"Visa"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"country"</span><span class="p">:</span><span class="s2">"US"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"customer"</span><span class="p">:</span><span class="s2">"cus_8GrAxVnGSGHKxv"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"cvc_check"</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"dynamic_last4"</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"exp_month"</span><span class="p">:</span><span class="mi">12</span><span class="p">,</span><span class="w">
    </span><span class="nt">"exp_year"</span><span class="p">:</span><span class="mi">2017</span><span class="p">,</span><span class="w">
    </span><span class="nt">"fingerprint"</span><span class="p">:</span><span class="s2">"0YBm29b7kpk2tbQe"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"funding"</span><span class="p">:</span><span class="s2">"credit"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"last4"</span><span class="p">:</span><span class="s2">"4242"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"metadata"</span><span class="p">:{},</span><span class="w">
    </span><span class="nt">"name"</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"tokenization_method"</span><span class="p">:</span><span class="kc">null</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="nt">"created"</span><span class="p">:</span><span class="mi">1460696596</span><span class="p">,</span><span class="w">
  </span><span class="nt">"currency"</span><span class="p">:</span><span class="s2">"usd"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"customer"</span><span class="p">:</span><span class="s2">"cus_8GrAxVnGSGHKxv"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"description"</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"destination"</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"dispute"</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"failure_code"</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"failure_message"</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"fraud_details"</span><span class="p">:{},</span><span class="w">
  </span><span class="nt">"invoice"</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"livemode"</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="w">
  </span><span class="nt">"metadata"</span><span class="p">:{},</span><span class="w">
  </span><span class="nt">"order"</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"paid"</span><span class="p">:</span><span class="kc">true</span><span class="p">,</span><span class="w">
  </span><span class="nt">"receipt_email"</span><span class="p">:</span><span class="s2">"isaiahgrey@gmail.com"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"receipt_number"</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"refunded"</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="w">
  </span><span class="nt">"refunds"</span><span class="p">:{</span><span class="w">
    </span><span class="nt">"object"</span><span class="p">:</span><span class="s2">"list"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"data"</span><span class="p">:[],</span><span class="w">
    </span><span class="nt">"has_more"</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="w">
    </span><span class="nt">"total_count"</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="w">
    </span><span class="nt">"url"</span><span class="p">:</span><span class="s2">"/v1/charges/ch_180P6uJGp443qx8tho9DlZ5c/refunds"</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="nt">"shipping"</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"source"</span><span class="p">:{</span><span class="w">
    </span><span class="nt">"id"</span><span class="p">:</span><span class="s2">"card_180Jb6JGp443qx8tOrIZ89PM"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"object"</span><span class="p">:</span><span class="s2">"card"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"address_city"</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"address_country"</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"address_line1"</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"address_line1_check"</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"address_line2"</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"address_state"</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"address_zip"</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"address_zip_check"</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"brand"</span><span class="p">:</span><span class="s2">"Visa"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"country"</span><span class="p">:</span><span class="s2">"US"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"customer"</span><span class="p">:</span><span class="s2">"cus_8GrAxVnGSGHKxv"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"cvc_check"</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"dynamic_last4"</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"exp_month"</span><span class="p">:</span><span class="mi">12</span><span class="p">,</span><span class="w">
    </span><span class="nt">"exp_year"</span><span class="p">:</span><span class="mi">2017</span><span class="p">,</span><span class="w">
    </span><span class="nt">"fingerprint"</span><span class="p">:</span><span class="s2">"0YBm29b7kpk2tbQe"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"funding"</span><span class="p">:</span><span class="s2">"credit"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"last4"</span><span class="p">:</span><span class="s2">"4242"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"metadata"</span><span class="p">:{},</span><span class="w">
    </span><span class="nt">"name"</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"tokenization_method"</span><span class="p">:</span><span class="kc">null</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="nt">"source_transfer"</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"statement_descriptor"</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"status"</span><span class="p">:</span><span class="s2">"paid"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"statement_description"</span><span class="p">:</span><span class="kc">null</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<table>
  <thead>
    <tr>
      <th>Attribute</th>
      <th> </th>
      <th style="text-align: center">Optional</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>userId</code></td>
      <td>the Stamplay <code>_id</code> of the user to charge</td>
      <td style="text-align: center"><i class="unchecked"></i></td>
    </tr>
    <tr>
      <td><code>token</code></td>
      <td>the Stripe identifier for the customer card to charge</td>
      <td style="text-align: center"><i class="unchecked"></i></td>
    </tr>
    <tr>
      <td><code>amount</code></td>
      <td>the amount in cents to charge</td>
      <td style="text-align: center"><i class="unchecked"></i></td>
    </tr>
    <tr>
      <td><code>currency</code></td>
      <td>a 3-letter ISO code for currency, default <code>USD</code></td>
      <td style="text-align: center"><i class="checked"></i></td>
    </tr>
  </tbody>
</table>

          <h1 id="web-hosting">Web Hosting</h1>

<p>Stamplay Hosting provides you with the tools to host static or dynamic websites that are hooked up to our backend.</p>

<p>You can upload arbitrary static web content or create dynamic web apps, using the JavaScript SDK on the client side.</p>

<p>This guide shows you how to easily deploy and host your app’s static assets (HTML, CSS, JavaScript, etc.) with our production-grade hosting service.</p>

<h2 id="stamplay-command-line-tool">Stamplay Command Line Tool</h2>

<p>The <a href="https://github.com/Stamplay/stamplay-cli">Stamplay Command Line (CLI) Tool</a> can be used to:</p>

<ul>
  <li>
    <ul>
      <li>Administer your Stamplay account</li>
    </ul>
  </li>
  <li>
    <ul>
      <li>Interact with Stamplay Platform, our product to host your static HTML, JS, CSS, images, etc.</li>
    </ul>
  </li>
  <li>
    <ul>
      <li>Test you application locally.</li>
    </ul>
  </li>
</ul>

<p>The Stamplay CLI requires Node.js and NPM, which can both be installed by following the instructions at <a href="https://nodejs.org/">https://nodejs.org/</a>. Installing Node.js also installs NPM by default.</p>

<p>Once you have Node.js and NPM installed, you can install the Stamplay command line tools via NPM.</p>

<pre class="highlight shell-always"><code>  <span class="nx">npm</span> <span class="nx">install</span> <span class="o">-</span><span class="nx">g</span> <span class="nx">stamplay</span><span class="o">-</span><span class="nx">cli</span>
  <span class="c1">// sudo may be required depending on your system permissions</span>
  <span class="c1">// sudo npm install -g stamplay-cli</span>
</code></pre>

<p>This installs <code>stamplay</code> as a globally available command interface.</p>

<h3 id="stamplayjson">stamplay.json</h3>

<pre class="highlight shell"><code>  stamplay init
</code></pre>

<p>The <code>stamplay.json</code> file, when create is typically in the root of your project's directory.</p>

<pre class="highlight json"><code><span class="w">  </span><span class="p">{</span><span class="w">
    </span><span class="nt">"appId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"yourAppId"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"apiKey"</span><span class="p">:</span><span class="w"> </span><span class="s2">"yourAppApiKey"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"public"</span><span class="p">:</span><span class="w"> </span><span class="s2">"./"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"ignore"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
      </span><span class="s2">"stamplay.json"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"**/.*"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"**/node_modules/**"</span><span class="w">
    </span><span class="p">]</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span></code></pre>

<p>This required file is used to configure which files are published upon deployment, set customer headers, etc.</p>

<p>To generate a <code>stamplay.json</code> file, run the <code>init</code> CLI command.</p>

<p>After running the command, you will be prompted to enter the <code>APP ID</code> and <code>API Key</code> of the application.</p>

<p>The default <code>stamplay.json</code> file will look like the example:</p>

<p>An optional <code>headers</code> property is available to define browser side caching of static resources such as libraries or images.</p>

<p>Caching removes the need to load static libraries every time. This is helpful in a production enviornment to help speed up load times, and even reduce server load. See below for more details.</p>

<h4 id="appid-and-apikey">appId and apiKey</h4>
<pre class="highlight json"><code><span class="w">  </span><span class="s2">"appId"</span><span class="err">:</span><span class="w"> </span><span class="s2">"yourAppId"</span><span class="err">,</span><span class="w">
  </span><span class="s2">"apiKey"</span><span class="err">:</span><span class="w"> </span><span class="s2">"yourAppApiKey"</span><span class="w">
</span></code></pre>

<p>The <code>appId</code> and <code>apiKey</code> are used by the command line tool as authentication parameters.</p>

<h4 id="public">public</h4>

<pre class="highlight json"><code><span class="w">  </span><span class="s2">"public"</span><span class="w"> </span><span class="err">:</span><span class="w"> </span><span class="s2">"./"</span><span class="w"> 
</span></code></pre>

<p>The <code>public</code> property tells the command line which directory to upload to Stamplay. This directory must be inside the project directory and must exist.</p>

<p>The default value is the root directory or your project. This directory is also the one used by the command line tool when running the local server.</p>

<h4 id="ignore">ignore</h4>

<pre class="highlight json"><code><span class="w">  </span><span class="s2">"ignore"</span><span class="w"> </span><span class="err">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="s2">"stamplay.json"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"**/.*"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"**/node_modules/**"</span><span class="w">
  </span><span class="p">]</span><span class="w"> 
</span></code></pre>
<p>The <code>ignore</code> specifies which files to ignore on deploy. It can take glob definitions in the same way git handles <code>.gitignore</code>.</p>

<h4 id="headers">headers</h4>

<pre class="highlight json"><code><span class="w">  </span><span class="s2">"headers"</span><span class="err">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nt">"source"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"**/*.@(jpg|jpeg|gif|png)"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"headers"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="p">{</span><span class="w">
          </span><span class="nt">"key"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"Cache-Control"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"value"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"max-age=7200"</span><span class="w">
        </span><span class="p">}</span><span class="w">
      </span><span class="p">]</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nt">"source"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"404.html"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"headers"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="p">{</span><span class="w">
          </span><span class="nt">"key"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"Expires"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"value"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"1y"</span><span class="w">
        </span><span class="p">}</span><span class="w">
      </span><span class="p">]</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span></code></pre>

<p>The <code>headers</code> is an optional parameter in the <code>stamplay.json</code> file.</p>

<p>It is only available to be used only if your <code>stamplay-cli</code> version is <code>1.3.9</code> or greater.</p>

<p>This property is an array of header objects. Each object specifies:</p>

<hr />

<p><strong>source</strong></p>

<p>A file glob pattern to be matched.</p>

<hr />

<p><strong>headers</strong></p>

<p>A headers property of its own, as an array of header objects for the glob pattern source.</p>

<hr />

<p>Each specifies a key and value property.</p>

<p>The key designates the header type, and value is the value of the header type itself.</p>

<p>Each definition must have a <code>source</code> key that is matched against the original request path using glob notation; and must also have the array of headers applied, each with a valid key and a value.</p>

<p>The following header types are supported:</p>

<hr />

<p><strong>Expires</strong></p>

<p>The time in the <code>Expires</code> header is computed as a sum of the current time and time specified in the directive.</p>

<p>Allowed values for the <code>Expires</code> header are <strong>minutes</strong> : <code>m</code>, <strong>hours</strong> : <code>h</code>, <strong>days</strong> : <code>d</code>, <strong>weeks</strong> : <code>w</code>, <strong>years</strong> :  <code>y</code>.</p>

<p>For example, <code>5d</code> is <strong>5 days</strong>, or <code>120m</code> is <strong>120 minutes</strong>.</p>

<hr />

<p><strong>Cache-Control</strong></p>

<p>The time in the <code>Cache-Control</code> header is represented in seconds.</p>

<p>For example, <code>3600</code> is <strong>3600 seconds</strong>.</p>

<hr />

<h3 id="app-deploy">App Deploy</h3>

<pre class="highlight shell-always"><code>  <span class="nx">stamplay</span> <span class="nx">deploy</span>
</code></pre>

<p>To deploy a new release, run the <code>deploy</code> with the CLI.</p>

<p>This pushes the <code>public</code> directory as defined with the <code>stamplay.json</code> to Stamplay, which the deploys your static app to your <a href="stamplayapp.com">stamplayapp.com</a> domain.</p>

<h3 id="rollback">Rollback</h3>

<p>To rollback to a previous deploy, run the <code>rollback</code> CLI command.</p>

<pre class="highlight shell-always"><code>  <span class="nx">stamplay</span> <span class="nx">rollback</span>
</code></pre>

<p>You'll be prompted to pick one of your previous deploys from a list and your app will be restored.</p>

<h3 id="app-development">App Development</h3>

<pre class="highlight shell-always"><code>  <span class="nx">stamplay</span> <span class="nx">start</span>
</code></pre>

<p>You can run the Stamplay command line tool to build your app in development mode on your local environment. This will make the tool initialize a local server that will serve your app on <a href="http://localhost:8080">http://localhost:8080</a>.</p>

<p>To run your application locally, run the <code>start</code> CLI command.</p>

<p>Applications built with Stamplay must have an <code>index.html</code> file at root level of the <code>public</code> property defined in the <code>stamplay.json</code>.</p>

<p>By default the root level defined in <code>stamplay.json</code> public setting is <code>"./"</code>.</p>

<p>The <code>index.html</code> will be served when serving the application locally on <a href="http://localhost:8080">localhost</a>, or at <a href="https://APPID.stamplayapp.com">https://APPID.stamplayapp.com</a> after deployment.</p>

<h3 id="open-in-browser">Open In Browser</h3>

<p>To launch the live version of your application, run the <code>open</code> CLI command.</p>

<pre class="highlight shell-always"><code>  <span class="nx">stamplay</span> <span class="nx">open</span>
</code></pre>

<h3 id="cli-updates">CLI Updates</h3>

<p>You can update the Stamplay CLI by running <code>npm install</code> for the <code>stamplay-cli</code> npm package with the <code>-g</code> global option.</p>

<pre class="highlight shell-always"><code>  <span class="nx">npm</span> <span class="nx">install</span> <span class="o">-</span><span class="nx">g</span> <span class="nx">stamplay</span><span class="o">-</span><span class="nx">cli</span>
</code></pre>

<p>Thi will update your Stamplay command line tool to the latest version.</p>

<h2 id="custom-domains-and-ssl">Custom Domains and SSL</h2>

<p>Users on a paid plan can also host content at a custom domain name.</p>

<h3 id="setup">Setup</h3>

<p>To setup a custom domain, open the Stamplay Editor.</p>

<p>In the Stamplay Editor, in the <strong>Hosting</strong> section. Select <strong>Use A Custom Domain</strong> and add the value <a href="www.mybeautifulwebsite.com">www.mybeautifulwebsite.com</a> to the <strong>App Domain</strong> field.</p>

<aside class="notice">
  <p>Application must be on a paid plan to use a custom domain.</p>
</aside>

<p><a href="images/prettyurls_config.png"><img alt="Pretty URL Configuration" src="images/prettyurls_config.png" /></a></p>

<p>On your DNS provider, add a <strong>CNAME</strong> record from <a href="www.mybeautifulwebsite.com">www.mybeautifulwebsite.com</a> to <a href="">mydemoapp.stamplayapp.com</a> to begin sending traffic to your hosted app.</p>

<p>After completing these steps, <a href="www.mybeautifulwebsite.com">www.mybeautifulwebsite.com</a> will serve the same content as <a href="">mydemoapp.stamplayapp.com</a>.</p>

<p>If you want to serve content at an apex domain such as <a href="example.com">example.com</a>, you might have trouble with the steps above because root domains generally don't support <strong>CNAME</strong> records. To support this situation, you must configure <strong>ALIAS</strong>, <strong>ANAME</strong> or <strong>A</strong> records with your DNS provider.</p>

<p>If your DNS provider supports <strong>ALIAS</strong> records (such as with DNSimple) or <strong>ANAME</strong> records (such as with DNS Made Easy), you may choose to create an <strong>ALIAS</strong> or <strong>ANAME</strong> record to <a href="mydemoapp.stamplayapp.com">mydemoapp.stamplayapp.com</a> instead (Note: some DNS providers allow an apex domain configured with an <strong>ALIAS</strong> record to point to some other domain name).</p>

<p>Subdomains of up to one level of depth are supported.</p>

<p>Deeper subdomains, such as <a href="my.beautiful.website.com">my.beautiful.website.com</a>, are not allowed.</p>

<h3 id="pretty-urls">Pretty URLs</h3>

<p>To enable the url rewrite on the server side for single page applications, all you need to do is navigate to the <strong>Hosting</strong> section inside the Stamplay Editor, and check the box in the middle of the configuration under the <strong>URL Rewriting</strong> heading to enable all entry points to your domain, to point to the <code>index.html</code> page.</p>

<p><a href="images/prettyurls_config.png"><img alt="Pretty URL Configuration" src="images/prettyurls_config.png" /></a></p>

<p>Other steps still need to be taken to setup Pretty Urls, and differ among frameworks and libraries.</p>

<p>For the best support on this issue, search for solution specific to the framework or library you are using for routing.</p>

<h3 id="cors-enabled-domains">CORS Enabled Domains</h3>

<p>To enabled a domain for Cross Origin Requests, add the domain to the list inside the <strong>Dashboard</strong> section of the Stamplay Editor.</p>

<p>The isf field is under the <strong>CORS enabled domains</strong> heading. You can add the wildcard <code>*</code> to allow all origins. This is however not recommended.</p>

<p><a href="images/cors_config.png"><img alt="Pretty URL Configuration" src="images/cors_config.png" /></a></p>

<h3 id="domain-ownership--ssl">Domain Ownership &amp; SSL</h3>

<p>Stamplay will handle provisioning an SSL certificate for your domain and serving your content over a CDN. However, before setting up your SSL certificate, you will need to update the DNS entries for your domain by a <strong>CNAME</strong> entry.</p>

<p>The entries will be available via email once you begin the process of adding a custom domain. Depending on your domain name server host, this verification step may be instant or it may take an hour or more.</p>

<p>Once domain ownership is verified, we will provision an SSL certficate for your domain and deploy it across our global CDN. This process can take up to 48 hours, and you will receive an email when it is complete.</p>


          <h1 id="demo-applications">Demo Applications</h1>

<h2 id="stamplay-community">Stamplay Community</h2>

<p>Stamplay Community is a Q&amp;A based application made specifically for our users. You can ask questions, and get help from the Stamplay community, or the Stamplay team themselves. We built our community app using Stamplay as the backend, with an AngularJS frontend.</p>

<p><img alt="Stamplay Community" src="images/stamplay_community.png" /></p>

<p>Take a look at app here at <a href="https://stamplaykb.stamplayapp.com">https://stamplaykb.stamplayapp.com</a>.</p>

<p>See how it was built it, and build one yourself <a href="https://blog.stamplay.com/build-a-community-platform-with-angular-and-stamplay">here</a>.</p>

<h2 id="stackclone">Stackclone</h2>

<p>Stackclone is a clone of the popular Q&amp;A forum for developers, <a href="https://stackoverflow.com/">StackOverflow</a>; where you can ask question, answer questions, vote on answer, and discuss them.</p>

<p>We've built a clone of these features using Stamplay as the backend, with an AngularJS frontend.</p>

<p><img alt="Stackclone" src="images/stackoverflow_clone.png" /></p>

<p>Try out the app yourself at: <a href="https://stackoverflow.stamplayapp.com">https://stackoverflow.stamplayapp.com</a>.</p>

<p>See how we built it, and build one yourself <a href="https://blog.stamplay.com/create-a-qa-app-like-stackoverflow-with-angularjs/">here</a>.</p>

<h2 id="stamplay-news">Stamplay News</h2>

<p>Stamplay News is a clone of the iconic <a href="https://news.ycombinator.com/">Hacker News</a> application. It is a link aggregator to discuss and vote on the best links, and resource on the web.</p>

<p>Stamplay News was built with Stamplay as the server solution, with jQuery on the clientside.</p>

<p><img alt="Stamplay News" src="images/hackernews_clone.png" /></p>

<p>See the app in action here at: <a href="https://hackernews.stamplayapp.com">https://hackernews.stamplayapp.com</a>.</p>

<p>See how we built it, and build one yourself <a href="http://stackshare.io/stamplay/building-a-hacker-news-clone-without-writing-any-backend-code">here</a>.</p>

<h2 id="shop-city">Shop City</h2>

<p>Shop City is a clone of the popular two-sided marketplace, <a href="https://www.etsy.com/">Etsy</a>. You can buy items, sell your own items, reviews products.</p>

<p>We've built a clone of these features using Stamplay as the backend, with an AngularJS frontend.</p>

<p><img alt="Shop City" src="images/etsy_clone.png" /></p>

<p>Take a look at app here at <a href="https://angularetsy.stamplayapp.com">https://angularetsy.stamplayapp.com</a>.</p>

<p>See how it was built it, and build one yourself <a href="https://scotch.io/tutorials/build-an-etsy-clone-with-angular-and-stamplay-part-1">here</a>.</p>

      </div>
      <div class="dark-box">
          <div class="lang-selector">
                <a href="#" data-language-name="shell">cURL</a>
                <a href="#" data-language-name="javascript">JavaScript</a>
                <a href="#" data-language-name="nodejs">Node.js</a>
          </div>
      </div>
    </div>
  </body>
</html>
